import{a as ve}from"./chunk-6BTINF4T.js";import{c as xe}from"./chunk-DUHGU6EU.js";import{a as Me,b as Ce}from"./chunk-VJJHH52D.js";import{a as E}from"./chunk-CQ6IIDQT.js";import{a as N}from"./chunk-RFQI5BNG.js";import{b as z,c as _e,g as q,j as W,l as _}from"./chunk-ZVP2WZDK.js";import{A as fe,D as he,G as ge,H as $,I as be,Y as S,a as y,q as A,s as b,u as V,v as de,x as pe,y as ue}from"./chunk-KF24QTHE.js";import"./chunk-EJJBCPAK.js";import{a as H,c as J}from"./chunk-2TN3GL7T.js";import{j as se,l as P,p as ce}from"./chunk-V6KZPOXC.js";import{$ as ae,$b as j,$c as me,Ab as F,Bb as n,Cb as r,Db as g,E as re,Hb as O,Kb as p,Mb as v,Xa as l,Ya as d,Yb as a,Zb as f,Zc as L,_b as M,ac as B,bc as U,cc as G,ec as C,f as te,ia as x,ic as R,ja as oe,jc as D,m as ie,nb as k,q as ne,qa as I,ra as w,sb as u,xb as h,yb as le,zb as T}from"./chunk-BE5RT4AU.js";import"./chunk-JKOY2XUY.js";var Te=(o,c)=>c.id;function Fe(o,c){if(o&1&&(n(0,"li",13),a(1),r()),o&2){let t=c.$implicit;l(),M(" ",t,"")}}function Oe(o,c){if(o&1){let t=O();n(0,"mat-card",2)(1,"mat-card-content",5)(2,"div",6)(3,"div",7)(4,"div",8),a(5),r(),n(6,"div",9),a(7),r()(),n(8,"div",10),a(9),r(),n(10,"div",11),a(11,"Benef\xEDcios:"),r(),n(12,"ul",12),T(13,Fe,2,1,"li",13,le),r()()(),n(15,"button",14),p("click",function(){let e=I(t).$implicit,m=v();return w(m.editPlan(e))}),n(16,"mat-icon"),a(17,"check_circle"),r(),a(18," Selecionar Plano "),r()()}if(o&2){let t=c.$implicit;l(5),f(t.nome),l(2),M("R$ ",t.preco,""),l(2),M(" ",t.descricao," "),l(4),F(t.beneficios)}}var Ee=(()=>{class o{httpMethods;router;snackBar;member;pathUrlPlan=_.PLAN;pathUrlPlanMember=_.MEMBERPLAN;plans;gym_id="";typeUser="";limit=6;currentPage=0;totalResults=0;constructor(t,i,e){this.httpMethods=t,this.router=i,this.snackBar=e}ngOnInit(){this.getIdGym(),this.search(),this.getTypeUser()}getIdGym(){this.gym_id=localStorage.getItem("academia")}getTypeUser(){this.typeUser=localStorage.getItem("usuario_tipo")}search(t=0,i=this.limit){let e={academia:this.gym_id,active:!0,limit:i,offset:t};this.httpMethods.getPaginated(this.pathUrlPlan,e).subscribe(m=>{m.results.length<=0&&this.snackBar.open("N\xE3o h\xE1 planos ativos cadastrados!","fechar",{duration:2e3,verticalPosition:"top"}),this.plans=m.results,this.totalResults=m.count,this.currentPage=t/i})}nextPage(){let t=Math.ceil(this.totalResults/this.limit)-1;if(this.currentPage<t){let i=(this.currentPage+1)*this.limit;this.search(i)}}prevPage(){if(this.currentPage>0){let t=(this.currentPage-1)*this.limit;this.search(t)}}editPlan(t){let i={aluno:this.member?.id,plano:t.id,academia:t.academia};this.httpMethods.post(this.pathUrlPlanMember+"alterar_plano/",i).subscribe(()=>{this.snackBar.open("Aluno vinculado a plano","Fechar",{duration:5e3,verticalPosition:"top"}),this.router.navigate(["/member/list/"])})}static \u0275fac=function(i){return new(i||o)(d(E),d(P),d(S))};static \u0275cmp=x({type:o,selectors:[["app-member-plan"]],inputs:{member:"member"},standalone:!0,features:[C],decls:12,vars:7,consts:[[1,"Plan-list"],[1,"flex","flex-wrap","justify-content-center","gap-3","p-2"],[1,"plan-card","w-30rem","p-3","flex","flex-column","justify-content-between"],[1,"pagination","flex","justify-content-center","gap-2","mt-5"],["mat-raised-button","",3,"click","disabled"],[1,"flex-grow-1"],[1,"flex","flex-column","gap-2"],[1,"flex","align-items-center","justify-content-between"],[1,"text-2xl","font-bold"],[1,"text-2xl","font-bold","text-green-500"],[1,"line-clamp-3","text-gray-700","text-sm","mb-2","overflow-hidden","text-overflow-ellipsis","line-clamp-3"],[1,"text-lg","font-bold","overflow-hidden","text-overflow-ellipsis"],[1,"pl-3","line-clamp-5","overflow-hidden"],[1,"text-sm"],["mat-stroked-button","",1,"view-details-button","p-2","w-full","align-content-center","justify-content-center",3,"click"]],template:function(i,e){i&1&&(n(0,"div",0)(1,"div",1),T(2,Oe,19,3,"mat-card",2,Te),r(),n(4,"div",3)(5,"button",4),p("click",function(){return e.prevPage()}),a(6,"Anterior"),r(),n(7,"span"),a(8),R(9,"number"),r(),n(10,"button",4),p("click",function(){return e.nextPage()}),a(11,"Pr\xF3xima"),r()()()),i&2&&(l(2),F(e.plans),l(3),u("disabled",e.currentPage===0),l(3),j("P\xE1gina ",e.currentPage+1," de ",D(9,4,e.totalResults/e.limit,"1.0-0"),""),l(2),u("disabled",e.currentPage>=e.totalResults/e.limit-1))},dependencies:[J,H,N,y,L],styles:[".plan-card[_ngcontent-%COMP%]{margin-bottom:16px}.plan-details[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start}.plan-info[_ngcontent-%COMP%]{flex:1}.plan-description[_ngcontent-%COMP%]{flex:1;margin-left:16px;margin-top:8px;padding:8px;background-color:#f9f9f9;border-radius:4px;font-size:14px;line-height:1.6;color:#555;max-height:100px;overflow-y:auto}"]})}return o})();function Be(o,c){o&1&&(n(0,"mat-error"),a(1," Campo Obrigatorio "),r())}function Ue(o,c){o&1&&(n(0,"mat-error"),a(1," Nome tem limite de 50 caracteres "),r())}function Ge(o,c){o&1&&(n(0,"mat-error"),a(1," Campo Obrigatorio "),r())}function Re(o,c){o&1&&(n(0,"mat-error"),a(1," Insira um email valido "),r())}function De(o,c){o&1&&(n(0,"mat-error"),a(1," Campo Obrigatorio "),r())}function Le(o,c){o&1&&(n(0,"mat-error"),a(1," N\xFAmero de telefone inv\xE1lido "),r())}function Ne(o,c){o&1&&(n(0,"mat-error"),a(1," Campo Obrigatorio "),r())}var Ie=(()=>{class o{httpMethods;formBuilder;router;route;snackBar;obj=void 0;action="";plans=[];pathUrlMember=_.MEMBER;pathUrlPlan=_.PLAN;formGroup;created=!0;gymId="";selectedIndex=0;title="Cadastro de aluno";getGym(){this.gymId=localStorage.getItem("academia"),this.gymId&&this.formGroup.patchValue({academia:this.gymId})}constructor(t,i,e,m,s){this.httpMethods=t,this.formBuilder=i,this.router=e,this.route=m,this.snackBar=s,this.formGroup=this.formBuilder.group({id:[],nome:["",[b.required,b.maxLength(50)]],telefone:["",[b.required,b.pattern("[0-9]{10,11}")]],email:["",[b.required,b.email]],data_nascimento:["",b.required],academia:[null],matricula:[]})}ngOnInit(){this.getGym(),this.httpMethods.get(this.pathUrlPlan+`?academia=${this.gymId}&active=true`).subscribe(t=>{this.plans=t}),this.route.paramMap.subscribe(t=>{this.action=t.get("action"),this.created=!(this.action&&this.action!=="create"),this.created||(this.title="Edi\xE7\xE3o de aluno",this.httpMethods.get(this.pathUrlMember+`${this.action}/`).subscribe(i=>{this.obj=i,this.formGroup.setValue({id:i.id,nome:i.nome,email:i.email,telefone:i.telefone,data_nascimento:i.data_nascimento,matricula:i.matricula,academia:this.gymId})}))})}saveOrUpdate(t){this.created?this.httpMethods.get(this.pathUrlMember+`?email=${t.email}`).subscribe(i=>i&&i.length>0?(this.router.navigate([`/member/form/${i[0].id}`]),this.snackBar.open("O usu\xE1rio j\xE1 existe no sistema. Altere apenas seu plano.","Fechar",{duration:5e3,verticalPosition:"top"}),this.selectedIndex=1,ie(null)):this.httpMethods.post(this.pathUrlMember,t).pipe(ne(e=>e)).subscribe(e=>{this.obj=e,this.selectedIndex=1})):this.httpMethods.patch(`${this.pathUrlMember}`,t).subscribe(()=>{this.snackBar.open("Dados do aluno atualizados","O usu\xE1rio",{duration:5e3,verticalPosition:"top"}),this.obj=t})}return(){this.router.navigate(["/member/list/"])}static \u0275fac=function(i){return new(i||o)(d(E),d(ge),d(P),d(se),d(S))};static \u0275cmp=x({type:o,selectors:[["app-form"]],standalone:!0,features:[C],decls:36,vars:13,consts:[[3,"selectedIndexChange","selectedIndex"],["label","Dados do Aluno"],[1,"container","p-7"],[1,"mat-elevation-z2","form",3,"ngSubmit","formGroup"],["appearance","fill",1,"nome"],["matInput","","formControlName","nome","placeholder","Digite o nome"],["appearance","fill"],["matInput","","type","email","formControlName","email","placeholder","Digite o Email"],["matInput","","type","cellphone","formControlName","telefone","placeholder","Digite o Telefone"],["matInput","","type","date","formControlName","data_nascimento","placeholder","digite a data de nascimento"],["mat-raised-button","","color","primary","type","submit",1,"save",3,"disabled"],["label","Sele\xE7\xE3o de Plano",3,"disabled"],[3,"member"],["mat-raised-button","","color","warn",3,"click"]],template:function(i,e){if(i&1&&(n(0,"h2"),a(1),r(),n(2,"mat-tab-group",0),G("selectedIndexChange",function(s){return U(e.selectedIndex,s)||(e.selectedIndex=s),s}),n(3,"mat-tab",1)(4,"div",2)(5,"form",3),p("ngSubmit",function(){return e.saveOrUpdate(e.formGroup.value)}),n(6,"mat-form-field",4)(7,"mat-label"),a(8,"Nome"),r(),g(9,"input",5),k(10,Be,2,0,"mat-error")(11,Ue,2,0,"mat-error"),r(),n(12,"mat-form-field",6)(13,"mat-label"),a(14,"Email"),r(),g(15,"input",7),k(16,Ge,2,0,"mat-error")(17,Re,2,0,"mat-error"),r(),n(18,"mat-form-field",6)(19,"mat-label"),a(20,"Telefone"),r(),g(21,"input",8),k(22,De,2,0,"mat-error")(23,Le,2,0,"mat-error"),r(),n(24,"mat-form-field",6)(25,"mat-label"),a(26,"Data de nascimento"),r(),g(27,"input",9),k(28,Ne,2,0,"mat-error"),r(),n(29,"button",10),a(30,"Salvar "),r()()()(),n(31,"mat-tab",11),g(32,"app-member-plan",12),r(),n(33,"div")(34,"button",13),p("click",function(){return e.return()}),a(35,"finalizar"),r()()()),i&2){let m,s,Q,X,Y,Z,ee;l(),f(e.title),l(),B("selectedIndex",e.selectedIndex),l(3),u("formGroup",e.formGroup),l(5),h((m=e.formGroup.get("nome"))!=null&&m.hasError("required")?10:-1),l(),h((s=e.formGroup.get("nome"))!=null&&s.hasError("maxlength")?11:-1),l(5),h((Q=e.formGroup.get("email"))!=null&&Q.hasError("required")?16:-1),l(),h((X=e.formGroup.get("email"))!=null&&X.hasError("email")?17:-1),l(5),h((Y=e.formGroup.get("telefone"))!=null&&Y.hasError("required")?22:-1),l(),h((Z=e.formGroup.get("telefone"))!=null&&Z.hasError("pattern")?23:-1),l(5),h((ee=e.formGroup.get("data_nascimento"))!=null&&ee.hasError("required")?28:-1),l(),u("disabled",!e.formGroup.valid),l(2),u("disabled",!e.obj),l(),u("member",e.obj)}},dependencies:[$,ue,A,V,de,y,q,W,z,be,fe,he,Ce,Me,Ee,_e],styles:[".container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.form[_ngcontent-%COMP%]{width:100%;max-width:600px;padding:20px;background-color:#fff;border-radius:8px;box-shadow:0 4px 8px #0000001a}mat-form-field[_ngcontent-%COMP%]{width:100%;margin-bottom:16px}mat-label[_ngcontent-%COMP%]{font-weight:700;color:#333}input[_ngcontent-%COMP%]{font-size:16px;padding:10px}button[_ngcontent-%COMP%]{width:100%;padding:12px;font-size:16px;border:none;border-radius:4px;cursor:pointer}mat-tab-group[_ngcontent-%COMP%]{padding-left:1%;width:98%}"]})}return o})();function Ae(o,c){return this.trackById}function Ve(o,c){if(o&1){let t=O();n(0,"mat-card",10)(1,"mat-card-content")(2,"div",13)(3,"div",14),a(4),r(),n(5,"div",15)(6,"div",16),a(7),r(),n(8,"div",17),a(9),r()()(),n(10,"div",18)(11,"div",19)(12,"span"),a(13,"Plano Atual:"),r(),n(14,"strong"),a(15),r()(),n(16,"div",19)(17,"span"),a(18,"Matr\xEDcula:"),r(),n(19,"strong"),a(20),r()()()(),n(21,"div",20)(22,"div",21),p("click",function(){let e=I(t).$implicit,m=v();return w(m.edit(e.aluno))}),n(23,"mat-icon"),a(24,"edit"),r(),n(25,"span"),a(26,"Editar"),r()(),n(27,"div",22),p("click",function(){let e=I(t).$implicit,m=v();return w(m.disable(e.aluno))}),n(28,"mat-icon"),a(29,"delete"),r(),n(30,"span"),a(31,"Apagar"),r()()()()}if(o&2){let t=c.$implicit,i=v();l(4),M(" ",i.getInitials(t.aluno.nome)," "),l(3),f(t.aluno.nome),l(2),f(t.aluno.email),l(6),f(t.plano.nome),l(5),f(t.aluno.matricula)}}var we=(()=>{class o{httpMethods;router;snackBar;dialog;pathUrlMemberPlan=_.MEMBERPLAN;members;gym_id="";typeUser="";searchTerm="";limit=12;totalResults=0;currentPage=0;searchChange=new te;constructor(t,i,e,m){this.httpMethods=t,this.router=i,this.snackBar=e,this.dialog=m}ngOnInit(){this.getIdGym(),this.search(),this.getTypeUser(),this.searchChange.pipe(re(100)).subscribe(t=>{this.searchMember(t,0)})}getIdGym(){this.gym_id=localStorage.getItem("academia")}getTypeUser(){this.typeUser=localStorage.getItem("tipo_usuario")}search(){this.searchMember(this.searchTerm,0)}create(){this.router.navigate(["/member/form/create"]).then()}edit(t){this.router.navigate([`/member/form/${t.id}`]).then()}trackById(t,i){return i.aluno.id}getInitials(t){if(!t)return"";let e=t.trim().split(" ").map(m=>m.charAt(0).toUpperCase()).join("");return e.length>2?e.substring(0,2):e}disable(t){this.dialog.open(ve).afterClosed().subscribe(e=>{if(e){if(this.gym_id)t.academia=this.gym_id;else{console.error("Gym ID is missing");return}this.httpMethods.disable(this.pathUrlMemberPlan,t,"desativar_aluno").subscribe(()=>{this.searchMember(),this.snackBar.open("Aluno desativado","Fechar",{duration:5e3,verticalPosition:"top"})})}})}searchMember(t="",i=0,e=this.limit){let m={expand:["aluno","plano"],active:!0,academia:this.gym_id,limit:e,offset:i};t&&(m.search=t),this.httpMethods.getPaginated(this.pathUrlMemberPlan,m).subscribe(s=>{this.members=s.results,this.totalResults=s.count,this.currentPage=i/e})}nextPage(){let t=Math.ceil(this.totalResults/this.limit)-1;if(this.currentPage<t){let i=(this.currentPage+1)*this.limit;this.searchMember(this.searchTerm,i)}}prevPage(){if(this.currentPage>0){let t=(this.currentPage-1)*this.limit;this.searchMember(this.searchTerm,t)}}onSearchChange(t){this.searchTerm=t,this.searchChange.next(t)}static \u0275fac=function(i){return new(i||o)(d(E),d(P),d(S),d(xe))};static \u0275cmp=x({type:o,selectors:[["app-list"]],standalone:!0,features:[C],decls:27,vars:8,consts:[[1,"container"],[1,"title"],[1,"subtitle","flex","justify-content-center"],[1,"flex","align-items-center","justify-content-between","w-full","mb-4"],[1,"w-10rem"],["appearance","outline",1,"search","w-30rem"],["matInput","text","placeholder","Digite o nome ou matricula",3,"ngModelChange","input","ngModel"],[1,"align-self-start","mr-2"],["mat-raised-button","","color","primary",1,"add_button","bg-black-alpha-70","mt-2",2,"color","white",3,"click"],[1,"member-list","ml-4"],[1,"member-card"],[1,"pagination","flex","justify-content-center","gap-2","mt-5"],["mat-raised-button","",3,"click","disabled"],[1,"member-info","flex","align-items-center"],[1,"avatar","align-items-center"],[1,"flex-column"],[1,"name","font-bold"],[1,"email"],[1,"extra-info"],[1,"info-row"],[1,"footer","p-2","flex","justify-content-between","align-items-center"],[1,"icon-edit","flex","items-center","gap-2",3,"click"],[1,"icon-delete","flex","items-center","gap-2",3,"click"]],template:function(i,e){i&1&&(n(0,"div",0)(1,"h2",1),a(2,"Alunos"),r(),n(3,"p",2),a(4,"Edite ou desative alunos vinculados a academia"),r(),n(5,"div",3),g(6,"div",4),n(7,"mat-form-field",5)(8,"mat-label"),a(9,"Buscar aluno"),r(),n(10,"input",6),G("ngModelChange",function(s){return U(e.searchTerm,s)||(e.searchTerm=s),s}),p("input",function(){return e.onSearchChange(e.searchTerm)}),r()(),n(11,"div",7)(12,"button",8),p("click",function(){return e.create()}),n(13,"mat-icon"),a(14,"add"),r(),a(15," Novo Aluno "),r()()(),n(16,"div",9),T(17,Ve,32,5,"mat-card",10,Ae,!0),r(),n(19,"div",11)(20,"button",12),p("click",function(){return e.prevPage()}),a(21,"Anterior"),r(),n(22,"span"),a(23),R(24,"number"),r(),n(25,"button",12),p("click",function(){return e.nextPage()}),a(26,"Pr\xF3xima"),r()()()),i&2&&(l(10),B("ngModel",e.searchTerm),l(7),F(e.members),l(3),u("disabled",e.currentPage===0),l(3),j("P\xE1gina ",e.currentPage+1," de ",D(24,5,e.totalResults/e.limit,"1.0-0"),""),l(2),u("disabled",e.currentPage>=e.totalResults/e.limit-1))},dependencies:[H,N,J,z,q,W,$,A,V,pe,y,L],styles:[".container[_ngcontent-%COMP%]{padding:20px}.subtitle[_ngcontent-%COMP%]{text-align:center;color:#909090}.search[_ngcontent-%COMP%]{margin:auto}.member-list[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:16px}.member-card[_ngcontent-%COMP%]{width:95%;background:#f8f8f8;border-radius:12px;box-shadow:0 2px 4px #0000001a;transition:all .3s ease-in-out;cursor:pointer}.member-card[_ngcontent-%COMP%]:hover{transform:scale(1.06);box-shadow:0 4px 8px #00000026}.avatar[_ngcontent-%COMP%]{width:40px;height:40px;background-color:#53cd55;color:#fff;font-weight:700;font-size:16px;display:flex;align-items:center;justify-content:center;border-radius:50%;text-transform:uppercase}.member-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.email[_ngcontent-%COMP%]{font-size:.85rem;color:#666}.extra-info[_ngcontent-%COMP%]{margin-top:10px;padding-top:10px;border-top:1px solid #eee}.info-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-size:.9rem;color:#444}.footer[_ngcontent-%COMP%]{background:#ededed;font-size:.9rem;color:#969696;border-top:1px solid #eee;border-radius:0 0 9px 9px}.icon-edit[_ngcontent-%COMP%]:hover{color:#5a87e6}.icon-delete[_ngcontent-%COMP%]:hover{color:#e65a5a}"]})}return o})();var ke=[{path:"list",component:we},{path:"form/:action",component:Ie}];var Pt=(()=>{class o{static \u0275fac=function(i){return new(i||o)};static \u0275mod=oe({type:o});static \u0275inj=ae({imports:[me,ce.forChild(ke)]})}return o})();export{Pt as MemberModule};
