import{c as Fe,d as Te,e as Oe,f as Be,g as Ve}from"./chunk-L2Q2YWF7.js";import{b as Ee}from"./chunk-JELTFLJC.js";import{a as Ge}from"./chunk-NLT3YVZR.js";import{c as U,d as j,e as R,f as L,g as A,h as ke}from"./chunk-5ZQMS33S.js";import{a as Ie}from"./chunk-XKDRZ2FP.js";import{a as G}from"./chunk-J4WTDL2S.js";import{a as V}from"./chunk-QDRWFLAQ.js";import{b as T,c as Se,d as we,g as O,j as B}from"./chunk-GELPBASQ.js";import{A as Me,B as ye,D as F,a as v,d as P,f as I,h as b,k,l as he,o as Ce,p as _e,s as ve,v as be,z as xe}from"./chunk-VL4B4XMJ.js";import{a as De,c as Pe}from"./chunk-IFDCXV3N.js";import{a as fe,b as ge}from"./chunk-PR2HLA7M.js";import{_ as pe,ga as ue,j as ce,l as D,p as de}from"./chunk-DYBUUYLF.js";import{$b as r,Bb as Y,Cb as ee,Db as te,E as K,Eb as a,Fb as o,Gb as y,Kb as z,Nb as u,Pb as w,Xc as le,Ya as l,Za as p,Zb as ie,_b as oe,aa as Q,ac as S,bc as E,ec as ae,f as Z,fc as ne,fd as se,gc as re,hc as me,ic as _,ja as C,ka as X,ob as M,ra as g,sa as h,ub as d,zb as x}from"./chunk-KNMBK3NL.js";import{a as W,b as J}from"./chunk-JKOY2XUY.js";var je=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=C({type:n,selectors:[["app-confirm-dialog-component"]],standalone:!0,features:[_],decls:9,vars:2,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["mat-button","",3,"mat-dialog-close"],["mat-button","","color","warn",3,"mat-dialog-close"]],template:function(t,i){t&1&&(a(0,"h1",0),r(1,"Confirma\xE7\xE3o"),o(),a(2,"div",1),r(3,"Voce tem certeza de que deseja excluir esse funcionario? Ele n\xE3o podera acessar novamente o sistema da academia"),o(),a(4,"div",2)(5,"button",3),r(6,"Cancelar"),o(),a(7,"button",4),r(8,"Confirmar"),o()()),t&2&&(l(5),d("mat-dialog-close",!1),l(2),d("mat-dialog-close",!0))},dependencies:[ke,j,R,A,L,P,v]})}return n})();function Je(n,f){if(n&1){let e=z();a(0,"mat-card",17)(1,"mat-card-content")(2,"mat-card",18),r(3),o(),a(4,"div",19)(5,"div",20),r(6),o(),a(7,"div",21)(8,"div",22),r(9),o(),a(10,"div",23),r(11),o()()(),a(12,"div",23),r(13),o()(),a(14,"div",24)(15,"div",25),u("click",function(){let i=g(e).$implicit,m=w();return h(m.edit(i))}),a(16,"mat-icon"),r(17,"edit"),o(),a(18,"span"),r(19,"Editar"),o()(),a(20,"div",26),u("click",function(){let i=g(e).$implicit,m=w();return h(m.disable(i))}),a(21,"mat-icon"),r(22,"delete"),o(),a(23,"span"),r(24,"Remover"),o()()()()}if(n&2){let e=f.$implicit,t=w();l(2),oe("color: white ;background-color:",t.getTipoUsuarioClass(e.tipo_usuario),""),l(),E(" ",t.getTypeUserClass(e.tipo_usuario)," "),l(3),E(" ",t.getInitials(e.nome)," "),l(3),S(e.nome),l(2),S(e.username),l(2),E(" Data contratacao: ",e.data_de_contratacao," ")}}var Re=(()=>{class n{httpMethods;router;dialog;snackBar;pathUrlEmployee=V.USERS;employers;gym_id="";typeUser="";searchTerm="";limit=30;totalResults=0;currentPage=0;startDate=null;endDate=null;searchChange=new Z;constructor(e,t,i,m){this.httpMethods=e,this.router=t,this.dialog=i,this.snackBar=m}ngOnInit(){this.getIdGym(),this.search(),this.getTypeUser(),this.searchChange.pipe(K(150)).subscribe(e=>{this.searchEmployee(e,0)})}getIdGym(){this.gym_id=localStorage.getItem("academia")}getTypeUser(){this.typeUser=localStorage.getItem("tipo_usuario")}search(){this.searchEmployee(this.searchTerm,0)}getInitials(e){if(!e)return"";let i=e.trim().split(" ").map(m=>m.charAt(0).toUpperCase()).join("");return i.length>2?i.substring(0,2):i}create(){this.router.navigate(["/employee/form/create"]).then()}trackById(e,t){return t}searchEmployee(e="",t=0,i=this.limit){let m={active:!0,academia:this.gym_id,limit:i,offset:t};e&&(m.search=e),this.startDate&&(m.data_contratacao_after=this.startDate.toISOString().split("T")[0]),this.endDate&&(m.data_contratacao_before=this.endDate.toISOString().split("T")[0]),this.httpMethods.getPaginated(this.pathUrlEmployee,m).subscribe(s=>{this.employers=s.results,this.totalResults=s.count,this.currentPage=t/i})}onSearchChange(e){this.searchTerm=e,this.searchChange.next(e)}onDateRangeChange(e){e.start&&(this.startDate=e.start),e.end&&(this.endDate=e.end),this.search()}getTipoUsuarioClass(e){switch(e){case"A":return"#ea62e8";case"G":return"#3787e6";case"D":return"#2dd853";default:return"bg-gray-200 text-gray-800"}}getTypeUserClass(e){switch(e){case"A":return"Atendente";case"G":return"Gerente";case"D":return"Dono";default:return""}}edit(e){if(e.tipo_usuario==="D"){this.snackBar.open("N\xE3o \xE9 possivel alterar dados do dono da cademia","Fechar",{duration:5e3,verticalPosition:"top"});return}this.router.navigate([`/employee/form/${e.id}`]).then()}disable(e){if(e.tipo_usuario==="D"){this.snackBar.open("N\xE3o \xE9 ppssivel excluir o dono do estabelecimento","Fechar",{duration:5e3,verticalPosition:"top"});return}let t=this.dialog.open(je),i="desativar_usuario";t.afterClosed().subscribe(m=>{if(m){let s="Funcionario apagado";this.httpMethods.disable(this.pathUrlEmployee,e,i).subscribe(()=>{this.search()}),this.snackBar.open(s,"fechar",{duration:5e3,verticalPosition:"top"})}})}onPageChange(e){let t=e*this.limit;this.searchEmployee(this.searchTerm,t)}static \u0275fac=function(t){return new(t||n)(p(G),p(D),p(U),p(F))};static \u0275cmp=C({type:n,selectors:[["app-list"]],standalone:!0,features:[me([pe()]),_],decls:28,vars:8,consts:[["picker",""],[1,"employer-list"],[1,"subtitle","flex","justify-content-center"],[1,"flex","align-items-center","justify-content-between","w-full","mb-4"],[1,"p-1","overflow-hidden","flex","align-items-center","justify-content-between","align-content-center"],["appearance","outline",1,"search","w-30rem"],["matInput","text","placeholder","Digite o nome ou email",3,"ngModelChange","input","ngModel"],["appearance","outline",1,"w-3"],[3,"rangePicker"],["matStartDate","","placeholder","Data inicial",3,"dateChange"],["matEndDate","","placeholder","Data final",3,"dateChange"],["matIconSuffix","",3,"for"],[1,"align-self-start","mr-4"],["mat-raised-button","","color","primary",1,"add_button","bg-black-alpha-70","mt-2",2,"color","white",3,"click"],[1,"member-list","ml-6"],["class","member-card gap-3",4,"ngFor","ngForOf","ngForTrackBy"],[3,"pageChange","totalItems","itemsPerPage","currentPage"],[1,"member-card","gap-3"],[1,"absolute","top-0","right-0","m-2","px-2","py-1","text-sm","shadow-1","rounded"],[1,"member-info","flex","align-items-center","mb-2"],[1,"avatar","align-items-center"],[1,"flex-column"],[1,"font-bold"],[1,"email"],[1,"footer","p-2","flex","justify-content-around","align-items-center"],[1,"icon-edit","flex","items-center","gap-2",3,"click"],[1,"icon-delete","flex","items-center","gap-2",3,"click"]],template:function(t,i){if(t&1){let m=z();a(0,"div",1)(1,"h2"),r(2,"Funcion\xE1rios"),o(),a(3,"p",2),r(4,"Gerencie os funcionarios com acesso ao sistema"),o(),a(5,"div",3)(6,"div",4)(7,"mat-form-field",5)(8,"mat-label"),r(9,"Buscar Funcionario"),o(),a(10,"input",6),re("ngModelChange",function(c){return g(m),ne(i.searchTerm,c)||(i.searchTerm=c),h(c)}),u("input",function(){return g(m),h(i.onSearchChange(i.searchTerm))}),o()(),a(11,"mat-form-field",7)(12,"mat-label"),r(13,"Data Contrata\xE7\xE3o"),o(),a(14,"mat-date-range-input",8)(15,"input",9),u("dateChange",function(c){return g(m),h(i.onDateRangeChange({start:c.value,end:i.endDate}))}),o(),a(16,"input",10),u("dateChange",function(c){return g(m),h(i.onDateRangeChange({start:i.startDate,end:c.value}))}),o()(),y(17,"mat-datepicker-toggle",11)(18,"mat-date-range-picker",null,0),o()(),a(20,"div",12)(21,"button",13),u("click",function(){return g(m),h(i.create())}),a(22,"mat-icon"),r(23,"add"),o(),r(24," Novo funcion\xE1rio "),o()()(),a(25,"div",14),M(26,Je,25,8,"mat-card",15),o(),a(27,"app-paginator",16),u("pageChange",function(c){return g(m),h(i.onPageChange(c))}),o()()}if(t&2){let m=ie(19);l(10),ae("ngModel",i.searchTerm),l(4),d("rangePicker",m),l(3),d("for",m),l(9),d("ngForOf",i.employers)("ngForTrackBy",i.trackById),l(),d("totalItems",i.totalResults)("itemsPerPage",i.limit)("currentPage",i.currentPage)}},dependencies:[Ee,ge,fe,P,v,De,Pe,le,O,B,Me,I,k,Ce,T,Ie,we,Fe,Be,Ve,Te,Oe],styles:[".container[_ngcontent-%COMP%]{padding:20px}.subtitle[_ngcontent-%COMP%]{text-align:center;color:#909090}.search[_ngcontent-%COMP%]{margin:auto}.member-list[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:16px}.member-card[_ngcontent-%COMP%]{width:95%;background:#f8f8f8;border-radius:12px;box-shadow:0 2px 4px #0000001a;transition:all .3s ease-in-out;cursor:pointer}.member-card[_ngcontent-%COMP%]:hover{transform:scale(1.06);box-shadow:0 4px 8px #00000026}.avatar[_ngcontent-%COMP%]{width:40px;height:40px;background-color:#539ecd;color:#fff;font-weight:700;font-size:16px;display:flex;align-items:center;justify-content:center;border-radius:50%;text-transform:uppercase}.member-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.email[_ngcontent-%COMP%]{font-size:.85rem;color:#666}.extra-info[_ngcontent-%COMP%]{margin-top:10px;padding-top:10px;border-top:1px solid #eee}.info-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-size:.9rem;color:#444}.footer[_ngcontent-%COMP%]{background:#ededed;font-size:.9rem;color:#969696;border-top:1px solid #eee;border-radius:0 0 9px 9px}.icon-edit[_ngcontent-%COMP%]:hover{color:#5a87e6}.icon-delete[_ngcontent-%COMP%]:hover{color:#e65a5a}"]})}return n})();var Le=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=C({type:n,selectors:[["app-user-relink-confirmation"]],standalone:!0,features:[_],decls:9,vars:2,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["mat-button","",3,"mat-dialog-close"],["mat-button","","color","warn",3,"mat-dialog-close"]],template:function(t,i){t&1&&(a(0,"h1",0),r(1,"Confirma\xE7\xE3o"),o(),a(2,"div",1),r(3,"J\xE1 existe um usuario com esse email cadastrado em uma academia, Deseja vincular esse usuario a essa academia? (Ele n\xE3o podera acessar o sistema da academia anterior)"),o(),a(4,"div",2)(5,"button",3),r(6,"Cancelar"),o(),a(7,"button",4),r(8,"Confirmar"),o()()),t&2&&(l(5),d("mat-dialog-close",!1),l(2),d("mat-dialog-close",!0))},dependencies:[R,L,A,v,j]})}return n})();function Ze(n,f){n&1&&(a(0,"mat-error"),r(1," Campo Obrigatorio "),o())}function Ke(n,f){n&1&&(a(0,"mat-error"),r(1," Campo Obrigatorio "),o())}function Qe(n,f){n&1&&(a(0,"mat-error"),r(1," Insira um email valido "),o())}function Xe(n,f){n&1&&(a(0,"mat-error"),r(1," Campo Obrigatorio "),o())}function Ye(n,f){n&1&&(a(0,"mat-error"),r(1," Deve conter no minimo 6 caracteres. "),o())}function et(n,f){n&1&&(a(0,"mat-error"),r(1," Deve conter um n\xFAmero e um caracter especial "),o())}function tt(n,f){if(n&1&&(a(0,"mat-option",9),r(1),o()),n&2){let e=f.$implicit;d("value",e.value),l(),E(" ",e.viewValue," ")}}var Ae=(()=>{class n{httpMethods;formBuilder;router;route;snackBar;dialog;action="";pathUrlEmployee=V.USERS;formGroup;created=!0;gymId="";title="Cadastro de funcion\xE1rio";getGym(){this.gymId=localStorage.getItem("academia"),this.gymId&&this.formGroup.patchValue({academia:this.gymId})}constructor(e,t,i,m,s,c){this.httpMethods=e,this.formBuilder=t,this.router=i,this.route=m,this.snackBar=s,this.dialog=c,this.formGroup=this.formBuilder.group({id:[],nome:["",b.required],username:["",[b.required,b.email]],password:["",[b.required,b.minLength(6),b.pattern("^(?=.*\\d)(?=.*[@$!%*?&])[A-Za-z\\d@$!%*?&]+$")]],tipo_usuario:["",b.required],academia:[""]})}ngOnInit(){this.getGym(),this.retriveCallBack()}cargos=[{value:"G",viewValue:"Gerente"},{value:"A",viewValue:"Atendente"}];retriveCallBack(){this.route.paramMap.subscribe(e=>{this.action=e.get("action"),this.created=!(this.action&&this.action!=="create"),this.created||(this.title="Edi\xE7\xE3o de funcion\xE1rio",this.httpMethods.get(this.pathUrlEmployee+this.action+"/").subscribe(t=>{this.formGroup.setValue({id:t.id,nome:t.nome,username:t.username,password:"",tipo_usuario:t.tipo_usuario,academia:this.gymId})}))})}saveOrUpdate(e){if(this.created)this.httpMethods.get(this.pathUrlEmployee+`?email=${e.username}`).subscribe(t=>{if(t&&t.results.length>0)this.dialog.open(Le).afterClosed().subscribe(m=>{if(m){let s=t.results[0].id,c=J(W({},e),{usuario:s});this.httpMethods.post(this.pathUrlEmployee+"alterar_academia/",c).subscribe(()=>{this.router.navigate(["/employee/list"])})}});else{let i="Funcionario cadastrado";this.httpMethods.post(this.pathUrlEmployee,e).subscribe(()=>{this.router.navigate(["/employee/list"]).then(),this.snackBar.open(i,"Fechar",{duration:5e3,verticalPosition:"top"})})}});else{let t="Funcionario Atualizado";this.httpMethods.patch(this.pathUrlEmployee,e).subscribe(()=>{this.router.navigate(["/employee/list"]).then(),this.snackBar.open(t,"Fechar",{duration:5e3,verticalPosition:"top"})})}}static \u0275fac=function(t){return new(t||n)(p(G),p(xe),p(D),p(ce),p(F),p(U))};static \u0275cmp=C({type:n,selectors:[["app-form"]],standalone:!0,features:[_],decls:30,vars:9,consts:[[1,"container"],[1,"mat-elevation-z2","form",3,"ngSubmit","formGroup"],[1,"form-title"],["appearance","fill",1,"nome"],["matInput","","formControlName","nome","placeholder","Digite o nome do funcionario"],["appearance","fill"],["matInput","","type","email","formControlName","username","placeholder","Digite o email do funcinario"],["matInput","","type","password","formControlName","password","placeholder","Digite uma senha"],["formControlName","tipo_usuario","ARIA-PLACEHOLDER","Cargo"],[3,"value"],["mat-raised-button","","color","primary","type","submit",1,"save",3,"disabled"]],template:function(t,i){if(t&1&&(a(0,"div",0)(1,"form",1),u("ngSubmit",function(){return i.saveOrUpdate(i.formGroup.value)}),a(2,"h2",2),r(3),o(),a(4,"mat-form-field",3)(5,"mat-label"),r(6,"Nome"),o(),y(7,"input",4),M(8,Ze,2,0,"mat-error"),o(),a(9,"mat-form-field",5)(10,"mat-label"),r(11,"Email"),o(),y(12,"input",6),M(13,Ke,2,0,"mat-error")(14,Qe,2,0,"mat-error"),o(),a(15,"mat-form-field",5)(16,"mat-label"),r(17,"Senha"),o(),y(18,"input",7),M(19,Xe,2,0,"mat-error")(20,Ye,2,0,"mat-error")(21,et,2,0,"mat-error"),o(),a(22,"mat-form-field",5)(23,"mat-label"),r(24,"Cargo"),o(),a(25,"mat-select",8),ee(26,tt,2,2,"mat-option",9,Y),o()(),a(28,"button",10),r(29,"Salvar"),o()()()),t&2){let m,s,c,q,$,H;l(),d("formGroup",i.formGroup),l(2),S(i.title),l(5),x((m=i.formGroup.get("nome"))!=null&&m.hasError("required")?8:-1),l(5),x((s=i.formGroup.get("username"))!=null&&s.hasError("required")?13:-1),l(),x((c=i.formGroup.get("username"))!=null&&c.hasError("email")?14:-1),l(5),x((q=i.formGroup.get("password"))!=null&&q.hasError("required")?19:-1),l(),x(($=i.formGroup.get("password"))!=null&&$.hasError("minlength")?20:-1),l(),x((H=i.formGroup.get("password"))!=null&&H.hasError("pattern")?21:-1),l(5),te(i.cargos),l(2),d("disabled",!i.formGroup.valid)}},dependencies:[v,O,B,T,ye,_e,I,k,he,ve,be,Ge,ue,Se],styles:[".container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh;background-color:#f4f7fc}.form[_ngcontent-%COMP%]{width:100%;max-width:500px;padding:40px;background-color:#fff;border-radius:12px;box-shadow:0 4px 12px #0000001a;font-family:Arial,sans-serif}.form-title[_ngcontent-%COMP%]{text-align:center;font-size:24px;color:#333;margin-bottom:30px}mat-form-field[_ngcontent-%COMP%]{width:100%;margin-bottom:20px}mat-label[_ngcontent-%COMP%]{font-weight:600;color:#333}input[_ngcontent-%COMP%]{font-size:16px;padding:10px;border-radius:4px;border:1px solid #ddd}button[_ngcontent-%COMP%]{width:100%;padding:14px;font-size:16px;border:none;border-radius:4px;cursor:pointer;background-color:#00ff2a;color:#fff;transition:background-color .3s ease-in-out}.input-field[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{font-size:16px}button[disabled][_ngcontent-%COMP%]{background-color:#b0bec5;cursor:not-allowed}@media (max-width: 600px){.form[_ngcontent-%COMP%]{padding:20px}.form-title[_ngcontent-%COMP%]{font-size:20px}button[_ngcontent-%COMP%]{font-size:14px;padding:12px}}"]})}return n})();var Ne=[{path:"list",component:Re},{path:"form/:action",component:Ae}];var Lt=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=X({type:n});static \u0275inj=Q({imports:[se,de.forChild(Ne)]})}return n})();export{Lt as EmployeeModule};
