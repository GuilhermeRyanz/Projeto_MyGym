import{b as Di,d as ki,e as Ri,f as Fi,g as Li,h as Vi}from"./chunk-7UJHTAXR.js";import{a as zi,b as ji,c as Ni,d as Bi,e as Gi,f as qi,g as Ui,h as Hi,i as $i,j as Yi,k as Wi}from"./chunk-V6Q5TUQW.js";import"./chunk-TZXDADV7.js";import{a as Et}from"./chunk-PX2ZTFAY.js";import{a as de,b as pe,c as Ot,h as Ai}from"./chunk-MMD3N6TB.js";import{a as N}from"./chunk-ED4W6NZD.js";import{a as ot,b as bi}from"./chunk-AWHMWCAF.js";import{b as z,c as Mi,d as wi,f as Ii,g as k,h as Ti,j,k as Oi,l as G}from"./chunk-ACH2ET7Q.js";import{$ as ce,A as Ci,B as Pt,E as Mt,H as wt,I as nt,J as It,K as Si,L as xi,Q as Pi,U as at,Z as Tt,a as F,c as re,d as be,l as hi,n as fi,p as yi,q as L,s as U,u as V,v as Ct,x as St,y as xt,z as le}from"./chunk-DYA4TUSH.js";import{c as _i,d as se,e as gi,g as Nt,h as vi,j as ye}from"./chunk-CARY4E7O.js";import{a as rt,c as Ei}from"./chunk-LKV62IVN.js";import{A as _e,B as ge,J as ti,K as ei,L as ve,M as ne,N as ii,O as oi,W as ni,Z as ae,ba as ai,da as ri,ea as si,fa as li,j as Xe,ka as ci,l as et,la as di,ma as pi,na as it,oa as mi,p as Ke,pa as ui,q as oe,s as Ze,x as Je,z as yt}from"./chunk-MNF6TJHE.js";import{$ as kt,$b as tt,$c as bt,A as $t,Ab as D,Ac as B,Ba as Z,Bb as r,Bc as jt,Cb as a,Db as b,E as Yt,Eb as mt,Fb as ut,G as he,Ha as Ve,Hb as y,I as Ee,Jc as ee,Kb as u,Mb as h,Nb as Ne,Ob as Be,Pb as Ge,Qb as fe,Rb as lt,Rc as ie,S as Ae,Sb as Y,Sc as Ye,T as Wt,Tb as W,Tc as We,U as E,Ua as Zt,W as De,Wb as J,Xa as l,Ya as p,Yb as s,Yc as Qe,Z as ke,Zb as w,_ as Re,_a as ze,_b as S,_c as vt,a as Ut,ac as ht,ba as X,bc as ft,c as Me,cc as _t,db as Jt,dc as zt,ea as st,ec as P,f as T,gc as qe,h as we,hc as Ue,ia as x,ic as Q,ja as Rt,jc as gt,ka as Qt,kb as Lt,kc as He,lc as $e,m as Ie,nb as v,pa as Fe,q as Te,qa as _,qb as te,ra as g,rb as $,sa as Ft,sb as m,ta as Le,ub as Vt,v as Oe,vb as je,wa as Xt,wc as ct,x as Ht,xb as M,ya as K,yb as pt,z as Dt,za as Kt,zb as A}from"./chunk-BE5RT4AU.js";import{a as At}from"./chunk-JKOY2XUY.js";var uo=(o,d)=>d.id,ho=(o,d)=>({"bg-black-alpha-70":o,"text-gray":d});function fo(o,d){if(o&1){let t=y();r(0,"mat-card",6)(1,"section")(2,"div",8)(3,"div",9)(4,"span"),s(5),a(),r(6,"span"),s(7),a()(),r(8,"span"),s(9),Q(10,"currency"),a()(),r(11,"span"),s(12),a()(),r(13,"div",8)(14,"div"),s(15," quantidade: "),r(16,"button",10),u("click",function(){let i=_(t).$implicit,n=h();return g(n.decreaseQuantity(i))}),s(17,"-"),a(),r(18,"span"),s(19),a(),r(20,"button",11),u("click",function(){let i=_(t).$implicit,n=h();return g(n.increaseQuantity(i))}),s(21,"+"),a()(),r(22,"button",12),u("click",function(){let i=_(t).$implicit,n=h();return g(n.addToCart(i))}),s(23," Adicionar "),a()()()}if(o&2){let t=d.$implicit,e=h();l(5),w(t.nome||"Produto sem nome "),l(2),w(t.categoria||"Sem categoria"),l(2),w(gt(10,7,t.preco,"BRL")),l(3),S("Estoque: ",e.verification_total(t),""),l(7),S(" ",e.getQuantity(t.id)," "),l(3),m("ngClass",Ue(10,ho,e.verification_total(t)>0,e.verification_total(t)==0))("disabled",e.verification_total(t)==0)}}function _o(o,d){o&1&&(r(0,"div",7)(1,"div"),s(2," Nenhum produto encontrado "),a()())}var Xi=(()=>{class o{dialogRef;data;httpMethods;snackBar;products=[];pathUrl=G.PRODUCT;searchTerm="";totalResults=0;currentPage=0;limit=6;offset=0;loading=!1;quantities={};constructor(t,e,i,n){this.dialogRef=t,this.data=e,this.httpMethods=i,this.snackBar=n}unsubscribe$=new T;ngOnInit(){this.loadProducts()}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}onScroll(){let t=document.getElementById("container-prod");if(!t)return;let e=t.scrollTop,i=t.scrollHeight,n=e+t.clientHeight>=i-10;this.loading||n&&this.products.length<this.totalResults&&this.loadProducts()}onSearch(){this.products=[],this.offset=0,this.totalResults=0,this.quantities={},this.loadProducts()}loadProducts(){if(this.offset>=this.totalResults&&this.offset!==0)return;this.loading=!0;let t={expand:["lotes"],academia:this.data.academia,search:this.searchTerm,limit:this.limit,offset:this.offset};this.httpMethods.getPaginated(this.pathUrl,t).pipe(E(this.unsubscribe$)).subscribe(e=>{this.products.push(...e.results),this.totalResults=e.totalResults,this.products.forEach(i=>{i.id&&!this.quantities[i.id]&&(this.quantities[i.id]=1)}),this.loading=!1,this.offset+=this.limit})}getQuantity(t){return this.quantities[t]||1}decreaseQuantity(t){t.id&&this.quantities[t.id]>1&&this.quantities[t.id]--}verification_total(t){let e=this.data.cartItems.find(i=>i.produto.id===t.id);return e?(t.quantidade_estoque||0)-e.quantidade:t.quantidade_estoque||0}increaseQuantity(t){t.id&&(t.quantidade_estoque===void 0||this.quantities[t.id]<t.quantidade_estoque)&&this.quantities[t.id]++}addToCart(t){if(!t||!t.id||!t.preco){this.snackBar.open("Selecione um produto v\xE1lido.","Fechar",{duration:3e3});return}let e=this.getQuantity(t.id);if(e<=0){this.snackBar.open("Quantidade deve ser maior que zero.","Fechar",{duration:3e3});return}if(t.quantidade_estoque!==void 0&&e>t.quantidade_estoque){this.snackBar.open("Quantidade maior que o estoque dispon\xEDvel.","Fechar",{duration:3e3});return}let i={produto:t,quantidade:e,preco_unitario:t.preco};this.dialogRef.close(i)}console=console;static \u0275fac=function(e){return new(e||o)(p(de),p(pe),p(N),p(Tt))};static \u0275cmp=x({type:o,selectors:[["app-product-select-modal"]],standalone:!0,features:[P],decls:12,vars:2,consts:[[1,"grid","align-items-center","p-3"],[1,"col-12","flex","justify-content-start"],[1,"font-bold","text-2xl"],["appearance","outline",1,"col-12"],["matInput","text","placeholder","Buscar produtos...",3,"ngModelChange","input","ngModel"],["id","container-prod",1,"grid","container-prod","p-2","gap-2",2,"max-height","300px","overflow-y","auto",3,"scroll"],["appearance","outlined",1,"col-12"],[1,"col-12","align-items-center","justify-content-center","align-content-center"],[1,"flex","justify-content-between","align-items-center"],[1,"flex-wrap"],["mat-button","",1,"add_button",2,"width","1%",3,"click"],["mat-button","",1,"add_button",3,"click"],["mat-raised-button","","color","primary",1,"add_button","bg-black-alpha-70","text-white-alpha-90",3,"click","ngClass","disabled"]],template:function(e,i){e&1&&(r(0,"main",0)(1,"div",1)(2,"div",2),s(3,"Adicionar Produto"),a()(),r(4,"mat-form-field",3)(5,"mat-label"),s(6,"Buscar Produto"),a(),r(7,"input",4),_t("ngModelChange",function(c){return ft(i.searchTerm,c)||(i.searchTerm=c),c}),u("input",function(){return i.onSearch()}),a()(),r(8,"div",5),u("scroll",function(){return i.onScroll()}),A(9,fo,24,13,"mat-card",6,uo),v(11,_o,3,0,"div",7),a()()),e&2&&(l(7),ht("ngModel",i.searchTerm),l(2),D(i.products),l(2),M(i.products.length===0?11:-1))},dependencies:[nt,L,V,St,vt,z,k,j,rt,F,ie],styles:["[_nghost-%COMP%]{display:block;max-width:100vw;overflow-x:hidden}main[_ngcontent-%COMP%]{display:block;width:100%;max-width:100%;overflow-x:hidden;box-sizing:border-box}mat-card[_ngcontent-%COMP%]{width:100%;max-width:100%;box-sizing:border-box;overflow-x:hidden}#container-prod[_ngcontent-%COMP%]{width:100%;max-width:100%;overflow-x:hidden}"]})}return o})();var Po=["panel"],Mo=["*"];function wo(o,d){if(o&1){let t=y();r(0,"div",1,0),u("@panelAnimation.done",function(i){_(t);let n=h();return g(n._animationDone.next(i))}),Be(2),a()}if(o&2){let t=d.id,e=h();je(e._classList),Vt("mat-mdc-autocomplete-visible",e.showPanel)("mat-mdc-autocomplete-hidden",!e.showPanel)("mat-primary",e._color==="primary")("mat-accent",e._color==="accent")("mat-warn",e._color==="warn"),m("id",e.id)("@panelAnimation",e.isOpen?"visible":"hidden"),$("aria-label",e.ariaLabel||null)("aria-labelledby",e._getPanelAriaLabelledby(t))}}var Io=_i("panelAnimation",[vi("void, hidden",Nt({opacity:0,transform:"scaleY(0.8)"})),ye(":enter, hidden => visible",[gi([se("0.03s linear",Nt({opacity:1})),se("0.12s cubic-bezier(0, 0, 0.2, 1)",Nt({transform:"scaleY(1)"}))])]),ye(":leave, visible => hidden",[se("0.075s linear",Nt({opacity:0}))])]),To=0,Ce=class{constructor(d,t){this.source=d,this.option=t}},Zi=new X("mat-autocomplete-default-options",{providedIn:"root",factory:Oo});function Oo(){return{autoActiveFirstOption:!1,autoSelectActiveOption:!1,hideSingleSelectionIndicator:!1,requireSelection:!1}}var Ji=(()=>{class o{get isOpen(){return this._isOpen&&this.showPanel}_setColor(t){this._color=t,this._changeDetectorRef.markForCheck()}set classList(t){this._classList=t,this._elementRef.nativeElement.className=""}get hideSingleSelectionIndicator(){return this._hideSingleSelectionIndicator}set hideSingleSelectionIndicator(t){this._hideSingleSelectionIndicator=t,this._syncParentProperties()}_syncParentProperties(){if(this.options)for(let t of this.options)t._changeDetectorRef.markForCheck()}constructor(t,e,i,n){this._changeDetectorRef=t,this._elementRef=e,this._defaults=i,this._activeOptionChanges=Ut.EMPTY,this._animationDone=new K,this.showPanel=!1,this._isOpen=!1,this.displayWith=null,this.optionSelected=new K,this.opened=new K,this.closed=new K,this.optionActivated=new K,this.id=`mat-autocomplete-${To++}`,this.inertGroups=n?.SAFARI||!1,this.autoActiveFirstOption=!!i.autoActiveFirstOption,this.autoSelectActiveOption=!!i.autoSelectActiveOption,this.requireSelection=!!i.requireSelection,this._hideSingleSelectionIndicator=this._defaults.hideSingleSelectionIndicator??!1}ngAfterContentInit(){this._keyManager=new oi(this.options).withWrap().skipPredicate(this._skipPredicate),this._activeOptionChanges=this._keyManager.change.subscribe(t=>{this.isOpen&&this.optionActivated.emit({source:this,option:this.options.toArray()[t]||null})}),this._setVisibility()}ngOnDestroy(){this._keyManager?.destroy(),this._activeOptionChanges.unsubscribe(),this._animationDone.complete()}_setScrollTop(t){this.panel&&(this.panel.nativeElement.scrollTop=t)}_getScrollTop(){return this.panel?this.panel.nativeElement.scrollTop:0}_setVisibility(){this.showPanel=!!this.options.length,this._changeDetectorRef.markForCheck()}_emitSelectEvent(t){let e=new Ce(this,t);this.optionSelected.emit(e)}_getPanelAriaLabelledby(t){if(this.ariaLabel)return null;let e=t?t+" ":"";return this.ariaLabelledby?e+this.ariaLabelledby:t}_skipPredicate(){return!1}static{this.\u0275fac=function(e){return new(e||o)(p(ct),p(Z),p(Zi),p(oe))}}static{this.\u0275cmp=x({type:o,selectors:[["mat-autocomplete"]],contentQueries:function(e,i,n){if(e&1&&(fe(n,it,5),fe(n,di,5)),e&2){let c;Y(c=W())&&(i.options=c),Y(c=W())&&(i.optionGroups=c)}},viewQuery:function(e,i){if(e&1&&(lt(ze,7),lt(Po,5)),e&2){let n;Y(n=W())&&(i.template=n.first),Y(n=W())&&(i.panel=n.first)}},hostAttrs:[1,"mat-mdc-autocomplete"],inputs:{ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],displayWith:"displayWith",autoActiveFirstOption:[2,"autoActiveFirstOption","autoActiveFirstOption",B],autoSelectActiveOption:[2,"autoSelectActiveOption","autoSelectActiveOption",B],requireSelection:[2,"requireSelection","requireSelection",B],panelWidth:"panelWidth",disableRipple:[2,"disableRipple","disableRipple",B],classList:[0,"class","classList"],hideSingleSelectionIndicator:[2,"hideSingleSelectionIndicator","hideSingleSelectionIndicator",B]},outputs:{optionSelected:"optionSelected",opened:"opened",closed:"closed",optionActivated:"optionActivated"},exportAs:["matAutocomplete"],standalone:!0,features:[zt([{provide:ci,useExisting:o}]),Lt,P],ngContentSelectors:Mo,decls:1,vars:0,consts:[["panel",""],["role","listbox",1,"mat-mdc-autocomplete-panel","mdc-menu-surface","mdc-menu-surface--open",3,"id"]],template:function(e,i){e&1&&(Ne(),v(0,wo,3,16,"ng-template"))},styles:["div.mat-mdc-autocomplete-panel{width:100%;max-height:256px;visibility:hidden;transform-origin:center top;overflow:auto;padding:8px 0;box-sizing:border-box;position:static;border-radius:var(--mat-autocomplete-container-shape, var(--mat-app-corner-extra-small));box-shadow:var(--mat-autocomplete-container-elevation-shadow);background-color:var(--mat-autocomplete-background-color, var(--mat-app-surface-container))}.cdk-high-contrast-active div.mat-mdc-autocomplete-panel{outline:solid 1px}.cdk-overlay-pane:not(.mat-mdc-autocomplete-panel-above) div.mat-mdc-autocomplete-panel{border-top-left-radius:0;border-top-right-radius:0}.mat-mdc-autocomplete-panel-above div.mat-mdc-autocomplete-panel{border-bottom-left-radius:0;border-bottom-right-radius:0;transform-origin:center bottom}div.mat-mdc-autocomplete-panel.mat-mdc-autocomplete-visible{visibility:visible}div.mat-mdc-autocomplete-panel.mat-mdc-autocomplete-hidden{visibility:hidden;pointer-events:none}mat-autocomplete{display:none}"],encapsulation:2,data:{animation:[Io]},changeDetection:0})}}return o})();var Eo={provide:yi,useExisting:ke(()=>Se),multi:!0};var Ao=new X("mat-autocomplete-scroll-strategy",{providedIn:"root",factory:()=>{let o=st(at);return()=>o.scrollStrategies.reposition()}});var Se=(()=>{class o{constructor(t,e,i,n,c,f,C,R,q,dt,I){this._element=t,this._overlay=e,this._viewContainerRef=i,this._zone=n,this._changeDetectorRef=c,this._dir=C,this._formField=R,this._document=q,this._viewportRuler=dt,this._defaults=I,this._componentDestroyed=!1,this._manuallyFloatingLabel=!1,this._viewportSubscription=Ut.EMPTY,this._breakpointObserver=st(ti),this._handsetLandscapeSubscription=Ut.EMPTY,this._canOpenOnNextFocus=!0,this._closeKeyEventStream=new T,this._windowBlurHandler=()=>{this._canOpenOnNextFocus=this._document.activeElement!==this._element.nativeElement||this.panelOpen},this._onChange=()=>{},this._onTouched=()=>{},this.position="auto",this.autocompleteAttribute="off",this._initialized=new T,this._injector=st(Xt),this._aboveClass="mat-mdc-autocomplete-panel-above",this._overlayAttached=!1,this.optionSelections=Oe(()=>{let O=this.autocomplete?this.autocomplete.options:null;return O?O.changes.pipe(Ae(O),Wt(()=>Dt(...O.map(qt=>qt.onSelectionChange)))):this._initialized.pipe(Wt(()=>this.optionSelections))}),this._handlePanelKeydown=O=>{(O.keyCode===27&&!yt(O)||O.keyCode===38&&yt(O,"altKey"))&&(this._pendingAutoselectedOption&&(this._updateNativeInputValue(this._valueBeforeAutoSelection??""),this._pendingAutoselectedOption=null),this._closeKeyEventStream.next(),this._resetActiveItem(),O.stopPropagation(),O.preventDefault())},this._trackedModal=null,this._scrollStrategy=f}ngAfterViewInit(){this._initialized.next(),this._initialized.complete();let t=this._getWindow();typeof t<"u"&&this._zone.runOutsideAngular(()=>t.addEventListener("blur",this._windowBlurHandler))}ngOnChanges(t){t.position&&this._positionStrategy&&(this._setStrategyPositions(this._positionStrategy),this.panelOpen&&this._overlayRef.updatePosition())}ngOnDestroy(){let t=this._getWindow();typeof t<"u"&&t.removeEventListener("blur",this._windowBlurHandler),this._handsetLandscapeSubscription.unsubscribe(),this._viewportSubscription.unsubscribe(),this._componentDestroyed=!0,this._destroyPanel(),this._closeKeyEventStream.complete(),this._clearFromModal()}get panelOpen(){return this._overlayAttached&&this.autocomplete.showPanel}openPanel(){this._openPanelInternal()}closePanel(){this._resetLabel(),this._overlayAttached&&(this.panelOpen&&this._zone.run(()=>{this.autocomplete.closed.emit()}),this.autocomplete._latestOpeningTrigger===this&&(this.autocomplete._isOpen=!1,this.autocomplete._latestOpeningTrigger=null),this._overlayAttached=!1,this._pendingAutoselectedOption=null,this._overlayRef&&this._overlayRef.hasAttached()&&(this._overlayRef.detach(),this._closingActionsSubscription.unsubscribe()),this._updatePanelState(),this._componentDestroyed||this._changeDetectorRef.detectChanges(),this._trackedModal&&ne(this._trackedModal,"aria-owns",this.autocomplete.id))}updatePosition(){this._overlayAttached&&this._overlayRef.updatePosition()}get panelClosingActions(){return Dt(this.optionSelections,this.autocomplete._keyManager.tabOut.pipe($t(()=>this._overlayAttached)),this._closeKeyEventStream,this._getOutsideClickStream(),this._overlayRef?this._overlayRef.detachments().pipe($t(()=>this._overlayAttached)):Ie()).pipe(Te(t=>t instanceof pi?t:null))}get activeOption(){return this.autocomplete&&this.autocomplete._keyManager?this.autocomplete._keyManager.activeItem:null}_getOutsideClickStream(){return Dt(Ht(this._document,"click"),Ht(this._document,"auxclick"),Ht(this._document,"touchend")).pipe($t(t=>{let e=Je(t),i=this._formField?this._formField.getConnectedOverlayOrigin().nativeElement:null,n=this.connectedTo?this.connectedTo.elementRef.nativeElement:null;return this._overlayAttached&&e!==this._element.nativeElement&&this._document.activeElement!==this._element.nativeElement&&(!i||!i.contains(e))&&(!n||!n.contains(e))&&!!this._overlayRef&&!this._overlayRef.overlayElement.contains(e)}))}writeValue(t){Promise.resolve(null).then(()=>this._assignOptionValue(t))}registerOnChange(t){this._onChange=t}registerOnTouched(t){this._onTouched=t}setDisabledState(t){this._element.nativeElement.disabled=t}_handleKeydown(t){let e=t.keyCode,i=yt(t);if(e===27&&!i&&t.preventDefault(),this._valueOnLastKeydown=this._element.nativeElement.value,this.activeOption&&e===13&&this.panelOpen&&!i)this.activeOption._selectViaInteraction(),this._resetActiveItem(),t.preventDefault();else if(this.autocomplete){let n=this.autocomplete._keyManager.activeItem,c=e===38||e===40;e===9||c&&!i&&this.panelOpen?this.autocomplete._keyManager.onKeydown(t):c&&this._canOpen()&&this._openPanelInternal(this._valueOnLastKeydown),(c||this.autocomplete._keyManager.activeItem!==n)&&(this._scrollToOption(this.autocomplete._keyManager.activeItemIndex||0),this.autocomplete.autoSelectActiveOption&&this.activeOption&&(this._pendingAutoselectedOption||(this._valueBeforeAutoSelection=this._valueOnLastKeydown),this._pendingAutoselectedOption=this.activeOption,this._assignOptionValue(this.activeOption.value)))}}_handleInput(t){let e=t.target,i=e.value;if(e.type==="number"&&(i=i==""?null:parseFloat(i)),this._previousValue!==i){if(this._previousValue=i,this._pendingAutoselectedOption=null,(!this.autocomplete||!this.autocomplete.requireSelection)&&this._onChange(i),!i)this._clearPreviousSelectedOption(null,!1);else if(this.panelOpen&&!this.autocomplete.requireSelection){let n=this.autocomplete.options?.find(c=>c.selected);if(n){let c=this._getDisplayValue(n.value);i!==c&&n.deselect(!1)}}if(this._canOpen()&&this._document.activeElement===t.target){let n=this._valueOnLastKeydown??this._element.nativeElement.value;this._valueOnLastKeydown=null,this._openPanelInternal(n)}}}_handleFocus(){this._canOpenOnNextFocus?this._canOpen()&&(this._previousValue=this._element.nativeElement.value,this._attachOverlay(this._previousValue),this._floatLabel(!0)):this._canOpenOnNextFocus=!0}_handleClick(){this._canOpen()&&!this.panelOpen&&this._openPanelInternal()}_floatLabel(t=!1){this._formField&&this._formField.floatLabel==="auto"&&(t?this._formField._animateAndLockLabel():this._formField.floatLabel="always",this._manuallyFloatingLabel=!0)}_resetLabel(){this._manuallyFloatingLabel&&(this._formField&&(this._formField.floatLabel="auto"),this._manuallyFloatingLabel=!1)}_subscribeToClosingActions(){let t=new Me(i=>{te(()=>{i.next()},{injector:this._injector})}),e=this.autocomplete.options.changes.pipe(De(()=>this._positionStrategy.reapplyLastPosition()),Ee(0));return Dt(t,e).pipe(Wt(()=>this._zone.run(()=>{let i=this.panelOpen;return this._resetActiveItem(),this._updatePanelState(),this._changeDetectorRef.detectChanges(),this.panelOpen&&this._overlayRef.updatePosition(),i!==this.panelOpen&&(this.panelOpen?this._emitOpened():this.autocomplete.closed.emit()),this.panelClosingActions})),he(1)).subscribe(i=>this._setValueAndClose(i))}_emitOpened(){this.autocomplete.opened.emit()}_destroyPanel(){this._overlayRef&&(this.closePanel(),this._overlayRef.dispose(),this._overlayRef=null)}_getDisplayValue(t){let e=this.autocomplete;return e&&e.displayWith?e.displayWith(t):t}_assignOptionValue(t){let e=this._getDisplayValue(t);t==null&&this._clearPreviousSelectedOption(null,!1),this._updateNativeInputValue(e??"")}_updateNativeInputValue(t){this._formField?this._formField._control.value=t:this._element.nativeElement.value=t,this._previousValue=t}_setValueAndClose(t){let e=this.autocomplete,i=t?t.source:this._pendingAutoselectedOption;i?(this._clearPreviousSelectedOption(i),this._assignOptionValue(i.value),this._onChange(i.value),e._emitSelectEvent(i),this._element.nativeElement.focus()):e.requireSelection&&this._element.nativeElement.value!==this._valueOnAttach&&(this._clearPreviousSelectedOption(null),this._assignOptionValue(null),e._animationDone?e._animationDone.pipe(he(1)).subscribe(()=>this._onChange(null)):this._onChange(null)),this.closePanel()}_clearPreviousSelectedOption(t,e){this.autocomplete?.options?.forEach(i=>{i!==t&&i.selected&&i.deselect(e)})}_openPanelInternal(t=this._element.nativeElement.value){if(this._attachOverlay(t),this._floatLabel(),this._trackedModal){let e=this.autocomplete.id;ve(this._trackedModal,"aria-owns",e)}}_attachOverlay(t){this.autocomplete;let e=this._overlayRef;e?(this._positionStrategy.setOrigin(this._getConnectedElement()),e.updateSize({width:this._getPanelWidth()})):(this._portal=new xi(this.autocomplete.template,this._viewContainerRef,{id:this._formField?.getLabelId()}),e=this._overlay.create(this._getOverlayConfig()),this._overlayRef=e,this._viewportSubscription=this._viewportRuler.change().subscribe(()=>{this.panelOpen&&e&&e.updateSize({width:this._getPanelWidth()})}),this._handsetLandscapeSubscription=this._breakpointObserver.observe(ei.HandsetLandscape).subscribe(n=>{n.matches?this._positionStrategy.withFlexibleDimensions(!0).withGrowAfterOpen(!0).withViewportMargin(8):this._positionStrategy.withFlexibleDimensions(!1).withGrowAfterOpen(!1).withViewportMargin(0)})),e&&!e.hasAttached()&&(e.attach(this._portal),this._valueOnAttach=t,this._valueOnLastKeydown=null,this._closingActionsSubscription=this._subscribeToClosingActions());let i=this.panelOpen;this.autocomplete._isOpen=this._overlayAttached=!0,this.autocomplete._latestOpeningTrigger=this,this.autocomplete._setColor(this._formField?.color),this._updatePanelState(),this._applyModalPanelOwnership(),this.panelOpen&&i!==this.panelOpen&&this._emitOpened()}_updatePanelState(){if(this.autocomplete._setVisibility(),this.panelOpen){let t=this._overlayRef;this._keydownSubscription||(this._keydownSubscription=t.keydownEvents().subscribe(this._handlePanelKeydown)),this._outsideClickSubscription||(this._outsideClickSubscription=t.outsidePointerEvents().subscribe())}else this._keydownSubscription?.unsubscribe(),this._outsideClickSubscription?.unsubscribe(),this._keydownSubscription=this._outsideClickSubscription=null}_getOverlayConfig(){return new Pi({positionStrategy:this._getOverlayPosition(),scrollStrategy:this._scrollStrategy(),width:this._getPanelWidth(),direction:this._dir??void 0,panelClass:this._defaults?.overlayPanelClass})}_getOverlayPosition(){let t=this._overlay.position().flexibleConnectedTo(this._getConnectedElement()).withFlexibleDimensions(!1).withPush(!1);return this._setStrategyPositions(t),this._positionStrategy=t,t}_setStrategyPositions(t){let e=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],i=this._aboveClass,n=[{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",panelClass:i},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom",panelClass:i}],c;this.position==="above"?c=n:this.position==="below"?c=e:c=[...e,...n],t.withPositions(c)}_getConnectedElement(){return this.connectedTo?this.connectedTo.elementRef:this._formField?this._formField.getConnectedOverlayOrigin():this._element}_getPanelWidth(){return this.autocomplete.panelWidth||this._getHostWidth()}_getHostWidth(){return this._getConnectedElement().nativeElement.getBoundingClientRect().width}_resetActiveItem(){let t=this.autocomplete;if(t.autoActiveFirstOption){let e=-1;for(let i=0;i<t.options.length;i++)if(!t.options.get(i).disabled){e=i;break}t._keyManager.setActiveItem(e)}else t._keyManager.setActiveItem(-1)}_canOpen(){let t=this._element.nativeElement;return!t.readOnly&&!t.disabled&&!this.autocompleteDisabled}_getWindow(){return this._document?.defaultView||window}_scrollToOption(t){let e=this.autocomplete,i=mi(t,e.options,e.optionGroups);if(t===0&&i===1)e._setScrollTop(0);else if(e.panel){let n=e.options.toArray()[t];if(n){let c=n._getHostElement(),f=ui(c.offsetTop,c.offsetHeight,e._getScrollTop(),e.panel.nativeElement.offsetHeight);e._setScrollTop(f)}}}_applyModalPanelOwnership(){let t=this._element.nativeElement.closest('body > .cdk-overlay-container [aria-modal="true"]');if(!t)return;let e=this.autocomplete.id;this._trackedModal&&ne(this._trackedModal,"aria-owns",e),ve(t,"aria-owns",e),this._trackedModal=t}_clearFromModal(){if(this._trackedModal){let t=this.autocomplete.id;ne(this._trackedModal,"aria-owns",t),this._trackedModal=null}}static{this.\u0275fac=function(e){return new(e||o)(p(Z),p(at),p(Jt),p(Kt),p(ct),p(Ao),p(ae,8),p(Ii,9),p(ee,8),p(fi),p(Zi,8))}}static{this.\u0275dir=Qt({type:o,selectors:[["input","matAutocomplete",""],["textarea","matAutocomplete",""]],hostAttrs:[1,"mat-mdc-autocomplete-trigger"],hostVars:7,hostBindings:function(e,i){e&1&&u("focusin",function(){return i._handleFocus()})("blur",function(){return i._onTouched()})("input",function(c){return i._handleInput(c)})("keydown",function(c){return i._handleKeydown(c)})("click",function(){return i._handleClick()}),e&2&&$("autocomplete",i.autocompleteAttribute)("role",i.autocompleteDisabled?null:"combobox")("aria-autocomplete",i.autocompleteDisabled?null:"list")("aria-activedescendant",i.panelOpen&&i.activeOption?i.activeOption.id:null)("aria-expanded",i.autocompleteDisabled?null:i.panelOpen.toString())("aria-controls",i.autocompleteDisabled||!i.panelOpen||i.autocomplete==null?null:i.autocomplete.id)("aria-haspopup",i.autocompleteDisabled?null:"listbox")},inputs:{autocomplete:[0,"matAutocomplete","autocomplete"],position:[0,"matAutocompletePosition","position"],connectedTo:[0,"matAutocompleteConnectedTo","connectedTo"],autocompleteAttribute:[0,"autocomplete","autocompleteAttribute"],autocompleteDisabled:[2,"matAutocompleteDisabled","autocompleteDisabled",B]},exportAs:["matAutocompleteTrigger"],standalone:!0,features:[zt([Eo]),Lt,Fe]})}}return o})();var ko=(o,d)=>d.produto.id;function Ro(o,d){if(o&1&&(r(0,"mat-option",14),s(1),a()),o&2){let t=d.$implicit;m("value",t),l(),tt(" ",t.aluno.matricula," - ",t.aluno.nome," ")}}function Fo(o,d){if(o&1&&(r(0,"mat-option",14),s(1),a()),o&2){let t=d.$implicit;m("value",t),l(),S(" ",t," ")}}function Lo(o,d){if(o&1){let t=y();r(0,"div",19)(1,"mat-icon",22),s(2,"shopping_cart"),a(),r(3,"p",22),s(4,"Nenhum produto adicionado"),a(),r(5,"button",23),u("click",function(){_(t);let i=h();return g(i.openProductModal())}),s(6,"Adicionar Produto"),a()()}}function Vo(o,d){if(o&1){let t=y();r(0,"div",24)(1,"div",27)(2,"span"),s(3),a(),r(4,"span"),s(5),Q(6,"currency"),a()(),r(7,"div",28)(8,"div"),s(9),Q(10,"currency"),a(),r(11,"button",29),u("click",function(){let i=_(t).$implicit,n=h(2);return g(n.removeItem(i))}),r(12,"mat-icon"),s(13,"delete"),a()()()()}if(o&2){let t=d.$implicit;l(3),w(t.produto.nome||"Produto sem nome"),l(2),tt("",t.quantidade," x ",gt(6,4,t.preco_unitario,"BRL"),""),l(4),S(" R$ ",gt(10,7,t.quantidade*t.preco_unitario,"BRL")," ")}}function zo(o,d){if(o&1&&(r(0,"div",26)(1,"mat-icon"),s(2,"arrow_downward"),a(),s(3),a()),o&2){let t=h(2);l(3),S("Desc: ",t.desc,"%")}}function jo(o,d){if(o&1&&(r(0,"div"),A(1,Vo,14,10,"div",24,ko),r(3,"div",25)(4,"div",22),s(5),Q(6,"currency"),a(),v(7,zo,4,1,"div",26),a()()),o&2){let t=h();l(),D(t.cartItems),l(4),S("Total: ",gt(6,2,t.getTotal(),"BRL"),""),l(2),M(t.desc>0?7:-1)}}var to=(()=>{class o{formBuilder;router;snackBar;dialog;authService;httpMethods;pathUrl=G.SALE;pathUrMembers=G.MEMBERPLAN;cartItems=[];members=[];formGroup;selectedMember;desc=0;searchTerm="";formasPagamento=["Dinheiro","Cart\xE3o","Pix"];searchChange=new T;constructor(t,e,i,n,c,f){this.formBuilder=t,this.router=e,this.snackBar=i,this.dialog=n,this.authService=c,this.httpMethods=f,this.formGroup=this.formBuilder.group({client:[null],formaPagamento:["Dinheiro"]})}ngOnInit(){this.search(),this.searchChange.pipe(Yt(100)).subscribe(t=>{this.searchMember(t)})}searchMember(t=""){let e={expand:["aluno","plano"],active:!0,academia:this.authService.get_gym()};t&&(e.search=t),this.httpMethods.getPaginated(this.pathUrMembers,e).subscribe(i=>{this.members=i.results,console.log(i.results)})}search(){this.searchMember(this.searchTerm)}openProductModal(){this.dialog.open(Xi,{width:"600px",data:{academia:this.authService.get_gym(),cartItems:this.cartItems}}).afterClosed().subscribe(e=>{if(e){let i=this.cartItems.find(n=>n.produto.id===e.produto.id);i?i.quantidade+=e.quantidade:this.cartItems.push(e),this.snackBar.open("Produto adicionado ao carrinho!","Fechar",{duration:3e3})}})}removeItem(t){let e=this.cartItems.findIndex(i=>i.produto.id===t.produto.id);e!==-1?this.cartItems.splice(e,1):(console.error("Item n\xE3o encontrado:",t),this.snackBar.open("Erro ao remover item.","Fechar",{duration:3e3}))}getTotal(){let t=this.selectedMember?.plano.desconto||0;return this.cartItems.reduce((i,n)=>i+Number(n.preco_unitario)*n.quantidade,0)*(1-t/100)}finalizeSale(){if(this.cartItems.length===0){this.snackBar.open("Adicione produtos ao carrinho antes de finalizar a venda.","Fechar",{duration:3e3});return}let t={academia:this.authService.get_gym(),cliente:this.formGroup.get("client")?.value||null,forma_pagamento:this.formGroup.get("formaPagamento")?.value,itens:this.cartItems.map(e=>({produto:e.produto.id,quantidade:e.quantidade,preco_unitario:e.preco_unitario,valor_total:Number(e.preco_unitario)*e.quantidade}))};this.httpMethods.post(this.pathUrl,t).subscribe(e=>{this.snackBar.open("Venda finalizada com sucesso","Fechar",{duration:3e3}),this.cartItems=[],this.formGroup.reset({formaPagamento:"Dinheiro"}),this.router.navigate(["/sales"]).then()},e=>{console.error("Erro ao finalizar venda:",e),this.snackBar.open("Erro ao finalizar venda. Tente novamente.","Fechar",{duration:3e3})})}onSearchChange(t){this.searchTerm=t,this.searchChange.next(t)}displayMemberFn(t){return t&&t.aluno?`${t.aluno.matricula} - ${t.aluno.nome}`:""}onMemberSelected(t){let e=t.option.value;this.selectedMember=e,this.desc=e.plano.desconto,this.formGroup.get("client")?.setValue(e.id),console.log("Aluno selecionado:",e)}get clientControl(){return this.formGroup.get("client")}goBack(){this.router.navigate(["product/sales"]).then()}static \u0275fac=function(e){return new(e||o)(p(wt),p(et),p(Tt),p(Ot),p(ce),p(N))};static \u0275cmp=x({type:o,selectors:[["app-sell-page"]],standalone:!0,features:[P],decls:39,vars:8,consts:[["auto","matAutocomplete"],[1,"grid","justify-content-center","align-items-start","p-4"],[1,"col-10"],["mat-raised-button","","color","primary",1,"",3,"click"],[1,"p-4"],[1,"font-bold","text-2xl","mb-1"],[1,"grid"],[1,"col-12"],[1,"p-d-flex","p-flex-column","p-gap-3",3,"formGroup"],["appearance","outline",1,"w-full"],["matInput","","placeholder","Digite o nome ou matr\xEDcula",3,"input","formControl","matAutocomplete"],[3,"optionSelected","displayWith"],[3,"value",4,"ngFor","ngForOf"],["formControlName","formaPagamento"],[3,"value"],["appearance","outlined",1,"p-2"],[1,"flex","justify-content-between","align-items-center","mb-2"],[1,"text-2xl","font-bold"],["mat-raised-button","","color","primary",1,"add_button","bg-black-alpha-10","text-black-alpha-90",3,"click"],[1,"bg-black-alpha-10","flex","flex-column","align-items-center","justify-content-center","p-4"],[1,"mt-2"],["mat-raised-button","","color","primary",1,"add_button",3,"click","disabled"],[1,""],["mat-button","","color","primary",3,"click"],[1,"flex","justify-content-between","align-items-center","bg-black-alpha-10","p-1"],[1,"flex","justify-content-between","align-content-center"],[1,"flex","align-content-center","align-items-center",2,"color","#4dca4f"],[1,"flex","flex-wrap","align-content-start","justify-content-center"],[1,"flex","justify-content-end","align-items-center"],["mat-icon-button","","color","warn",3,"click"]],template:function(e,i){if(e&1){let n=y();r(0,"main",1)(1,"div",2)(2,"button",3),u("click",function(){return _(n),g(i.goBack())}),r(3,"mat-icon"),s(4,"arrow_back"),a(),s(5," voltar "),a()(),r(6,"div",2)(7,"mat-card",4)(8,"div",5),s(9,"Registrar Venda"),a(),r(10,"div",6)(11,"div",7)(12,"form",8)(13,"mat-form-field",9)(14,"mat-label"),s(15,"Cliente"),a(),r(16,"input",10),u("input",function(){return _(n),g(i.onSearchChange(i.clientControl.value||""))}),a(),r(17,"mat-autocomplete",11,0),u("optionSelected",function(f){return _(n),g(i.onMemberSelected(f))}),v(19,Ro,2,3,"mat-option",12),a()(),r(20,"mat-form-field",9)(21,"mat-label"),s(22,"Forma de Pagamento"),a(),r(23,"mat-select",13),A(24,Fo,2,2,"mat-option",14,pt),a()()()()(),r(26,"mat-card",15)(27,"div",16)(28,"div",17),s(29,"Produtos"),a(),r(30,"button",18),u("click",function(){return _(n),g(i.openProductModal())}),r(31,"mat-icon"),s(32,"add"),a(),s(33," Adicionar Produto "),a()(),v(34,Lo,7,0,"div",19)(35,jo,8,5,"div"),a(),r(36,"div",20)(37,"button",21),u("click",function(){return _(n),g(i.finalizeSale())}),s(38," Finalizar Venda "),a()()()()()}if(e&2){let n=J(18);l(12),m("formGroup",i.formGroup),l(4),m("formControl",i.clientControl)("matAutocomplete",n),l(),m("displayWith",i.displayMemberFn),l(2),m("ngForOf",i.members),l(5),D(i.formasPagamento),l(10),M(i.cartItems.length===0?34:-1),l(),M(i.cartItems.length>0?35:-1),l(2),m("disabled",i.formGroup.invalid||i.cartItems.length===0)}},dependencies:[re,ot,It,xt,L,V,Ct,Ci,Pt,Mt,k,Et,it,F,vt,j,z,rt,nt,Se,Ji,Ye]})}return o})();function No(o,d){if(o&1&&(r(0,"div",6),b(1,"mat-icon",9),s(2),a()),o&2){let t=h();l(2),S(" ",t.prod.categoria||"Produto"," ")}}var eo=(()=>{class o{prod;static \u0275fac=function(e){return new(e||o)};static \u0275cmp=x({type:o,selectors:[["app-product-item"]],inputs:{prod:"prod"},standalone:!0,features:[P],decls:19,vars:8,consts:[[1,"h-15rem","w-25rem","w-full","aspect-square","flex","items-center","justify-center","overflow-hidden"],["alt","Imagem do produto",1,"w-full","h-full","object-contain","p-2",3,"src"],[1,"p-4"],[1,"flex","justify-content-between"],[1,"font-semibold","text-2xl"],[1,"text-2xl","font-bold","whitespace-nowrap"],[1,"flex","items-center","text-1xl","gap-1","font-gray"],[1,"text-xl","font-gray"],["appearance","outlined",1,"text-xl","font-gray","p-1"],["fontIcon","local_offer",1,"text-1xl","text-gray-400"]],template:function(e,i){e&1&&(r(0,"main")(1,"div",0),b(2,"img",1),a(),r(3,"mat-card-content",2)(4,"div",3)(5,"div",4),s(6),a(),r(7,"div",5),s(8),a()(),v(9,No,3,1,"div",6),r(10,"div",7)(11,"strong"),s(12,"Marca:"),a(),s(13),a(),r(14,"p",7),s(15),a(),r(16,"div")(17,"mat-card",8),s(18),a()()()()),e&2&&(l(2),m("src",i.prod.foto_url,Zt),l(4),w(i.prod.nome),l(2),S("R$ ",i.prod.preco,""),l(),M(i.prod.categoria?9:-1),l(4),S(" ",i.prod.marca||"Desconhecida"," "),l(2),w(i.prod.descricao),l(3),tt(" Em estoque: ",i.prod.quantidade_estoque," unidade",i.prod.quantidade_estoque===1?"":"s"," "))},dependencies:[Ei,ot,rt]})}return o})();var io=(()=>{class o{fb;httpMethods;dialogRef;data;formGroup;constructor(t,e,i,n){this.fb=t,this.httpMethods=e,this.dialogRef=i,this.data=n,this.formGroup=this.fb.group({produto:[this.data.produtoId,U.required],quantidade:[null,U.required],preco_total:[null,U.required],data_validade:[""]})}submit(){if(this.formGroup.valid){let t=this.formGroup.get("data_validade")?.value,e=new Date(t).toISOString().split("T")[0];this.formGroup.patchValue({data_validade:e}),this.httpMethods.post("api/produto/lotes/",this.formGroup.value).subscribe({next:()=>this.dialogRef.close(!0),error:i=>console.error("Erro ao abastecer produto:",i)})}}static \u0275fac=function(e){return new(e||o)(p(wt),p(N),p(de),p(pe))};static \u0275cmp=x({type:o,selectors:[["app-product-stock-modal"]],standalone:!0,features:[zt([Di(),li(),{provide:ri,useValue:Vi},{provide:ai,useValue:"pt-BR"}]),P],decls:27,vars:3,consts:[["picker",""],[1,"flex","flex-column","align-items-center","justify-content-center","p-1"],[1,"text-2xl","font-bold","mb-4"],[1,"col-12","p-3",3,"formGroup"],[1,"field","w-full"],["appearance","fill",1,"w-full"],["matInput","","type","number","formControlName","quantidade"],["matInput","","type","number","formControlName","preco_total"],["matInput","","formControlName","data_validade",3,"matDatepicker"],["matSuffix","",3,"for"],[1,"flex","justify-content-end","gap-2","mt-2"],["mat-raised-button","","type","button",1,"add_button","bg-red-alpha-70","text-yellow-100",3,"click"],["mat-raised-button","","color","primary",1,"add_button","bg-black-alpha-70","text-white-alpha-90",3,"click"]],template:function(e,i){if(e&1){let n=y();r(0,"main",1)(1,"h2",2),s(2,"Abastecer Produto"),a(),r(3,"form",3)(4,"div",4)(5,"mat-form-field",5)(6,"mat-label"),s(7,"Quantidade"),a(),b(8,"input",6),a()(),r(9,"div",4)(10,"mat-form-field",5)(11,"mat-label"),s(12,"Preco"),a(),b(13,"input",7),a()(),r(14,"div",4)(15,"mat-form-field",5)(16,"mat-label"),s(17,"Data de validade"),a(),b(18,"input",8)(19,"mat-datepicker-toggle",9)(20,"mat-datepicker",null,0),a()(),r(22,"div",10)(23,"button",11),u("click",function(){return _(n),g(i.dialogRef.close())}),s(24,"Cancelar"),a(),r(25,"button",12),u("click",function(){return _(n),g(i.submit())}),s(26,"Salvar"),a()()()()}if(e&2){let n=J(21);l(3),m("formGroup",i.formGroup),l(15),m("matDatepicker",n),l(),m("for",n)}},dependencies:[bt,It,xt,L,le,V,Ct,Pt,Mt,Ai,Ti,k,z,wi,Oi,j,be,F,Li,ki,Ri,Fi,si],styles:["[_nghost-%COMP%]{overflow-x:hidden}main[_ngcontent-%COMP%]{overflow-x:hidden}form[_ngcontent-%COMP%]{width:100%;box-sizing:border-box;overflow-x:hidden}"]})}return o})();var Bo=(o,d)=>d.id;function Go(o,d){return this.products}function qo(o,d){if(o&1){let t=y();r(0,"mat-card",15),b(1,"app-product-item",16),r(2,"div",17)(3,"button",18),u("click",function(){let i=_(t).$implicit,n=h(4);return g(n.restock(i))}),r(4,"mat-icon"),s(5,"add_circle"),a(),s(6," Abastecer "),a(),r(7,"button",18),u("click",function(){let i=_(t).$implicit,n=h(4);return g(n.edit(i))}),r(8,"mat-icon"),s(9,"edit"),a(),s(10," Editar "),a()()()}if(o&2){let t=d.$implicit;l(),m("prod",t)}}function Uo(o,d){if(o&1){let t=y();r(0,"section",12)(1,"h4"),s(2),a(),r(3,"div",13)(4,"div",14),u("scroll",function(){_(t);let i=h().$implicit,n=h(2);return g(n.onScroll(i))}),A(5,qo,11,1,"mat-card",15,Bo),a()()()}if(o&2){let t=h().$implicit,e=h(2);l(2),w(t),l(),Ge("id","category-",t,""),l(2),D(e.categoryPanation[t].products)}}function Ho(o,d){if(o&1&&v(0,Uo,7,3,"section",12),o&2){let t=d.$implicit,e=h(2);M(e.categoryPanation[t].products.length>0?0:-1)}}function $o(o,d){if(o&1&&(r(0,"section",11),A(1,Ho,1,1,null,null,pt),a()),o&2){let t=h();l(),D(t.categories)}}function Yo(o,d){if(o&1){let t=y();r(0,"mat-card",15),b(1,"app-product-item",16),r(2,"div",17)(3,"button",18),u("click",function(){let i=_(t).$implicit,n=h(2);return g(n.restock(i))}),r(4,"mat-icon"),s(5,"add_circle"),a(),s(6," Abastecer "),a(),r(7,"button",18),u("click",function(){let i=_(t).$implicit,n=h(2);return g(n.edit(i))}),r(8,"mat-icon"),s(9,"edit"),a(),s(10," Editar "),a()()()}if(o&2){let t=d.$implicit;l(),m("prod",t)}}function Wo(o,d){if(o&1){let t=y();r(0,"section",12)(1,"div",14),u("scroll",function(){_(t);let i=h();return g(i.onScroll())}),A(2,Yo,11,1,"mat-card",15,Go,!0),a()()}if(o&2){let t=h();l(2),D(t.products)}}var oo=(()=>{class o{httpMethods;router;dialog;pathUrlProduct=G.PRODUCT;products=[];gym_id="";searchTerm="";limit=4;loading=!1;totalResults=0;currentPage=0;categories=["SUPLEMENTO","ACESSORIO","ROUPA","BEBIDA","ALIMENTO","OUTROS"];categoryPanation={};unsubscribe$=new T;searchChange=new T;constructor(t,e,i){this.httpMethods=t,this.router=e,this.dialog=i}getIdGym(){this.gym_id=localStorage.getItem("academia")}ngOnInit(){this.getIdGym(),this.searchChange.pipe(Yt(300),E(this.unsubscribe$)).subscribe(()=>{this.doSearch()});for(let t of this.categories)this.categoryPanation[t]={products:[],limit:this.limit,offset:0,totalResults:0,loading:!1},this.getInventory(t)}ngOnDestroy(){this.unsubscribe$.next(),this.unsubscribe$.complete()}restock(t){this.dialog.open(io,{data:{produtoId:t.id},width:"100%",maxWidth:"500px",autoFocus:!1}).afterClosed().pipe(E(this.unsubscribe$)).subscribe(i=>{if(i){let n=this.categories.find(c=>this.categoryPanation[c]?.products.some(f=>f.id===t.id));n&&(this.categoryPanation[n].products=[],this.categoryPanation[n].offset=0,this.categoryPanation[n].totalResults=0,this.getInventory(n))}})}onScroll(t=""){let e=document.getElementById(`category-${t}`);if(!e)return;let i=e.scrollLeft,n=e.clientWidth,c=e.scrollWidth,f=i+n>=c-5,C=this.categoryPanation[t];!C||C.loading||f&&C.products.length<C.totalResults&&this.loadMoreProducts(t)}loadMoreProducts(t){let e=this.categoryPanation[t];if(e.offset>=e.totalResults)return;e.loading=!0;let i={expand:["lotes"],academia:this.gym_id,categoria:t,limit:e.limit,offset:e.offset};this.httpMethods.getPaginated(this.pathUrlProduct,i).pipe(E(this.unsubscribe$)).subscribe(n=>{n.results&&n.results.length>0&&(e.products.push(...n.results),e.offset+=e.limit,e.totalResults=n.count),e.loading=!1},n=>{e.loading=!1,console.error("Erro ao carregar mais produtos:",n)})}getInventory(t){let e=this.categoryPanation[t];if(e.loading)return;e.loading=!0;let i={expand:["lotes"],academia:this.gym_id,categoria:t,limit:e.limit,offset:e.offset};this.httpMethods.getPaginated(this.pathUrlProduct,i).pipe(E(this.unsubscribe$)).subscribe(n=>{let c=n.results,f=n.count;e.products.push(...c),e.offset+=e.limit,e.totalResults=f,e.loading=!1},n=>{e.loading=!1})}edit(t){this.router.navigate([`/product/form/${t.id}`]).then()}create(){this.router.navigate(["/product/form/create/"])}onSearchInput(t){this.searchTerm=t,this.searchChange.next(t)}doSearch(){this.loading=!0;let t={expand:["lotes"],academia:this.gym_id,limit:this.limit,offset:this.currentPage,search:this.searchTerm};this.httpMethods.getPaginated(this.pathUrlProduct,t).pipe(E(this.unsubscribe$)).subscribe({next:e=>{this.products=e.results,this.totalResults=e.count,this.loading=!1},error:e=>{console.error("Erro na busca:",e),this.loading=!1,this.products=[]}})}static \u0275fac=function(e){return new(e||o)(p(N),p(et),p(Ot))};static \u0275cmp=x({type:o,selectors:[["app-product-inventory"]],standalone:!0,features:[P],decls:21,vars:2,consts:[["inputElement",""],[1,"grid"],[1,"col-12","justify-content-center","align-items-center","align-content-center"],[1,"flex","font-gray","w-full","justify-content-center"],[1,"col-12","p-4"],[1,"flex","justify-content-between","align-items-center","col-12","align-content-center","align-items-center"],["appearance","outline",1,"search","w-30rem"],["matInput","","type","text","placeholder","Digite o nome do produto",3,"ngModelChange","input","ngModel"],[1,"flex","align-items-center","justify-content-end","mb-5"],[1,"align-self-start","mr-2"],["mat-raised-button","","color","primary",1,"add_button","bg-black-alpha-70","mt-2",2,"color","white",3,"click"],[1,"flex-wrap","col-12"],[1,"flex","flex-column"],[1,"flex","flex-col","gap-4","mb-6",3,"id"],[1,"flex","overflow-x-auto","gap-4","styled-scroll","p-2",3,"scroll"],[1,"min-w-[16rem]","flex-shrink-0","overflow-hidden","border","bg-white","flex","flex-col","p-3"],[3,"prod"],[1,"grid","justify-content-between"],["mat-raised-button","","type","button",1,"add_button",3,"click"]],template:function(e,i){if(e&1){let n=y();r(0,"div",1)(1,"div",2)(2,"h2"),s(3,"Estoque"),a(),r(4,"span",3),s(5," Gerencie e abaste\xE7a os produtos oferecidos pelo estabelecimento "),a()(),r(6,"div",4)(7,"div",5)(8,"mat-form-field",6)(9,"mat-label"),s(10,"Buscar Produto"),a(),r(11,"input",7,0),_t("ngModelChange",function(f){return _(n),ft(i.searchTerm,f)||(i.searchTerm=f),g(f)}),u("input",function(){_(n);let f=J(12);return g(i.onSearchInput(f.value))}),a()(),r(13,"div",8)(14,"div",9)(15,"button",10),u("click",function(){return _(n),g(i.create())}),r(16,"mat-icon"),s(17,"add"),a(),s(18," Adicionar produto "),a()()()(),v(19,$o,3,0,"section",11)(20,Wo,4,0,"section",12),a()()}e&2&&(l(11),ht("ngModel",i.searchTerm),l(8),M(i.searchTerm==""?19:20))},dependencies:[nt,L,V,St,F,rt,ot,eo,k,j,z],styles:[".subtitle[_ngcontent-%COMP%]{text-align:center;color:#909090}"]})}return o})();var Qo=(o,d)=>d.value;function Xo(o,d){o&1&&(r(0,"mat-error"),s(1,"Campo obrigat\xF3rio"),a())}function Ko(o,d){o&1&&(r(0,"mat-error"),s(1,"Campo obrigat\xF3rio"),a())}function Zo(o,d){o&1&&(r(0,"mat-error"),s(1,"Campo obrigat\xF3rio"),a())}function Jo(o,d){if(o&1&&(r(0,"mat-option",9),s(1),a()),o&2){let t=d.$implicit;m("value",t.value),l(),w(t.label)}}function tn(o,d){o&1&&(r(0,"mat-error"),s(1," Campo obrigat\xF3rio "),a())}function en(o,d){o&1&&(r(0,"mat-error"),s(1,"Campo obrigat\xF3rio"),a())}function on(o,d){if(o&1&&(r(0,"div",15)(1,"p"),s(2,"Imagem atual:"),a(),b(3,"img",16),a()),o&2){let t=h();l(3),m("src",t.imagePreviewUrl,Zt)}}var no=(()=>{class o{httpMethods;formBuilder;router;route;snackBar;dialog;categorias=[{value:"SUPLEMENTO",label:"Suplemento"},{value:"Acessorio",label:"Acess\xF3rio"},{value:"ROUPA",label:"Roupa"},{value:"BEBIDA",label:"Bebida"},{value:"ALIMENTO",label:"Alimento"},{value:"OUTROS",label:"Outros"}];action="";created=!0;pathUrlProd=G.PRODUCT;formGroup;gymId="";title="Cadastro de produto";selectedImage=null;imagePreviewUrl=null;constructor(t,e,i,n,c,f){this.httpMethods=t,this.formBuilder=e,this.router=i,this.route=n,this.snackBar=c,this.dialog=f,this.formGroup=this.formBuilder.group({id:[],nome:["",U.required],preco:["",U.required],descricao:["",U.required],academia:[""],categoria:["",U.required],created_at:[""],modified_at:[""],marca:["",U.required]})}ngOnInit(){this.getGym(),this.retriveCallBack()}getGym(){this.gymId=localStorage.getItem("academia"),this.gymId&&this.formGroup.patchValue({academia:this.gymId})}onFileSelected(t){let e=t.target.files[0];e&&e.type.startsWith("image/")&&this.resizeImage(e,500,500).then(i=>{this.selectedImage=i})}resizeImage(t,e,i){return new Promise((n,c)=>{let f=new FileReader;f.onload=C=>{let R=new Image;R.src=C.target.result,R.onload=()=>{let q=document.createElement("canvas"),dt=q.getContext("2d"),I=R.width,O=R.height,qt=Math.min(e/I,i/O);q.width=I*qt,q.height=O*qt,dt?.drawImage(R,0,0,q.width,q.height),q.toBlob(Pe=>{if(Pe){let mo=new File([Pe],t.name,{type:t.type,lastModified:Date.now()});n(mo)}else c("Erro ao redimensionar imagem.")},t.type)}},f.onerror=C=>c(C),f.readAsDataURL(t)})}retriveCallBack(){this.route.paramMap.subscribe(t=>{this.action=t.get("action"),this.created=!(this.action&&this.action!=="create"),this.created||(this.title="Edi\xE7\xE3o de produto",this.httpMethods.get(this.pathUrlProd+this.action+"/").subscribe(e=>{this.imagePreviewUrl=e.foto,console.log(e),this.formGroup.patchValue({id:e.id,nome:e.nome,preco:e.preco,descricao:e.descricao,categoria:e.categoria,created_at:e.created_at,modified_at:e.modified_at,marca:e.marca,academia:this.gymId})}))})}saveOrUpdate(t){let e=new FormData;Object.keys(t).forEach(n=>{t[n]!==null&&t[n]!==void 0&&e.append(n,t[n])}),this.selectedImage&&e.append("foto",this.selectedImage),(this.created?this.httpMethods.post(`${this.pathUrlProd}`,e):this.httpMethods.noIdPatch(`${this.pathUrlProd}${t.id}/`,e)).subscribe(()=>{let n=this.created?"Produto cadastrado":"Produto atualizado";this.snackBar.open(n,"OK",{duration:3e3,verticalPosition:"top"}),this.router.navigate(["/product/productInventory"])})}static \u0275fac=function(e){return new(e||o)(p(N),p(wt),p(et),p(Xe),p(Tt),p(Ot))};static \u0275cmp=x({type:o,selectors:[["app-product-form"]],standalone:!0,features:[P],decls:36,vars:9,consts:[[1,"container"],[1,"mat-elevation-z2","form",3,"ngSubmit","formGroup"],[1,"form-title"],["appearance","fill"],["matInput","","formControlName","nome","placeholder","Digite o nome do produto"],[4,"ngIf"],["matInput","","formControlName","preco","type","number","placeholder","Digite o pre\xE7o"],["matInput","","formControlName","marca","placeholder","Marca do produto"],["formControlName","categoria"],[3,"value"],["matInput","","formControlName","descricao","placeholder","Descri\xE7\xE3o do produto"],[1,"form-group"],["type","file",3,"change"],["class","image-preview",4,"ngIf"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],[1,"image-preview"],["width","200","alt","Preview do produto",3,"src"]],template:function(e,i){if(e&1&&(r(0,"div",0)(1,"form",1),u("ngSubmit",function(){return i.saveOrUpdate(i.formGroup.value)}),r(2,"h2",2),s(3),a(),r(4,"mat-form-field",3)(5,"mat-label"),s(6,"Nome"),a(),b(7,"input",4),v(8,Xo,2,0,"mat-error",5),a(),r(9,"mat-form-field",3)(10,"mat-label"),s(11,"Pre\xE7o"),a(),b(12,"input",6),v(13,Ko,2,0,"mat-error",5),a(),r(14,"mat-form-field",3)(15,"mat-label"),s(16,"Marca"),a(),b(17,"input",7),v(18,Zo,2,0,"mat-error",5),a(),r(19,"mat-form-field",3)(20,"mat-label"),s(21,"Categoria"),a(),r(22,"mat-select",8),A(23,Jo,2,2,"mat-option",9,Qo),a(),v(25,tn,2,0,"mat-error",5),a(),r(26,"mat-form-field",3)(27,"mat-label"),s(28,"Descri\xE7\xE3o"),a(),b(29,"textarea",10),v(30,en,2,0,"mat-error",5),a(),r(31,"div",11)(32,"input",12),u("change",function(c){return i.onFileSelected(c)}),a()(),v(33,on,4,1,"div",13),r(34,"button",14),s(35,"Salvar"),a()()()),e&2){let n,c,f,C,R;l(),m("formGroup",i.formGroup),l(2),w(i.title),l(5),m("ngIf",(n=i.formGroup.get("nome"))==null?null:n.hasError("required")),l(5),m("ngIf",(c=i.formGroup.get("preco"))==null?null:c.hasError("required")),l(5),m("ngIf",(f=i.formGroup.get("marca"))==null?null:f.hasError("required")),l(5),D(i.categorias),l(2),m("ngIf",(C=i.formGroup.get("categoria"))==null?null:C.hasError("required")),l(5),m("ngIf",(R=i.formGroup.get("descricao"))==null?null:R.hasError("required")),l(3),m("ngIf",i.imagePreviewUrl),l(),m("disabled",!i.formGroup.valid)}},dependencies:[It,xt,L,le,V,Ct,Pt,Mt,F,Mi,k,j,z,We,Et,it],styles:[".container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh;background-color:#f4f7fc}.form[_ngcontent-%COMP%]{width:100%;max-width:500px;padding:40px;background-color:#fff;border-radius:12px;box-shadow:0 4px 12px #0000001a;font-family:Arial,sans-serif}.form-title[_ngcontent-%COMP%]{text-align:center;font-size:24px;color:#333;margin-bottom:30px}mat-form-field[_ngcontent-%COMP%]{width:100%;margin-bottom:20px}mat-label[_ngcontent-%COMP%]{font-weight:600;color:#333}input[_ngcontent-%COMP%]{font-size:16px;padding:10px;border-radius:4px;border:1px solid #ddd}button[_ngcontent-%COMP%]{width:100%;padding:14px;font-size:16px;border:none;border-radius:4px;cursor:pointer}.input-field[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{font-size:16px}button[disabled][_ngcontent-%COMP%]{background-color:#b0bec5;cursor:not-allowed}@media (max-width: 600px){.form[_ngcontent-%COMP%]{padding:20px}.form-title[_ngcontent-%COMP%]{font-size:20px}button[_ngcontent-%COMP%]{font-size:14px;padding:12px}}"]})}return o})();var nn=["tooltip"],an=20;var rn=new X("mat-tooltip-scroll-strategy",{providedIn:"root",factory:()=>{let o=st(at);return()=>o.scrollStrategies.reposition({scrollThrottle:an})}});function sn(){return{showDelay:0,hideDelay:0,touchendHideDelay:1500}}var ln=new X("mat-tooltip-default-options",{providedIn:"root",factory:sn});var ao="tooltip-panel",ro=Ze({passive:!0}),cn=8,dn=8,pn=24,mn=200,so=(()=>{class o{get position(){return this._position}set position(t){t!==this._position&&(this._position=t,this._overlayRef&&(this._updatePosition(this._overlayRef),this._tooltipInstance?.show(0),this._overlayRef.updatePosition()))}get positionAtOrigin(){return this._positionAtOrigin}set positionAtOrigin(t){this._positionAtOrigin=_e(t),this._detach(),this._overlayRef=null}get disabled(){return this._disabled}set disabled(t){let e=_e(t);this._disabled!==e&&(this._disabled=e,e?this.hide(0):this._setupPointerEnterEventsIfNeeded(),this._syncAriaDescription(this.message))}get showDelay(){return this._showDelay}set showDelay(t){this._showDelay=ge(t)}get hideDelay(){return this._hideDelay}set hideDelay(t){this._hideDelay=ge(t),this._tooltipInstance&&(this._tooltipInstance._mouseLeaveHideDelay=this._hideDelay)}get message(){return this._message}set message(t){let e=this._message;this._message=t!=null?String(t).trim():"",!this._message&&this._isTooltipVisible()?this.hide(0):(this._setupPointerEnterEventsIfNeeded(),this._updateTooltipMessage()),this._syncAriaDescription(e)}get tooltipClass(){return this._tooltipClass}set tooltipClass(t){this._tooltipClass=t,this._tooltipInstance&&this._setTooltipClass(this._tooltipClass)}constructor(t,e,i,n,c,f,C,R,q,dt,I,O){this._overlay=t,this._elementRef=e,this._scrollDispatcher=i,this._viewContainerRef=n,this._ngZone=c,this._platform=f,this._ariaDescriber=C,this._focusMonitor=R,this._dir=dt,this._defaultOptions=I,this._position="below",this._positionAtOrigin=!1,this._disabled=!1,this._viewInitialized=!1,this._pointerExitEventsInitialized=!1,this._tooltipComponent=un,this._viewportMargin=8,this._cssClassPrefix="mat-mdc",this.touchGestures="auto",this._message="",this._passiveListeners=[],this._touchstartTimeout=null,this._destroyed=new T,this._injector=st(Xt),this._scrollStrategy=q,this._document=O,I&&(this._showDelay=I.showDelay,this._hideDelay=I.hideDelay,I.position&&(this.position=I.position),I.positionAtOrigin&&(this.positionAtOrigin=I.positionAtOrigin),I.touchGestures&&(this.touchGestures=I.touchGestures),I.tooltipClass&&(this.tooltipClass=I.tooltipClass)),dt.change.pipe(E(this._destroyed)).subscribe(()=>{this._overlayRef&&this._updatePosition(this._overlayRef)}),this._viewportMargin=cn}ngAfterViewInit(){this._viewInitialized=!0,this._setupPointerEnterEventsIfNeeded(),this._focusMonitor.monitor(this._elementRef).pipe(E(this._destroyed)).subscribe(t=>{t?t==="keyboard"&&this._ngZone.run(()=>this.show()):this._ngZone.run(()=>this.hide(0))})}ngOnDestroy(){let t=this._elementRef.nativeElement;this._touchstartTimeout&&clearTimeout(this._touchstartTimeout),this._overlayRef&&(this._overlayRef.dispose(),this._tooltipInstance=null),this._passiveListeners.forEach(([e,i])=>{t.removeEventListener(e,i,ro)}),this._passiveListeners.length=0,this._destroyed.next(),this._destroyed.complete(),this._ariaDescriber.removeDescription(t,this.message,"tooltip"),this._focusMonitor.stopMonitoring(t)}show(t=this.showDelay,e){if(this.disabled||!this.message||this._isTooltipVisible()){this._tooltipInstance?._cancelPendingAnimations();return}let i=this._createOverlay(e);this._detach(),this._portal=this._portal||new Si(this._tooltipComponent,this._viewContainerRef);let n=this._tooltipInstance=i.attach(this._portal).instance;n._triggerElement=this._elementRef.nativeElement,n._mouseLeaveHideDelay=this._hideDelay,n.afterHidden().pipe(E(this._destroyed)).subscribe(()=>this._detach()),this._setTooltipClass(this._tooltipClass),this._updateTooltipMessage(),n.show(t)}hide(t=this.hideDelay){let e=this._tooltipInstance;e&&(e.isVisible()?e.hide(t):(e._cancelPendingAnimations(),this._detach()))}toggle(t){this._isTooltipVisible()?this.hide():this.show(void 0,t)}_isTooltipVisible(){return!!this._tooltipInstance&&this._tooltipInstance.isVisible()}_createOverlay(t){if(this._overlayRef){let n=this._overlayRef.getConfig().positionStrategy;if((!this.positionAtOrigin||!t)&&n._origin instanceof Z)return this._overlayRef;this._detach()}let e=this._scrollDispatcher.getAncestorScrollContainers(this._elementRef),i=this._overlay.position().flexibleConnectedTo(this.positionAtOrigin?t||this._elementRef:this._elementRef).withTransformOriginOn(`.${this._cssClassPrefix}-tooltip`).withFlexibleDimensions(!1).withViewportMargin(this._viewportMargin).withScrollableContainers(e);return i.positionChanges.pipe(E(this._destroyed)).subscribe(n=>{this._updateCurrentPositionClass(n.connectionPair),this._tooltipInstance&&n.scrollableViewProperties.isOverlayClipped&&this._tooltipInstance.isVisible()&&this._ngZone.run(()=>this.hide(0))}),this._overlayRef=this._overlay.create({direction:this._dir,positionStrategy:i,panelClass:`${this._cssClassPrefix}-${ao}`,scrollStrategy:this._scrollStrategy()}),this._updatePosition(this._overlayRef),this._overlayRef.detachments().pipe(E(this._destroyed)).subscribe(()=>this._detach()),this._overlayRef.outsidePointerEvents().pipe(E(this._destroyed)).subscribe(()=>this._tooltipInstance?._handleBodyInteraction()),this._overlayRef.keydownEvents().pipe(E(this._destroyed)).subscribe(n=>{this._isTooltipVisible()&&n.keyCode===27&&!yt(n)&&(n.preventDefault(),n.stopPropagation(),this._ngZone.run(()=>this.hide(0)))}),this._defaultOptions?.disableTooltipInteractivity&&this._overlayRef.addPanelClass(`${this._cssClassPrefix}-tooltip-panel-non-interactive`),this._overlayRef}_detach(){this._overlayRef&&this._overlayRef.hasAttached()&&this._overlayRef.detach(),this._tooltipInstance=null}_updatePosition(t){let e=t.getConfig().positionStrategy,i=this._getOrigin(),n=this._getOverlayPosition();e.withPositions([this._addOffset(At(At({},i.main),n.main)),this._addOffset(At(At({},i.fallback),n.fallback))])}_addOffset(t){let e=dn,i=!this._dir||this._dir.value=="ltr";return t.originY==="top"?t.offsetY=-e:t.originY==="bottom"?t.offsetY=e:t.originX==="start"?t.offsetX=i?-e:e:t.originX==="end"&&(t.offsetX=i?e:-e),t}_getOrigin(){let t=!this._dir||this._dir.value=="ltr",e=this.position,i;e=="above"||e=="below"?i={originX:"center",originY:e=="above"?"top":"bottom"}:e=="before"||e=="left"&&t||e=="right"&&!t?i={originX:"start",originY:"center"}:(e=="after"||e=="right"&&t||e=="left"&&!t)&&(i={originX:"end",originY:"center"});let{x:n,y:c}=this._invertPosition(i.originX,i.originY);return{main:i,fallback:{originX:n,originY:c}}}_getOverlayPosition(){let t=!this._dir||this._dir.value=="ltr",e=this.position,i;e=="above"?i={overlayX:"center",overlayY:"bottom"}:e=="below"?i={overlayX:"center",overlayY:"top"}:e=="before"||e=="left"&&t||e=="right"&&!t?i={overlayX:"end",overlayY:"center"}:(e=="after"||e=="right"&&t||e=="left"&&!t)&&(i={overlayX:"start",overlayY:"center"});let{x:n,y:c}=this._invertPosition(i.overlayX,i.overlayY);return{main:i,fallback:{overlayX:n,overlayY:c}}}_updateTooltipMessage(){this._tooltipInstance&&(this._tooltipInstance.message=this.message,this._tooltipInstance._markForCheck(),te(()=>{this._tooltipInstance&&this._overlayRef.updatePosition()},{injector:this._injector}))}_setTooltipClass(t){this._tooltipInstance&&(this._tooltipInstance.tooltipClass=t,this._tooltipInstance._markForCheck())}_invertPosition(t,e){return this.position==="above"||this.position==="below"?e==="top"?e="bottom":e==="bottom"&&(e="top"):t==="end"?t="start":t==="start"&&(t="end"),{x:t,y:e}}_updateCurrentPositionClass(t){let{overlayY:e,originX:i,originY:n}=t,c;if(e==="center"?this._dir&&this._dir.value==="rtl"?c=i==="end"?"left":"right":c=i==="start"?"left":"right":c=e==="bottom"&&n==="top"?"above":"below",c!==this._currentPosition){let f=this._overlayRef;if(f){let C=`${this._cssClassPrefix}-${ao}-`;f.removePanelClass(C+this._currentPosition),f.addPanelClass(C+c)}this._currentPosition=c}}_setupPointerEnterEventsIfNeeded(){this._disabled||!this.message||!this._viewInitialized||this._passiveListeners.length||(this._platformSupportsMouseEvents()?this._passiveListeners.push(["mouseenter",t=>{this._setupPointerExitEventsIfNeeded();let e;t.x!==void 0&&t.y!==void 0&&(e=t),this.show(void 0,e)}]):this.touchGestures!=="off"&&(this._disableNativeGesturesIfNecessary(),this._passiveListeners.push(["touchstart",t=>{let e=t.targetTouches?.[0],i=e?{x:e.clientX,y:e.clientY}:void 0;this._setupPointerExitEventsIfNeeded(),this._touchstartTimeout&&clearTimeout(this._touchstartTimeout);let n=500;this._touchstartTimeout=setTimeout(()=>{this._touchstartTimeout=null,this.show(void 0,i)},this._defaultOptions.touchLongPressShowDelay??n)}])),this._addListeners(this._passiveListeners))}_setupPointerExitEventsIfNeeded(){if(this._pointerExitEventsInitialized)return;this._pointerExitEventsInitialized=!0;let t=[];if(this._platformSupportsMouseEvents())t.push(["mouseleave",e=>{let i=e.relatedTarget;(!i||!this._overlayRef?.overlayElement.contains(i))&&this.hide()}],["wheel",e=>this._wheelListener(e)]);else if(this.touchGestures!=="off"){this._disableNativeGesturesIfNecessary();let e=()=>{this._touchstartTimeout&&clearTimeout(this._touchstartTimeout),this.hide(this._defaultOptions.touchendHideDelay)};t.push(["touchend",e],["touchcancel",e])}this._addListeners(t),this._passiveListeners.push(...t)}_addListeners(t){t.forEach(([e,i])=>{this._elementRef.nativeElement.addEventListener(e,i,ro)})}_platformSupportsMouseEvents(){return!this._platform.IOS&&!this._platform.ANDROID}_wheelListener(t){if(this._isTooltipVisible()){let e=this._document.elementFromPoint(t.clientX,t.clientY),i=this._elementRef.nativeElement;e!==i&&!i.contains(e)&&this.hide()}}_disableNativeGesturesIfNecessary(){let t=this.touchGestures;if(t!=="off"){let e=this._elementRef.nativeElement,i=e.style;(t==="on"||e.nodeName!=="INPUT"&&e.nodeName!=="TEXTAREA")&&(i.userSelect=i.msUserSelect=i.webkitUserSelect=i.MozUserSelect="none"),(t==="on"||!e.draggable)&&(i.webkitUserDrag="none"),i.touchAction="none",i.webkitTapHighlightColor="transparent"}}_syncAriaDescription(t){this._ariaDescriptionPending||(this._ariaDescriptionPending=!0,this._ariaDescriber.removeDescription(this._elementRef.nativeElement,t,"tooltip"),this._ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>{this._ariaDescriptionPending=!1,this.message&&!this.disabled&&this._ariaDescriber.describe(this._elementRef.nativeElement,this.message,"tooltip")})}))}static{this.\u0275fac=function(e){return new(e||o)(p(at),p(Z),p(hi),p(Jt),p(Kt),p(oe),p(ii),p(ni),p(rn),p(ae),p(ln,8),p(ee))}}static{this.\u0275dir=Qt({type:o,selectors:[["","matTooltip",""]],hostAttrs:[1,"mat-mdc-tooltip-trigger"],hostVars:2,hostBindings:function(e,i){e&2&&Vt("mat-mdc-tooltip-disabled",i.disabled)},inputs:{position:[0,"matTooltipPosition","position"],positionAtOrigin:[0,"matTooltipPositionAtOrigin","positionAtOrigin"],disabled:[0,"matTooltipDisabled","disabled"],showDelay:[0,"matTooltipShowDelay","showDelay"],hideDelay:[0,"matTooltipHideDelay","hideDelay"],touchGestures:[0,"matTooltipTouchGestures","touchGestures"],message:[0,"matTooltip","message"],tooltipClass:[0,"matTooltipClass","tooltipClass"]},exportAs:["matTooltip"],standalone:!0})}}return o})(),un=(()=>{class o{constructor(t,e,i){this._changeDetectorRef=t,this._elementRef=e,this._isMultiline=!1,this._closeOnInteraction=!1,this._isVisible=!1,this._onHide=new T,this._showAnimation="mat-mdc-tooltip-show",this._hideAnimation="mat-mdc-tooltip-hide",this._animationsDisabled=i==="NoopAnimations"}show(t){this._hideTimeoutId!=null&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=setTimeout(()=>{this._toggleVisibility(!0),this._showTimeoutId=void 0},t)}hide(t){this._showTimeoutId!=null&&clearTimeout(this._showTimeoutId),this._hideTimeoutId=setTimeout(()=>{this._toggleVisibility(!1),this._hideTimeoutId=void 0},t)}afterHidden(){return this._onHide}isVisible(){return this._isVisible}ngOnDestroy(){this._cancelPendingAnimations(),this._onHide.complete(),this._triggerElement=null}_handleBodyInteraction(){this._closeOnInteraction&&this.hide(0)}_markForCheck(){this._changeDetectorRef.markForCheck()}_handleMouseLeave({relatedTarget:t}){(!t||!this._triggerElement.contains(t))&&(this.isVisible()?this.hide(this._mouseLeaveHideDelay):this._finalizeAnimation(!1))}_onShow(){this._isMultiline=this._isTooltipMultiline(),this._markForCheck()}_isTooltipMultiline(){let t=this._elementRef.nativeElement.getBoundingClientRect();return t.height>pn&&t.width>=mn}_handleAnimationEnd({animationName:t}){(t===this._showAnimation||t===this._hideAnimation)&&this._finalizeAnimation(t===this._showAnimation)}_cancelPendingAnimations(){this._showTimeoutId!=null&&clearTimeout(this._showTimeoutId),this._hideTimeoutId!=null&&clearTimeout(this._hideTimeoutId),this._showTimeoutId=this._hideTimeoutId=void 0}_finalizeAnimation(t){t?this._closeOnInteraction=!0:this.isVisible()||this._onHide.next()}_toggleVisibility(t){let e=this._tooltip.nativeElement,i=this._showAnimation,n=this._hideAnimation;if(e.classList.remove(t?n:i),e.classList.add(t?i:n),this._isVisible!==t&&(this._isVisible=t,this._changeDetectorRef.markForCheck()),t&&!this._animationsDisabled&&typeof getComputedStyle=="function"){let c=getComputedStyle(e);(c.getPropertyValue("animation-duration")==="0s"||c.getPropertyValue("animation-name")==="none")&&(this._animationsDisabled=!0)}t&&this._onShow(),this._animationsDisabled&&(e.classList.add("_mat-animation-noopable"),this._finalizeAnimation(t))}static{this.\u0275fac=function(e){return new(e||o)(p(ct),p(Z),p(Ve,8))}}static{this.\u0275cmp=x({type:o,selectors:[["mat-tooltip-component"]],viewQuery:function(e,i){if(e&1&&lt(nn,7),e&2){let n;Y(n=W())&&(i._tooltip=n.first)}},hostAttrs:["aria-hidden","true"],hostBindings:function(e,i){e&1&&u("mouseleave",function(c){return i._handleMouseLeave(c)})},standalone:!0,features:[P],decls:4,vars:4,consts:[["tooltip",""],[1,"mdc-tooltip","mat-mdc-tooltip",3,"animationend","ngClass"],[1,"mat-mdc-tooltip-surface","mdc-tooltip__surface"]],template:function(e,i){if(e&1){let n=y();r(0,"div",1,0),u("animationend",function(f){return _(n),g(i._handleAnimationEnd(f))}),r(2,"div",2),s(3),a()()}e&2&&(Vt("mdc-tooltip--multiline",i._isMultiline),m("ngClass",i.tooltipClass),l(3),w(i.message))},dependencies:[ie],styles:['.mat-mdc-tooltip{position:relative;transform:scale(0);display:inline-flex}.mat-mdc-tooltip::before{content:"";top:0;right:0;bottom:0;left:0;z-index:-1;position:absolute}.mat-mdc-tooltip-panel-below .mat-mdc-tooltip::before{top:-8px}.mat-mdc-tooltip-panel-above .mat-mdc-tooltip::before{bottom:-8px}.mat-mdc-tooltip-panel-right .mat-mdc-tooltip::before{left:-8px}.mat-mdc-tooltip-panel-left .mat-mdc-tooltip::before{right:-8px}.mat-mdc-tooltip._mat-animation-noopable{animation:none;transform:scale(1)}.mat-mdc-tooltip-surface{word-break:normal;overflow-wrap:anywhere;padding:4px 8px;min-width:40px;max-width:200px;min-height:24px;max-height:40vh;box-sizing:border-box;overflow:hidden;text-align:center;will-change:transform,opacity;background-color:var(--mdc-plain-tooltip-container-color, var(--mat-app-inverse-surface));color:var(--mdc-plain-tooltip-supporting-text-color, var(--mat-app-inverse-on-surface));border-radius:var(--mdc-plain-tooltip-container-shape, var(--mat-app-corner-extra-small));font-family:var(--mdc-plain-tooltip-supporting-text-font, var(--mat-app-body-small-font));font-size:var(--mdc-plain-tooltip-supporting-text-size, var(--mat-app-body-small-size));font-weight:var(--mdc-plain-tooltip-supporting-text-weight, var(--mat-app-body-small-weight));line-height:var(--mdc-plain-tooltip-supporting-text-line-height, var(--mat-app-body-small-line-height));letter-spacing:var(--mdc-plain-tooltip-supporting-text-tracking, var(--mat-app-body-small-tracking))}.mat-mdc-tooltip-surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:1px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}.mdc-tooltip--multiline .mat-mdc-tooltip-surface{text-align:left}[dir=rtl] .mdc-tooltip--multiline .mat-mdc-tooltip-surface{text-align:right}.mat-mdc-tooltip-panel.mat-mdc-tooltip-panel-non-interactive{pointer-events:none}@keyframes mat-mdc-tooltip-show{0%{opacity:0;transform:scale(0.8)}100%{opacity:1;transform:scale(1)}}@keyframes mat-mdc-tooltip-hide{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(0.8)}}.mat-mdc-tooltip-show{animation:mat-mdc-tooltip-show 150ms cubic-bezier(0, 0, 0.2, 1) forwards}.mat-mdc-tooltip-hide{animation:mat-mdc-tooltip-hide 75ms cubic-bezier(0.4, 0, 1, 1) forwards}'],encapsulation:2,changeDetection:0})}}return o})();function hn(o,d){if(o&1&&(r(0,"mat-option",17),s(1),a()),o&2){let t=d.$implicit;m("value",t),l(),S(" ",t," ")}}function fn(o,d){if(o&1){let t=y();r(0,"mat-form-field",14)(1,"mat-select",16,0),u("selectionChange",function(i){_(t);let n=h(2);return g(n._changePageSize(i.value))}),A(3,hn,2,2,"mat-option",17,pt),a(),r(5,"div",18),u("click",function(){_(t);let i=J(2);return g(i.open())}),a()()}if(o&2){let t=h(2);m("appearance",t._formFieldAppearance)("color",t.color),l(),m("value",t.pageSize)("disabled",t.disabled)("aria-labelledby",t._pageSizeLabelId)("panelClass",t.selectConfig.panelClass||"")("disableOptionCentering",t.selectConfig.disableOptionCentering),l(2),D(t._displayedPageSizeOptions)}}function _n(o,d){if(o&1&&(r(0,"div",15),s(1),a()),o&2){let t=h(2);l(),w(t.pageSize)}}function gn(o,d){if(o&1&&(r(0,"div",3)(1,"div",13),s(2),a(),v(3,fn,6,7,"mat-form-field",14)(4,_n,2,1,"div",15),a()),o&2){let t=h();l(),$("id",t._pageSizeLabelId),l(),S(" ",t._intl.itemsPerPageLabel," "),l(),M(t._displayedPageSizeOptions.length>1?3:-1),l(),M(t._displayedPageSizeOptions.length<=1?4:-1)}}function vn(o,d){if(o&1){let t=y();r(0,"button",19),u("click",function(){_(t);let i=h();return g(i.firstPage())}),Ft(),r(1,"svg",8),b(2,"path",20),a()()}if(o&2){let t=h();m("matTooltip",t._intl.firstPageLabel)("matTooltipDisabled",t._previousButtonsDisabled())("matTooltipPosition","above")("disabled",t._previousButtonsDisabled()),$("aria-label",t._intl.firstPageLabel)}}function bn(o,d){if(o&1){let t=y();r(0,"button",21),u("click",function(){_(t);let i=h();return g(i.lastPage())}),Ft(),r(1,"svg",8),b(2,"path",22),a()()}if(o&2){let t=h();m("matTooltip",t._intl.lastPageLabel)("matTooltipDisabled",t._nextButtonsDisabled())("matTooltipPosition","above")("disabled",t._nextButtonsDisabled()),$("aria-label",t._intl.lastPageLabel)}}var yn=(()=>{class o{constructor(){this.changes=new T,this.itemsPerPageLabel="Items per page:",this.nextPageLabel="Next page",this.previousPageLabel="Previous page",this.firstPageLabel="First page",this.lastPageLabel="Last page",this.getRangeLabel=(t,e,i)=>{if(i==0||e==0)return`0 of ${i}`;i=Math.max(i,0);let n=t*e,c=n<i?Math.min(n+e,i):n+e;return`${n+1} \u2013 ${c} of ${i}`}}static{this.\u0275fac=function(e){return new(e||o)}}static{this.\u0275prov=Re({token:o,factory:o.\u0275fac,providedIn:"root"})}}return o})();var Cn=50;var Sn=new X("MAT_PAGINATOR_DEFAULT_OPTIONS"),xn=0,lo=(()=>{class o{get pageIndex(){return this._pageIndex}set pageIndex(t){this._pageIndex=Math.max(t||0,0),this._changeDetectorRef.markForCheck()}get length(){return this._length}set length(t){this._length=t||0,this._changeDetectorRef.markForCheck()}get pageSize(){return this._pageSize}set pageSize(t){this._pageSize=Math.max(t||0,0),this._updateDisplayedPageSizeOptions()}get pageSizeOptions(){return this._pageSizeOptions}set pageSizeOptions(t){this._pageSizeOptions=(t||[]).map(e=>jt(e,0)),this._updateDisplayedPageSizeOptions()}constructor(t,e,i){if(this._intl=t,this._changeDetectorRef=e,this._pageSizeLabelId=`mat-paginator-page-size-label-${xn++}`,this._isInitialized=!1,this._initializedStream=new we(1),this._pageIndex=0,this._length=0,this._pageSizeOptions=[],this.hidePageSize=!1,this.showFirstLastButtons=!1,this.selectConfig={},this.disabled=!1,this.page=new K,this.initialized=this._initializedStream,this._intlChanges=t.changes.subscribe(()=>this._changeDetectorRef.markForCheck()),i){let{pageSize:n,pageSizeOptions:c,hidePageSize:f,showFirstLastButtons:C}=i;n!=null&&(this._pageSize=n),c!=null&&(this._pageSizeOptions=c),f!=null&&(this.hidePageSize=f),C!=null&&(this.showFirstLastButtons=C)}this._formFieldAppearance=i?.formFieldAppearance||"outline"}ngOnInit(){this._isInitialized=!0,this._updateDisplayedPageSizeOptions(),this._initializedStream.next()}ngOnDestroy(){this._initializedStream.complete(),this._intlChanges.unsubscribe()}nextPage(){if(!this.hasNextPage())return;let t=this.pageIndex;this.pageIndex=this.pageIndex+1,this._emitPageEvent(t)}previousPage(){if(!this.hasPreviousPage())return;let t=this.pageIndex;this.pageIndex=this.pageIndex-1,this._emitPageEvent(t)}firstPage(){if(!this.hasPreviousPage())return;let t=this.pageIndex;this.pageIndex=0,this._emitPageEvent(t)}lastPage(){if(!this.hasNextPage())return;let t=this.pageIndex;this.pageIndex=this.getNumberOfPages()-1,this._emitPageEvent(t)}hasPreviousPage(){return this.pageIndex>=1&&this.pageSize!=0}hasNextPage(){let t=this.getNumberOfPages()-1;return this.pageIndex<t&&this.pageSize!=0}getNumberOfPages(){return this.pageSize?Math.ceil(this.length/this.pageSize):0}_changePageSize(t){let e=this.pageIndex*this.pageSize,i=this.pageIndex;this.pageIndex=Math.floor(e/t)||0,this.pageSize=t,this._emitPageEvent(i)}_nextButtonsDisabled(){return this.disabled||!this.hasNextPage()}_previousButtonsDisabled(){return this.disabled||!this.hasPreviousPage()}_updateDisplayedPageSizeOptions(){this._isInitialized&&(this.pageSize||(this._pageSize=this.pageSizeOptions.length!=0?this.pageSizeOptions[0]:Cn),this._displayedPageSizeOptions=this.pageSizeOptions.slice(),this._displayedPageSizeOptions.indexOf(this.pageSize)===-1&&this._displayedPageSizeOptions.push(this.pageSize),this._displayedPageSizeOptions.sort((t,e)=>t-e),this._changeDetectorRef.markForCheck())}_emitPageEvent(t){this.page.emit({previousPageIndex:t,pageIndex:this.pageIndex,pageSize:this.pageSize,length:this.length})}static{this.\u0275fac=function(e){return new(e||o)(p(yn),p(ct),p(Sn,8))}}static{this.\u0275cmp=x({type:o,selectors:[["mat-paginator"]],hostAttrs:["role","group",1,"mat-mdc-paginator"],inputs:{color:"color",pageIndex:[2,"pageIndex","pageIndex",jt],length:[2,"length","length",jt],pageSize:[2,"pageSize","pageSize",jt],pageSizeOptions:"pageSizeOptions",hidePageSize:[2,"hidePageSize","hidePageSize",B],showFirstLastButtons:[2,"showFirstLastButtons","showFirstLastButtons",B],selectConfig:"selectConfig",disabled:[2,"disabled","disabled",B]},outputs:{page:"page"},exportAs:["matPaginator"],standalone:!0,features:[Lt,P],decls:14,vars:14,consts:[["selectRef",""],[1,"mat-mdc-paginator-outer-container"],[1,"mat-mdc-paginator-container"],[1,"mat-mdc-paginator-page-size"],[1,"mat-mdc-paginator-range-actions"],["aria-live","polite",1,"mat-mdc-paginator-range-label"],["mat-icon-button","","type","button",1,"mat-mdc-paginator-navigation-first",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled"],["mat-icon-button","","type","button",1,"mat-mdc-paginator-navigation-previous",3,"click","matTooltip","matTooltipDisabled","matTooltipPosition","disabled"],["viewBox","0 0 24 24","focusable","false","aria-hidden","true",1,"mat-mdc-paginator-icon"],["d","M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"],["mat-icon-button","","type","button",1,"mat-mdc-paginator-navigation-next",3,"click","matTooltip","matTooltipDisabled","matTooltipPosition","disabled"],["d","M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"],["mat-icon-button","","type","button",1,"mat-mdc-paginator-navigation-last",3,"matTooltip","matTooltipDisabled","matTooltipPosition","disabled"],[1,"mat-mdc-paginator-page-size-label"],[1,"mat-mdc-paginator-page-size-select",3,"appearance","color"],[1,"mat-mdc-paginator-page-size-value"],["hideSingleSelectionIndicator","",3,"selectionChange","value","disabled","aria-labelledby","panelClass","disableOptionCentering"],[3,"value"],[1,"mat-mdc-paginator-touch-target",3,"click"],["mat-icon-button","","type","button",1,"mat-mdc-paginator-navigation-first",3,"click","matTooltip","matTooltipDisabled","matTooltipPosition","disabled"],["d","M18.41 16.59L13.82 12l4.59-4.59L17 6l-6 6 6 6zM6 6h2v12H6z"],["mat-icon-button","","type","button",1,"mat-mdc-paginator-navigation-last",3,"click","matTooltip","matTooltipDisabled","matTooltipPosition","disabled"],["d","M5.59 7.41L10.18 12l-4.59 4.59L7 18l6-6-6-6zM16 6h2v12h-2z"]],template:function(e,i){e&1&&(r(0,"div",1)(1,"div",2),v(2,gn,5,4,"div",3),r(3,"div",4)(4,"div",5),s(5),a(),v(6,vn,3,5,"button",6),r(7,"button",7),u("click",function(){return i.previousPage()}),Ft(),r(8,"svg",8),b(9,"path",9),a()(),Le(),r(10,"button",10),u("click",function(){return i.nextPage()}),Ft(),r(11,"svg",8),b(12,"path",11),a()(),v(13,bn,3,5,"button",12),a()()()),e&2&&(l(2),M(i.hidePageSize?-1:2),l(3),S(" ",i._intl.getRangeLabel(i.pageIndex,i.pageSize,i.length)," "),l(),M(i.showFirstLastButtons?6:-1),l(),m("matTooltip",i._intl.previousPageLabel)("matTooltipDisabled",i._previousButtonsDisabled())("matTooltipPosition","above")("disabled",i._previousButtonsDisabled()),$("aria-label",i._intl.previousPageLabel),l(3),m("matTooltip",i._intl.nextPageLabel)("matTooltipDisabled",i._nextButtonsDisabled())("matTooltipPosition","above")("disabled",i._nextButtonsDisabled()),$("aria-label",i._intl.nextPageLabel),l(3),M(i.showFirstLastButtons?13:-1))},dependencies:[k,Et,it,re,so],styles:[".mat-mdc-paginator{display:block;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;color:var(--mat-paginator-container-text-color, var(--mat-app-on-surface));background-color:var(--mat-paginator-container-background-color, var(--mat-app-surface));font-family:var(--mat-paginator-container-text-font, var(--mat-app-body-small-font));line-height:var(--mat-paginator-container-text-line-height, var(--mat-app-body-small-line-height));font-size:var(--mat-paginator-container-text-size, var(--mat-app-body-small-size));font-weight:var(--mat-paginator-container-text-weight, var(--mat-app-body-small-weight));letter-spacing:var(--mat-paginator-container-text-tracking, var(--mat-app-body-small-tracking));--mat-form-field-container-height:var(--mat-paginator-form-field-container-height);--mat-form-field-container-vertical-padding:var(--mat-paginator-form-field-container-vertical-padding)}.mat-mdc-paginator .mat-mdc-select-value{font-size:var(--mat-paginator-select-trigger-text-size, var(--mat-app-body-small-size))}.mat-mdc-paginator .mat-mdc-form-field-subscript-wrapper{display:none}.mat-mdc-paginator .mat-mdc-select{line-height:1.5}.mat-mdc-paginator-outer-container{display:flex}.mat-mdc-paginator-container{display:flex;align-items:center;justify-content:flex-end;padding:0 8px;flex-wrap:wrap;width:100%;min-height:var(--mat-paginator-container-size)}.mat-mdc-paginator-page-size{display:flex;align-items:baseline;margin-right:8px}[dir=rtl] .mat-mdc-paginator-page-size{margin-right:0;margin-left:8px}.mat-mdc-paginator-page-size-label{margin:0 4px}.mat-mdc-paginator-page-size-select{margin:0 4px;width:84px}.mat-mdc-paginator-range-label{margin:0 32px 0 24px}.mat-mdc-paginator-range-actions{display:flex;align-items:center}.mat-mdc-paginator-icon{display:inline-block;width:28px;fill:var(--mat-paginator-enabled-icon-color, var(--mat-app-on-surface-variant))}.mat-mdc-icon-button[disabled] .mat-mdc-paginator-icon{fill:var(--mat-paginator-disabled-icon-color)}[dir=rtl] .mat-mdc-paginator-icon{transform:rotate(180deg)}.cdk-high-contrast-active .mat-mdc-icon-button[disabled] .mat-mdc-paginator-icon,.cdk-high-contrast-active .mat-mdc-paginator-icon{fill:currentColor;fill:CanvasText}.cdk-high-contrast-active .mat-mdc-paginator-range-actions .mat-mdc-icon-button{outline:solid 1px}.mat-mdc-paginator-touch-target{display:var(--mat-paginator-touch-target-display);position:absolute;top:50%;left:50%;width:84px;height:48px;background-color:rgba(0,0,0,0);transform:translate(-50%, -50%);cursor:pointer}"],encapsulation:2,changeDetection:0})}}return o})();var Pn=(o,d)=>d.produto.id,Mn=o=>[o,"BRL","symbol","1.2-2","pt-BR"];function wn(o,d){o&1&&(r(0,"th",23),s(1," Cliente "),a())}function In(o,d){if(o&1&&(r(0,"td",24),s(1),a()),o&2){let t=d.$implicit;l(),S(" ",t.cliente==null?null:t.cliente.nome," ")}}function Tn(o,d){o&1&&(r(0,"th",23),s(1," Vendedor "),a())}function On(o,d){if(o&1&&(r(0,"td",24),s(1),a()),o&2){let t=d.$implicit;l(),S(" ",t.vendedor==null?null:t.vendedor.nome," ")}}function En(o,d){o&1&&(r(0,"th",23),s(1," Valor Total "),a())}function An(o,d){if(o&1&&(r(0,"td",24),s(1),Q(2,"currency"),a()),o&2){let t=d.$implicit;l(),S(" ",$e(2,1,qe(7,Mn,t.valor_total))," ")}}function Dn(o,d){o&1&&(r(0,"th",23),s(1," Itens "),a())}function kn(o,d){if(o&1&&(r(0,"li"),s(1),a()),o&2){let t=d.$implicit;l(),tt("",t.produto.nome," - ",t.quantidade,"")}}function Rn(o,d){if(o&1&&A(0,kn,2,2,"li",null,Pn),o&2){let t=h().$implicit;D(t.itens)}}function Fn(o,d){o&1&&(r(0,"li"),s(1,"Sem itens"),a())}function Ln(o,d){if(o&1&&(r(0,"td",24)(1,"ul"),v(2,Rn,2,0)(3,Fn,2,0,"li"),a()()),o&2){let t=d.$implicit;l(2),M(t.itens&&t.itens.length>0?2:3)}}function Vn(o,d){o&1&&(r(0,"th",23),s(1," Data da Venda "),a())}function zn(o,d){if(o&1&&(r(0,"td",24),s(1),Q(2,"date"),a()),o&2){let t=d.$implicit;l(),S(" ",He(2,1,t.data_venda,"dd/MM/yyyy","pt-BR")," ")}}function jn(o,d){o&1&&b(0,"tr",25)}function Nn(o,d){o&1&&b(0,"tr",26)}var co=(()=>{class o{httpMethos;authService;router;sales=[];dataSource=new Wi(this.sales);displayedColumns=["cliente","vendedor","valor_total","itens","data_venda"];pathUrlSales=G.SALE;searchTerm="";currentPage=0;limit=10;totalResults=0;searchChanged=new T;paginator;constructor(t,e,i){this.httpMethos=t,this.authService=e,this.router=i}ngOnInit(){console.log("Valor inicial de currentPage:",this.currentPage),this.search()}ngAfterViewInit(){this.dataSource.paginator=this.paginator,console.log("Paginator atribu\xEDdo ao dataSource:",this.dataSource.paginator)}get totalPages(){return Math.ceil(this.totalResults/this.limit)}search(){this.searchRegisters(this.searchTerm,0)}searchRegisters(t="",e=0,i=this.limit){let n={expand:["cliente","vendedor","itens.produto"],active:!0,academia:this.authService.get_gym(),limit:i,offset:e};t&&(n.search=t),this.httpMethos.getPaginated(this.pathUrlSales,n).subscribe(c=>{this.totalResults=c.count,this.sales=c.results,this.dataSource.data=this.sales,this.currentPage=e/i,console.log(c)})}nextPage(){let t=Math.ceil(this.totalResults/this.limit)-1;if(this.currentPage<t){let e=(this.currentPage+1)*this.limit;this.searchRegisters(this.searchTerm,e)}}prevPage(){if(this.currentPage>0){let t=(this.currentPage-1)*this.limit;this.searchRegisters(this.searchTerm,t)}}onSearchChange(t){this.searchTerm=t,this.searchRegisters(this.searchTerm,0)}create(){this.router.navigate(["/product/sellPage"]).then()}static \u0275fac=function(e){return new(e||o)(p(N),p(ce),p(et))};static \u0275cmp=x({type:o,selectors:[["app-sales"]],viewQuery:function(e,i){if(e&1&&lt(lo,5),e&2){let n;Y(n=W())&&(i.paginator=n.first)}},standalone:!0,features:[P],decls:46,vars:8,consts:[[1,"title"],[1,"subtitle","flex","justify-content-center","flex","mb-4"],[1,"ml-8","mr-8"],[1,"flex","align-items-center","justify-content-start"],["appearance","outline",1,"search","w-30rem"],["matInput","text","placeholder","Procure por produto vendedor ou cliente",3,"ngModelChange","input","ngModel"],[1,"flex","align-items-center","justify-content-between","w-full","mb-4"],[1,"w-10rem"],[1,"align-self-start","mr-2"],["mat-raised-button","","color","primary",1,"add_button","bg-black-alpha-70","mt-2",2,"color","white",3,"click"],[1,"mat-elevation-z1","bg-black-alpha-80"],["mat-table","",1,"mat-elevation-z8","demo-table",3,"dataSource"],["matColumnDef","cliente"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","vendedor"],["matColumnDef","valor_total"],["matColumnDef","itens"],["matColumnDef","data_venda"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"pagination-controls"],[3,"click","disabled"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""]],template:function(e,i){e&1&&(r(0,"h2",0),s(1,"Vendas"),a(),r(2,"div",1),s(3,"Verifique as vendas realizada e regisstre novas vendas"),a(),r(4,"main",2)(5,"div",3)(6,"mat-form-field",4)(7,"mat-label"),s(8,"Buscar registro"),a(),r(9,"input",5),_t("ngModelChange",function(c){return ft(i.searchTerm,c)||(i.searchTerm=c),c}),u("input",function(){return i.onSearchChange(i.searchTerm)}),a()(),r(10,"div",6),b(11,"div",7),r(12,"div",8)(13,"button",9),u("click",function(){return i.create()}),r(14,"mat-icon"),s(15,"add"),a(),s(16," Registrar nova venda "),a()()()(),r(17,"div")(18,"div",10)(19,"table",11),mt(20,12),v(21,wn,2,0,"th",13)(22,In,2,1,"td",14),ut(),mt(23,15),v(24,Tn,2,0,"th",13)(25,On,2,1,"td",14),ut(),mt(26,16),v(27,En,2,0,"th",13)(28,An,3,9,"td",14),ut(),mt(29,17),v(30,Dn,2,0,"th",13)(31,Ln,4,1,"td",14),ut(),mt(32,18),v(33,Vn,2,0,"th",13)(34,zn,3,5,"td",14),ut(),v(35,jn,1,0,"tr",19)(36,Nn,1,0,"tr",20),a()(),r(37,"div",21)(38,"button",22),u("click",function(){return i.prevPage()}),r(39,"mat-icon"),s(40,"chevron_left"),a()(),r(41,"span"),s(42),a(),r(43,"button",22),u("click",function(){return i.nextPage()}),r(44,"mat-icon"),s(45,"chevron_right"),a()()()()()),e&2&&(l(9),ht("ngModel",i.searchTerm),l(10),m("dataSource",i.dataSource),l(16),m("matHeaderRowDef",i.displayedColumns),l(),m("matRowDefColumns",i.displayedColumns),l(2),m("disabled",i.currentPage===0),l(4),tt("P\xE1gina ",i.currentPage+1," de ",i.totalPages,""),l(),m("disabled",i.currentPage>=i.totalPages-1))},dependencies:[k,j,nt,L,V,St,F,zi,Bi,Gi,qi,ji,Ni,vt,Qe,Ui,$i,Hi,Yi,bi,ot,z],styles:[".title[_ngcontent-%COMP%]{text-align:center;margin-bottom:16px;font-size:1.5rem;color:#333}.pagination-controls[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin-top:16px}.pagination-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:36px;height:36px;margin:0 8px;border-radius:50%;background-color:#e0e0e0;color:#000;border:none;cursor:pointer;display:flex;justify-content:center;align-items:center;box-shadow:0 2px 2px #0003;transition:background-color .3s ease,box-shadow .3s ease}.pagination-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#d6d6d6}.pagination-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{background-color:#f5f5f5;color:#9e9e9e;cursor:not-allowed;box-shadow:none}.pagination-controls[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;margin:0 8px;color:#757575}"]})}return o})();var po=[{path:"productInventory",component:oo},{path:"sellPage",component:to},{path:"form/:action",component:no},{path:"sales",component:co}];var Os=(()=>{class o{static \u0275fac=function(e){return new(e||o)};static \u0275mod=Rt({type:o});static \u0275inj=kt({imports:[bt,Ke.forChild(po)]})}return o})();export{Os as ProductModule};
