import{a as ke}from"./chunk-T2GD2P46.js";import{b as Se}from"./chunk-5MJIV347.js";import{c as G,d as U,e as j,f as R,g as L,h as Fe}from"./chunk-DUHGU6EU.js";import{a as B}from"./chunk-CQ6IIDQT.js";import{a as ge,b as he}from"./chunk-RFQI5BNG.js";import{b as k,c as Pe,g as O,j as T,l as D}from"./chunk-ZVP2WZDK.js";import{A as be,D as xe,G as Me,H as ye,I as Ee,Y as F,a as h,d as P,q as w,s as _,u as I,v as _e,x as Ce,y as ve}from"./chunk-KF24QTHE.js";import"./chunk-EJJBCPAK.js";import{a as we,c as Ie}from"./chunk-2TN3GL7T.js";import{j as pe,l as S,ma as fe,p as ue}from"./chunk-V6KZPOXC.js";import{$ as K,$b as oe,$c as de,Ab as ee,Bb as o,Cb as n,Db as x,E as Z,Hb as te,Kb as u,Mb as E,Sc as se,Xa as m,Xb as ie,Ya as d,Yb as a,Zb as y,Zc as ce,_b as M,ac as ne,bc as re,cc as ae,ec as g,f as J,ia as f,ic as me,ja as Q,jc as le,nb as b,qa as N,ra as V,sb as c,xb as C,yb as X,zb as Y}from"./chunk-BE5RT4AU.js";import{a as H,b as W}from"./chunk-JKOY2XUY.js";var Te=(()=>{class r{static \u0275fac=function(t){return new(t||r)};static \u0275cmp=f({type:r,selectors:[["app-confirm-dialog-component"]],standalone:!0,features:[g],decls:9,vars:2,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["mat-button","",3,"mat-dialog-close"],["mat-button","","color","warn",3,"mat-dialog-close"]],template:function(t,i){t&1&&(o(0,"h1",0),a(1,"Confirma\xE7\xE3o"),n(),o(2,"div",1),a(3,"Voce tem certeza de que deseja excluir esse funcionario? Ele n\xE3o podera acessar novamente o sistema da academia"),n(),o(4,"div",2)(5,"button",3),a(6,"Cancelar"),n(),o(7,"button",4),a(8,"Confirmar"),n()()),t&2&&(m(5),c("mat-dialog-close",!1),m(2),c("mat-dialog-close",!0))},dependencies:[Fe,U,j,L,R,P,h]})}return r})();function Ve(r,p){if(r&1){let e=te();o(0,"mat-card",12)(1,"mat-card-content")(2,"mat-card",13),a(3),n(),o(4,"div",14)(5,"div",15),a(6),n(),o(7,"div",16)(8,"div",17),a(9),n(),o(10,"div",18),a(11),n()()(),o(12,"div",18),a(13),n()(),o(14,"div",19)(15,"div",20),u("click",function(){let i=N(e).$implicit,l=E();return V(l.edit(i))}),o(16,"mat-icon"),a(17,"edit"),n(),o(18,"span"),a(19,"Editar"),n()(),o(20,"div",21),u("click",function(){let i=N(e).$implicit,l=E();return V(l.disable(i))}),o(21,"mat-icon"),a(22,"delete"),n(),o(23,"span"),a(24,"Remover"),n()()()()}if(r&2){let e=p.$implicit,t=E();m(2),ie("color: white ;background-color:",t.getTipoUsuarioClass(e.tipo_usuario),""),m(),M(" ",t.getTypeUserClass(e.tipo_usuario)," "),m(3),M(" ",t.getInitials(e.nome)," "),m(3),y(e.nome),m(2),y(e.username),m(2),M(" Data contratacao: ",e.data_de_contratacao," ")}}var De=(()=>{class r{httpMethods;router;dialog;snackBar;pathUrlEmployee=D.USERS;employers;gym_id="";typeUser="";searchTerm="";limit=30;totalResults=0;currentPage=0;searchChange=new J;constructor(e,t,i,l){this.httpMethods=e,this.router=t,this.dialog=i,this.snackBar=l}ngOnInit(){this.getIdGym(),this.search(),this.getTypeUser(),this.searchChange.pipe(Z(150)).subscribe(e=>{this.searchEmployee(e,0)})}getIdGym(){this.gym_id=localStorage.getItem("academia")}getTypeUser(){this.typeUser=localStorage.getItem("tipo_usuario")}search(){this.searchEmployee(this.searchTerm,0)}getInitials(e){if(!e)return"";let i=e.trim().split(" ").map(l=>l.charAt(0).toUpperCase()).join("");return i.length>2?i.substring(0,2):i}create(){this.router.navigate(["/employee/form/create"]).then()}trackById(e,t){return t}searchEmployee(e="",t=0,i=this.limit){let l={expand:["aluno","plano"],active:!0,academia:this.gym_id,limit:i,offset:t};e&&(l.search=e),this.httpMethods.getPaginated(this.pathUrlEmployee,l).subscribe(s=>{this.employers=s.results,this.totalResults=s.count,this.currentPage=t/i})}nextPage(){let e=Math.ceil(this.totalResults/this.limit)-1;if(this.currentPage<e){let t=(this.currentPage+1)*this.limit;this.searchEmployee(this.searchTerm,t)}}prevPage(){if(this.currentPage>0){let e=(this.currentPage-1)*this.limit;this.searchEmployee(this.searchTerm,e)}}onSearchChange(e){this.searchTerm=e,this.searchChange.next(e)}getTipoUsuarioClass(e){switch(e){case"A":return"#ea62e8";case"G":return"#3787e6";case"D":return"#2dd853";default:return"bg-gray-200 text-gray-800"}}getTypeUserClass(e){switch(e){case"A":return"Atendente";case"G":return"Gerente";case"D":return"Dono";default:return""}}edit(e){this.router.navigate([`/employee/form/${e.id}`]).then()}disable(e){let t=this.dialog.open(Te),i="desativar_usuario";t.afterClosed().subscribe(l=>{if(l){let s="Funcionario apagado";this.httpMethods.disable(this.pathUrlEmployee,e,i).subscribe(()=>{this.search()}),this.snackBar.open(s,"fechar",{duration:5e3,verticalPosition:"top"})}})}static \u0275fac=function(t){return new(t||r)(d(B),d(S),d(G),d(F))};static \u0275cmp=f({type:r,selectors:[["app-list"]],standalone:!0,features:[g],decls:26,vars:10,consts:[[1,"employer-list"],[1,"subtitle","flex","justify-content-center"],[1,"flex","align-items-center","justify-content-between","w-full","mb-4"],[1,"w-10rem"],["appearance","outline",1,"search","w-30rem"],["matInput","text","placeholder","Digite o nome ou email",3,"ngModelChange","input","ngModel"],[1,"align-self-start","mr-2"],["mat-raised-button","","color","primary",1,"add_button","bg-black-alpha-70","mt-2",2,"color","white",3,"click"],[1,"member-list","ml-4"],["class","member-card gap-3",4,"ngFor","ngForOf","ngForTrackBy"],[1,"pagination","flex","justify-content-center","gap-2","mt-5"],["mat-raised-button","",3,"click","disabled"],[1,"member-card","gap-3"],[1,"absolute","top-0","right-0","m-2","px-2","py-1","text-sm","shadow-1","rounded"],[1,"member-info","flex","align-items-center","mb-2"],[1,"avatar","align-items-center"],[1,"flex-column"],[1,"font-bold"],[1,"email"],[1,"footer","p-2","flex","justify-content-around","align-items-center"],[1,"icon-edit","flex","items-center","gap-2",3,"click"],[1,"icon-delete","flex","items-center","gap-2",3,"click"]],template:function(t,i){t&1&&(o(0,"div",0)(1,"h2"),a(2,"Funcion\xE1rios"),n(),o(3,"p",1),a(4,"Gerencie os funcionarios com acesso ao sistema"),n(),o(5,"div",2),x(6,"div",3),o(7,"mat-form-field",4)(8,"mat-label"),a(9,"Buscar Funcionario"),n(),o(10,"input",5),ae("ngModelChange",function(s){return re(i.searchTerm,s)||(i.searchTerm=s),s}),u("input",function(){return i.onSearchChange(i.searchTerm)}),n()(),o(11,"div",6)(12,"button",7),u("click",function(){return i.create()}),o(13,"mat-icon"),a(14,"add"),n(),a(15," Novo funcion\xE1rio "),n()()(),o(16,"div",8),b(17,Ve,25,8,"mat-card",9),n(),o(18,"div",10)(19,"button",11),u("click",function(){return i.prevPage()}),a(20,"Anterior"),n(),o(21,"span"),a(22),me(23,"number"),n(),o(24,"button",11),u("click",function(){return i.nextPage()}),a(25,"Pr\xF3xima"),n()()()),t&2&&(m(10),ne("ngModel",i.searchTerm),m(7),c("ngForOf",i.employers)("ngForTrackBy",i.trackById),m(2),c("disabled",i.currentPage===0),m(3),oe("P\xE1gina ",i.currentPage+1," de ",le(23,7,i.totalResults/i.limit,"1.0-0"),""),m(2),c("disabled",i.currentPage>=i.totalResults/i.limit-1))},dependencies:[Se,he,ge,P,h,we,Ie,se,O,T,ye,w,I,Ce,k,ce],styles:[".container[_ngcontent-%COMP%]{padding:20px}.subtitle[_ngcontent-%COMP%]{text-align:center;color:#909090}.search[_ngcontent-%COMP%]{margin:auto}.member-list[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:16px}.member-card[_ngcontent-%COMP%]{width:95%;background:#f8f8f8;border-radius:12px;box-shadow:0 2px 4px #0000001a;transition:all .3s ease-in-out;cursor:pointer}.member-card[_ngcontent-%COMP%]:hover{transform:scale(1.06);box-shadow:0 4px 8px #00000026}.avatar[_ngcontent-%COMP%]{width:40px;height:40px;background-color:#539ecd;color:#fff;font-weight:700;font-size:16px;display:flex;align-items:center;justify-content:center;border-radius:50%;text-transform:uppercase}.member-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.email[_ngcontent-%COMP%]{font-size:.85rem;color:#666}.extra-info[_ngcontent-%COMP%]{margin-top:10px;padding-top:10px;border-top:1px solid #eee}.info-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-size:.9rem;color:#444}.footer[_ngcontent-%COMP%]{background:#ededed;font-size:.9rem;color:#969696;border-top:1px solid #eee;border-radius:0 0 9px 9px}.icon-edit[_ngcontent-%COMP%]:hover{color:#5a87e6}.icon-delete[_ngcontent-%COMP%]:hover{color:#e65a5a}"]})}return r})();var Be=(()=>{class r{static \u0275fac=function(t){return new(t||r)};static \u0275cmp=f({type:r,selectors:[["app-user-relink-confirmation"]],standalone:!0,features:[g],decls:9,vars:2,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["mat-button","",3,"mat-dialog-close"],["mat-button","","color","warn",3,"mat-dialog-close"]],template:function(t,i){t&1&&(o(0,"h1",0),a(1,"Confirma\xE7\xE3o"),n(),o(2,"div",1),a(3,"J\xE1 existe um usuario com esse email cadastrado em uma academia, Deseja vincular esse usuario a essa academia? (Ele n\xE3o podera acessar o sistema da academia anterior)"),n(),o(4,"div",2)(5,"button",3),a(6,"Cancelar"),n(),o(7,"button",4),a(8,"Confirmar"),n()()),t&2&&(m(5),c("mat-dialog-close",!1),m(2),c("mat-dialog-close",!0))},dependencies:[j,R,L,h,U]})}return r})();function ze(r,p){r&1&&(o(0,"mat-error"),a(1," Campo Obrigatorio "),n())}function qe(r,p){r&1&&(o(0,"mat-error"),a(1," Campo Obrigatorio "),n())}function $e(r,p){r&1&&(o(0,"mat-error"),a(1," Insira um email valido "),n())}function He(r,p){r&1&&(o(0,"mat-error"),a(1," Campo Obrigatorio "),n())}function We(r,p){r&1&&(o(0,"mat-error"),a(1," Deve conter no minimo 6 caracteres. "),n())}function Je(r,p){r&1&&(o(0,"mat-error"),a(1," Deve conter um n\xFAmero e um caracter especial "),n())}function Ze(r,p){if(r&1&&(o(0,"mat-option",9),a(1),n()),r&2){let e=p.$implicit;c("value",e.value),m(),M(" ",e.viewValue," ")}}var Ge=(()=>{class r{httpMethods;formBuilder;router;route;snackBar;dialog;action="";pathUrlEmployee=D.USERS;formGroup;created=!0;gymId="";title="Cadastro de funcion\xE1rio";getGym(){this.gymId=localStorage.getItem("academia"),this.gymId&&this.formGroup.patchValue({academia:this.gymId})}constructor(e,t,i,l,s,v){this.httpMethods=e,this.formBuilder=t,this.router=i,this.route=l,this.snackBar=s,this.dialog=v,this.formGroup=this.formBuilder.group({id:[],nome:["",_.required],username:["",[_.required,_.email]],password:["",[_.required,_.minLength(6),_.pattern("^(?=.*\\d)(?=.*[@$!%*?&])[A-Za-z\\d@$!%*?&]+$")]],tipo_usuario:["",_.required],academia:[""]})}ngOnInit(){this.getGym(),this.retriveCallBack()}cargos=[{value:"G",viewValue:"Gerente"},{value:"A",viewValue:"Atendente"}];retriveCallBack(){this.route.paramMap.subscribe(e=>{this.action=e.get("action"),this.created=!(this.action&&this.action!=="create"),this.created||(this.title="Edi\xE7\xE3o de funcion\xE1rio",this.httpMethods.get(this.pathUrlEmployee+this.action+"/").subscribe(t=>{this.formGroup.setValue({id:t.id,nome:t.nome,username:t.username,password:"",tipo_usuario:t.tipo_usuario,academia:this.gymId})}))})}saveOrUpdate(e){if(this.created)this.httpMethods.get(this.pathUrlEmployee+`?email=${e.username}`).subscribe(t=>{if(t&&t.length>0)this.dialog.open(Be).afterClosed().subscribe(l=>{if(l){let s=t[0].id,v=W(H({},e),{usuario:s});this.httpMethods.post(this.pathUrlEmployee+"alterar_academia/",v).subscribe(()=>{this.router.navigate(["/employee/list"])})}});else{let i="Funcionario cadastrado";this.httpMethods.post(this.pathUrlEmployee,e).subscribe(()=>{this.router.navigate(["/employee/list"]).then(),this.snackBar.open(i,"Fechar",{duration:5e3,verticalPosition:"top"})})}});else{let t="Funcionario Atualizado";this.httpMethods.patch(this.pathUrlEmployee,e).subscribe(()=>{this.router.navigate(["/employee/list"]).then(),this.snackBar.open(t,"Fechar",{duration:5e3,verticalPosition:"top"})})}}static \u0275fac=function(t){return new(t||r)(d(B),d(Me),d(S),d(pe),d(F),d(G))};static \u0275cmp=f({type:r,selectors:[["app-form"]],standalone:!0,features:[g],decls:30,vars:9,consts:[[1,"container"],[1,"mat-elevation-z2","form",3,"ngSubmit","formGroup"],[1,"form-title"],["appearance","fill",1,"nome"],["matInput","","formControlName","nome","placeholder","Digite o nome do funcionario"],["appearance","fill"],["matInput","","type","email","formControlName","username","placeholder","Digite o email do funcinario"],["matInput","","type","password","formControlName","password","placeholder","Digite uma senha"],["formControlName","tipo_usuario","ARIA-PLACEHOLDER","Cargo"],[3,"value"],["mat-raised-button","","color","primary","type","submit",1,"save",3,"disabled"]],template:function(t,i){if(t&1&&(o(0,"div",0)(1,"form",1),u("ngSubmit",function(){return i.saveOrUpdate(i.formGroup.value)}),o(2,"h2",2),a(3),n(),o(4,"mat-form-field",3)(5,"mat-label"),a(6,"Nome"),n(),x(7,"input",4),b(8,ze,2,0,"mat-error"),n(),o(9,"mat-form-field",5)(10,"mat-label"),a(11,"Email"),n(),x(12,"input",6),b(13,qe,2,0,"mat-error")(14,$e,2,0,"mat-error"),n(),o(15,"mat-form-field",5)(16,"mat-label"),a(17,"Senha"),n(),x(18,"input",7),b(19,He,2,0,"mat-error")(20,We,2,0,"mat-error")(21,Je,2,0,"mat-error"),n(),o(22,"mat-form-field",5)(23,"mat-label"),a(24,"Cargo"),n(),o(25,"mat-select",8),Y(26,Ze,2,2,"mat-option",9,X),n()(),o(28,"button",10),a(29,"Salvar"),n()()()),t&2){let l,s,v,z,q,$;m(),c("formGroup",i.formGroup),m(2),y(i.title),m(5),C((l=i.formGroup.get("nome"))!=null&&l.hasError("required")?8:-1),m(5),C((s=i.formGroup.get("username"))!=null&&s.hasError("required")?13:-1),m(),C((v=i.formGroup.get("username"))!=null&&v.hasError("email")?14:-1),m(5),C((z=i.formGroup.get("password"))!=null&&z.hasError("required")?19:-1),m(),C((q=i.formGroup.get("password"))!=null&&q.hasError("minlength")?20:-1),m(),C(($=i.formGroup.get("password"))!=null&&$.hasError("pattern")?21:-1),m(5),ee(i.cargos),m(2),c("disabled",!i.formGroup.valid)}},dependencies:[h,O,T,k,Ee,ve,w,I,_e,be,xe,ke,fe,Pe],styles:[".container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh;background-color:#f4f7fc}.form[_ngcontent-%COMP%]{width:100%;max-width:500px;padding:40px;background-color:#fff;border-radius:12px;box-shadow:0 4px 12px #0000001a;font-family:Arial,sans-serif}.form-title[_ngcontent-%COMP%]{text-align:center;font-size:24px;color:#333;margin-bottom:30px}mat-form-field[_ngcontent-%COMP%]{width:100%;margin-bottom:20px}mat-label[_ngcontent-%COMP%]{font-weight:600;color:#333}input[_ngcontent-%COMP%]{font-size:16px;padding:10px;border-radius:4px;border:1px solid #ddd}button[_ngcontent-%COMP%]{width:100%;padding:14px;font-size:16px;border:none;border-radius:4px;cursor:pointer;background-color:#00ff2a;color:#fff;transition:background-color .3s ease-in-out}.input-field[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{font-size:16px}button[disabled][_ngcontent-%COMP%]{background-color:#b0bec5;cursor:not-allowed}@media (max-width: 600px){.form[_ngcontent-%COMP%]{padding:20px}.form-title[_ngcontent-%COMP%]{font-size:20px}button[_ngcontent-%COMP%]{font-size:14px;padding:12px}}"]})}return r})();var Ue=[{path:"list",component:De},{path:"form/:action",component:Ge}];var kt=(()=>{class r{static \u0275fac=function(t){return new(t||r)};static \u0275mod=Q({type:r});static \u0275inj=K({imports:[de,ue.forChild(Ue)]})}return r})();export{kt as EmployeeModule};
