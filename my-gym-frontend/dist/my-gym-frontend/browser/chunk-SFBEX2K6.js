import{b as be}from"./chunk-JUUG4BKF.js";import{a as Pe}from"./chunk-KCQQWE3S.js";import{c as G,d as U,e as j,f as R,g as L,h as we}from"./chunk-MMDW2RSC.js";import{a as Se}from"./chunk-OCPZM4ND.js";import{a as B}from"./chunk-LKDNSSLE.js";import{a as de,b as pe}from"./chunk-EWFQADUA.js";import{a as T}from"./chunk-ZEWUZSSU.js";import{b as k,c as Me,g as D,j as O}from"./chunk-AB4NP454.js";import{$ as F,C as he,F as Ce,J as _e,K as ve,L as xe,a as h,d as w,q as P,s as C,u as I,v as ue,y as fe,z as ge}from"./chunk-7W3YTSKQ.js";import"./chunk-CARY4E7O.js";import{a as ye,c as Ee}from"./chunk-VEVENBIR.js";import{j as le,l as S,na as ce,p as se}from"./chunk-6H5PU6RJ.js";import{$ as K,$b as M,Ab as Y,Bb as ee,Cb as o,Db as n,E as Z,Eb as b,Ib as te,Lb as f,Nb as E,Uc as re,Xa as m,Ya as d,Yb as ie,Zb as r,_b as y,bc as oe,cc as ne,cd as me,dc as ae,f as J,fc as g,ia as u,ja as Q,nb as x,qa as N,ra as V,sb as c,xb as _,zb as X}from"./chunk-OXVJG6A6.js";import{a as H,b as W}from"./chunk-JKOY2XUY.js";var Fe=(()=>{class a{static \u0275fac=function(t){return new(t||a)};static \u0275cmp=u({type:a,selectors:[["app-confirm-dialog-component"]],standalone:!0,features:[g],decls:9,vars:2,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["mat-button","",3,"mat-dialog-close"],["mat-button","","color","warn",3,"mat-dialog-close"]],template:function(t,i){t&1&&(o(0,"h1",0),r(1,"Confirma\xE7\xE3o"),n(),o(2,"div",1),r(3,"Voce tem certeza de que deseja excluir esse funcionario? Ele n\xE3o podera acessar novamente o sistema da academia"),n(),o(4,"div",2)(5,"button",3),r(6,"Cancelar"),n(),o(7,"button",4),r(8,"Confirmar"),n()()),t&2&&(m(5),c("mat-dialog-close",!1),m(2),c("mat-dialog-close",!0))},dependencies:[we,U,j,L,R,w,h]})}return a})();function Le(a,p){if(a&1){let e=te();o(0,"mat-card",11)(1,"mat-card-content")(2,"mat-card",12),r(3),n(),o(4,"div",13)(5,"div",14),r(6),n(),o(7,"div",15)(8,"div",16),r(9),n(),o(10,"div",17),r(11),n()()(),o(12,"div",17),r(13),n()(),o(14,"div",18)(15,"div",19),f("click",function(){let i=N(e).$implicit,l=E();return V(l.edit(i))}),o(16,"mat-icon"),r(17,"edit"),n(),o(18,"span"),r(19,"Editar"),n()(),o(20,"div",20),f("click",function(){let i=N(e).$implicit,l=E();return V(l.disable(i))}),o(21,"mat-icon"),r(22,"delete"),n(),o(23,"span"),r(24,"Remover"),n()()()()}if(a&2){let e=p.$implicit,t=E();m(2),ie("color: white ;background-color:",t.getTipoUsuarioClass(e.tipo_usuario),""),m(),M(" ",t.getTypeUserClass(e.tipo_usuario)," "),m(3),M(" ",t.getInitials(e.nome)," "),m(3),y(e.nome),m(2),y(e.username),m(2),M(" Data contratacao: ",e.data_de_contratacao," ")}}var ke=(()=>{class a{httpMethods;router;dialog;snackBar;pathUrlEmployee=T.USERS;employers;gym_id="";typeUser="";searchTerm="";limit=30;totalResults=0;currentPage=0;searchChange=new J;constructor(e,t,i,l){this.httpMethods=e,this.router=t,this.dialog=i,this.snackBar=l}ngOnInit(){this.getIdGym(),this.search(),this.getTypeUser(),this.searchChange.pipe(Z(150)).subscribe(e=>{this.searchEmployee(e,0)})}getIdGym(){this.gym_id=localStorage.getItem("academia")}getTypeUser(){this.typeUser=localStorage.getItem("tipo_usuario")}search(){this.searchEmployee(this.searchTerm,0)}getInitials(e){if(!e)return"";let i=e.trim().split(" ").map(l=>l.charAt(0).toUpperCase()).join("");return i.length>2?i.substring(0,2):i}create(){this.router.navigate(["/employee/form/create"]).then()}trackById(e,t){return t}searchEmployee(e="",t=0,i=this.limit){let l={expand:["aluno","plano"],active:!0,academia:this.gym_id,limit:i,offset:t};e&&(l.search=e),this.httpMethods.getPaginated(this.pathUrlEmployee,l).subscribe(s=>{this.employers=s.results,this.totalResults=s.count,this.currentPage=t/i})}onSearchChange(e){this.searchTerm=e,this.searchChange.next(e)}getTipoUsuarioClass(e){switch(e){case"A":return"#ea62e8";case"G":return"#3787e6";case"D":return"#2dd853";default:return"bg-gray-200 text-gray-800"}}getTypeUserClass(e){switch(e){case"A":return"Atendente";case"G":return"Gerente";case"D":return"Dono";default:return""}}edit(e){if(e.tipo_usuario==="D"){this.snackBar.open("N\xE3o \xE9 possivel alterar dados do dono da cademia","Fechar",{duration:5e3,verticalPosition:"top"});return}this.router.navigate([`/employee/form/${e.id}`]).then()}disable(e){if(e.tipo_usuario==="D"){this.snackBar.open("N\xE3o \xE9 ppssivel excluir o dono do estabelecimento","Fechar",{duration:5e3,verticalPosition:"top"});return}let t=this.dialog.open(Fe),i="desativar_usuario";t.afterClosed().subscribe(l=>{if(l){let s="Funcionario apagado";this.httpMethods.disable(this.pathUrlEmployee,e,i).subscribe(()=>{this.search()}),this.snackBar.open(s,"fechar",{duration:5e3,verticalPosition:"top"})}})}onPageChange(e){let t=e*this.limit;this.searchEmployee(this.searchTerm,t)}static \u0275fac=function(t){return new(t||a)(d(B),d(S),d(G),d(F))};static \u0275cmp=u({type:a,selectors:[["app-list"]],standalone:!0,features:[g],decls:19,vars:6,consts:[[1,"employer-list"],[1,"subtitle","flex","justify-content-center"],[1,"flex","align-items-center","justify-content-between","w-full","mb-4"],[1,"w-10rem"],["appearance","outline",1,"search","w-30rem"],["matInput","text","placeholder","Digite o nome ou email",3,"ngModelChange","input","ngModel"],[1,"align-self-start","mr-2"],["mat-raised-button","","color","primary",1,"add_button","bg-black-alpha-70","mt-2",2,"color","white",3,"click"],[1,"member-list","ml-4"],["class","member-card gap-3",4,"ngFor","ngForOf","ngForTrackBy"],[3,"pageChange","totalItems","itemsPerPage","currentPage"],[1,"member-card","gap-3"],[1,"absolute","top-0","right-0","m-2","px-2","py-1","text-sm","shadow-1","rounded"],[1,"member-info","flex","align-items-center","mb-2"],[1,"avatar","align-items-center"],[1,"flex-column"],[1,"font-bold"],[1,"email"],[1,"footer","p-2","flex","justify-content-around","align-items-center"],[1,"icon-edit","flex","items-center","gap-2",3,"click"],[1,"icon-delete","flex","items-center","gap-2",3,"click"]],template:function(t,i){t&1&&(o(0,"div",0)(1,"h2"),r(2,"Funcion\xE1rios"),n(),o(3,"p",1),r(4,"Gerencie os funcionarios com acesso ao sistema"),n(),o(5,"div",2),b(6,"div",3),o(7,"mat-form-field",4)(8,"mat-label"),r(9,"Buscar Funcionario"),n(),o(10,"input",5),ae("ngModelChange",function(s){return ne(i.searchTerm,s)||(i.searchTerm=s),s}),f("input",function(){return i.onSearchChange(i.searchTerm)}),n()(),o(11,"div",6)(12,"button",7),f("click",function(){return i.create()}),o(13,"mat-icon"),r(14,"add"),n(),r(15," Novo funcion\xE1rio "),n()()(),o(16,"div",8),x(17,Le,25,8,"mat-card",9),n(),o(18,"app-paginator",10),f("pageChange",function(s){return i.onPageChange(s)}),n()()),t&2&&(m(10),oe("ngModel",i.searchTerm),m(7),c("ngForOf",i.employers)("ngForTrackBy",i.trackById),m(),c("totalItems",i.totalResults)("itemsPerPage",i.limit)("currentPage",i.currentPage))},dependencies:[be,pe,de,w,h,ye,Ee,re,D,O,ve,P,I,fe,k,Se],styles:[".container[_ngcontent-%COMP%]{padding:20px}.subtitle[_ngcontent-%COMP%]{text-align:center;color:#909090}.search[_ngcontent-%COMP%]{margin:auto}.member-list[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:16px}.member-card[_ngcontent-%COMP%]{width:95%;background:#f8f8f8;border-radius:12px;box-shadow:0 2px 4px #0000001a;transition:all .3s ease-in-out;cursor:pointer}.member-card[_ngcontent-%COMP%]:hover{transform:scale(1.06);box-shadow:0 4px 8px #00000026}.avatar[_ngcontent-%COMP%]{width:40px;height:40px;background-color:#539ecd;color:#fff;font-weight:700;font-size:16px;display:flex;align-items:center;justify-content:center;border-radius:50%;text-transform:uppercase}.member-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.email[_ngcontent-%COMP%]{font-size:.85rem;color:#666}.extra-info[_ngcontent-%COMP%]{margin-top:10px;padding-top:10px;border-top:1px solid #eee}.info-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-size:.9rem;color:#444}.footer[_ngcontent-%COMP%]{background:#ededed;font-size:.9rem;color:#969696;border-top:1px solid #eee;border-radius:0 0 9px 9px}.icon-edit[_ngcontent-%COMP%]:hover{color:#5a87e6}.icon-delete[_ngcontent-%COMP%]:hover{color:#e65a5a}"]})}return a})();var De=(()=>{class a{static \u0275fac=function(t){return new(t||a)};static \u0275cmp=u({type:a,selectors:[["app-user-relink-confirmation"]],standalone:!0,features:[g],decls:9,vars:2,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["mat-button","",3,"mat-dialog-close"],["mat-button","","color","warn",3,"mat-dialog-close"]],template:function(t,i){t&1&&(o(0,"h1",0),r(1,"Confirma\xE7\xE3o"),n(),o(2,"div",1),r(3,"J\xE1 existe um usuario com esse email cadastrado em uma academia, Deseja vincular esse usuario a essa academia? (Ele n\xE3o podera acessar o sistema da academia anterior)"),n(),o(4,"div",2)(5,"button",3),r(6,"Cancelar"),n(),o(7,"button",4),r(8,"Confirmar"),n()()),t&2&&(m(5),c("mat-dialog-close",!1),m(2),c("mat-dialog-close",!0))},dependencies:[j,R,L,h,U]})}return a})();function Ae(a,p){a&1&&(o(0,"mat-error"),r(1," Campo Obrigatorio "),n())}function Ne(a,p){a&1&&(o(0,"mat-error"),r(1," Campo Obrigatorio "),n())}function Ve(a,p){a&1&&(o(0,"mat-error"),r(1," Insira um email valido "),n())}function ze(a,p){a&1&&(o(0,"mat-error"),r(1," Campo Obrigatorio "),n())}function qe(a,p){a&1&&(o(0,"mat-error"),r(1," Deve conter no minimo 6 caracteres. "),n())}function $e(a,p){a&1&&(o(0,"mat-error"),r(1," Deve conter um n\xFAmero e um caracter especial "),n())}function He(a,p){if(a&1&&(o(0,"mat-option",9),r(1),n()),a&2){let e=p.$implicit;c("value",e.value),m(),M(" ",e.viewValue," ")}}var Oe=(()=>{class a{httpMethods;formBuilder;router;route;snackBar;dialog;action="";pathUrlEmployee=T.USERS;formGroup;created=!0;gymId="";title="Cadastro de funcion\xE1rio";getGym(){this.gymId=localStorage.getItem("academia"),this.gymId&&this.formGroup.patchValue({academia:this.gymId})}constructor(e,t,i,l,s,v){this.httpMethods=e,this.formBuilder=t,this.router=i,this.route=l,this.snackBar=s,this.dialog=v,this.formGroup=this.formBuilder.group({id:[],nome:["",C.required],username:["",[C.required,C.email]],password:["",[C.required,C.minLength(6),C.pattern("^(?=.*\\d)(?=.*[@$!%*?&])[A-Za-z\\d@$!%*?&]+$")]],tipo_usuario:["",C.required],academia:[""]})}ngOnInit(){this.getGym(),this.retriveCallBack()}cargos=[{value:"G",viewValue:"Gerente"},{value:"A",viewValue:"Atendente"}];retriveCallBack(){this.route.paramMap.subscribe(e=>{this.action=e.get("action"),this.created=!(this.action&&this.action!=="create"),this.created||(this.title="Edi\xE7\xE3o de funcion\xE1rio",this.httpMethods.get(this.pathUrlEmployee+this.action+"/").subscribe(t=>{this.formGroup.setValue({id:t.id,nome:t.nome,username:t.username,password:"",tipo_usuario:t.tipo_usuario,academia:this.gymId})}))})}saveOrUpdate(e){if(this.created)this.httpMethods.get(this.pathUrlEmployee+`?email=${e.username}`).subscribe(t=>{if(t&&t.length>0)this.dialog.open(De).afterClosed().subscribe(l=>{if(l){let s=t[0].id,v=W(H({},e),{usuario:s});this.httpMethods.post(this.pathUrlEmployee+"alterar_academia/",v).subscribe(()=>{this.router.navigate(["/employee/list"])})}});else{let i="Funcionario cadastrado";this.httpMethods.post(this.pathUrlEmployee,e).subscribe(()=>{this.router.navigate(["/employee/list"]).then(),this.snackBar.open(i,"Fechar",{duration:5e3,verticalPosition:"top"})})}});else{let t="Funcionario Atualizado";this.httpMethods.patch(this.pathUrlEmployee,e).subscribe(()=>{this.router.navigate(["/employee/list"]).then(),this.snackBar.open(t,"Fechar",{duration:5e3,verticalPosition:"top"})})}}static \u0275fac=function(t){return new(t||a)(d(B),d(_e),d(S),d(le),d(F),d(G))};static \u0275cmp=u({type:a,selectors:[["app-form"]],standalone:!0,features:[g],decls:30,vars:9,consts:[[1,"container"],[1,"mat-elevation-z2","form",3,"ngSubmit","formGroup"],[1,"form-title"],["appearance","fill",1,"nome"],["matInput","","formControlName","nome","placeholder","Digite o nome do funcionario"],["appearance","fill"],["matInput","","type","email","formControlName","username","placeholder","Digite o email do funcinario"],["matInput","","type","password","formControlName","password","placeholder","Digite uma senha"],["formControlName","tipo_usuario","ARIA-PLACEHOLDER","Cargo"],[3,"value"],["mat-raised-button","","color","primary","type","submit",1,"save",3,"disabled"]],template:function(t,i){if(t&1&&(o(0,"div",0)(1,"form",1),f("ngSubmit",function(){return i.saveOrUpdate(i.formGroup.value)}),o(2,"h2",2),r(3),n(),o(4,"mat-form-field",3)(5,"mat-label"),r(6,"Nome"),n(),b(7,"input",4),x(8,Ae,2,0,"mat-error"),n(),o(9,"mat-form-field",5)(10,"mat-label"),r(11,"Email"),n(),b(12,"input",6),x(13,Ne,2,0,"mat-error")(14,Ve,2,0,"mat-error"),n(),o(15,"mat-form-field",5)(16,"mat-label"),r(17,"Senha"),n(),b(18,"input",7),x(19,ze,2,0,"mat-error")(20,qe,2,0,"mat-error")(21,$e,2,0,"mat-error"),n(),o(22,"mat-form-field",5)(23,"mat-label"),r(24,"Cargo"),n(),o(25,"mat-select",8),Y(26,He,2,2,"mat-option",9,X),n()(),o(28,"button",10),r(29,"Salvar"),n()()()),t&2){let l,s,v,z,q,$;m(),c("formGroup",i.formGroup),m(2),y(i.title),m(5),_((l=i.formGroup.get("nome"))!=null&&l.hasError("required")?8:-1),m(5),_((s=i.formGroup.get("username"))!=null&&s.hasError("required")?13:-1),m(),_((v=i.formGroup.get("username"))!=null&&v.hasError("email")?14:-1),m(5),_((z=i.formGroup.get("password"))!=null&&z.hasError("required")?19:-1),m(),_((q=i.formGroup.get("password"))!=null&&q.hasError("minlength")?20:-1),m(),_(($=i.formGroup.get("password"))!=null&&$.hasError("pattern")?21:-1),m(5),ee(i.cargos),m(2),c("disabled",!i.formGroup.valid)}},dependencies:[h,D,O,k,xe,ge,P,I,ue,he,Ce,Pe,ce,Me],styles:[".container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh;background-color:#f4f7fc}.form[_ngcontent-%COMP%]{width:100%;max-width:500px;padding:40px;background-color:#fff;border-radius:12px;box-shadow:0 4px 12px #0000001a;font-family:Arial,sans-serif}.form-title[_ngcontent-%COMP%]{text-align:center;font-size:24px;color:#333;margin-bottom:30px}mat-form-field[_ngcontent-%COMP%]{width:100%;margin-bottom:20px}mat-label[_ngcontent-%COMP%]{font-weight:600;color:#333}input[_ngcontent-%COMP%]{font-size:16px;padding:10px;border-radius:4px;border:1px solid #ddd}button[_ngcontent-%COMP%]{width:100%;padding:14px;font-size:16px;border:none;border-radius:4px;cursor:pointer;background-color:#00ff2a;color:#fff;transition:background-color .3s ease-in-out}.input-field[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{font-size:16px}button[disabled][_ngcontent-%COMP%]{background-color:#b0bec5;cursor:not-allowed}@media (max-width: 600px){.form[_ngcontent-%COMP%]{padding:20px}.form-title[_ngcontent-%COMP%]{font-size:20px}button[_ngcontent-%COMP%]{font-size:14px;padding:12px}}"]})}return a})();var Te=[{path:"list",component:ke},{path:"form/:action",component:Oe}];var It=(()=>{class a{static \u0275fac=function(t){return new(t||a)};static \u0275mod=Q({type:a});static \u0275inj=K({imports:[me,se.forChild(Te)]})}return a})();export{It as EmployeeModule};
