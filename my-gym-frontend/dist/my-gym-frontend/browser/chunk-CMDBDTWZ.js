import{a as rt,b as ot}from"./chunk-VXASFR3Q.js";import{b as Ue,d as Qe}from"./chunk-35ZIMB5Q.js";import{a as Xe,b as $e,c as Ye,d as Je,e as Ke,f as Ze,g as et,h as tt,i as it,j as at,k as nt}from"./chunk-OEQ5PFX2.js";import"./chunk-7IZTALVS.js";import"./chunk-D7X432AK.js";import{a as Ae,b as je,c as $,d as Ne,e as qe,f as ze,g as He}from"./chunk-L2Q2YWF7.js";import{a as We}from"./chunk-NLT3YVZR.js";import{a as Be,b as Oe,c as Ge}from"./chunk-5ZQMS33S.js";import{a as X}from"./chunk-J4WTDL2S.js";import{a as Q}from"./chunk-QDRWFLAQ.js";import{b as z,c as Ie,d as H,g as W,j as U}from"./chunk-GELPBASQ.js";import{A,B as j,D as N,G as q,a as I,c as we,f as B,h as O,k as G,l as ye,o as Te,p as ke,q as Pe,s as Re,v as Fe,y as Ve,z as Le}from"./chunk-VL4B4XMJ.js";import"./chunk-IFDCXV3N.js";import{a as De}from"./chunk-PR2HLA7M.js";import{W as Se,Y as Me,_ as L,ga as Ee,l as be,p as xe}from"./chunk-DYBUUYLF.js";import{$b as o,Ab as re,Cb as oe,Db as le,E as te,Eb as a,Fb as n,Gb as C,Hb as v,Ib as b,K as ie,Kb as x,Nb as _,Pb as y,Ub as se,Vb as me,Wb as ce,Ya as s,Yc as he,Za as g,Zb as T,aa as ae,ac as Y,bc as S,bd as ge,cc as de,cd as _e,ec as k,ed as Ce,f as ee,fc as P,fd as ve,gc as R,hc as F,ic as V,ja as D,ka as ne,kc as pe,mc as M,nc as ue,ob as h,pc as J,qc as fe,ra as p,sa as u,ub as f,zb as E}from"./chunk-KNMBK3NL.js";import"./chunk-JKOY2XUY.js";function ht(e,c){if(e&1&&(a(0,"mat-option",8),o(1),M(2,"titlecase"),n()),e&2){let i=c.$implicit;f("value",i),s(),Y(ue(2,2,i))}}function gt(e,c){e&1&&(a(0,"mat-error"),o(1,"Campo Obrigat\xF3rio"),n())}function _t(e,c){e&1&&(a(0,"mat-error"),o(1,"Campo Obrigat\xF3rio"),n())}function Ct(e,c){e&1&&(a(0,"mat-error"),o(1,"Campo Obrigat\xF3rio"),n())}function vt(e,c){e&1&&(a(0,"mat-error"),o(1,"Campo Obrigat\xF3rio"),n())}var K=(()=>{class e{formBuilder;httpMethods;authService;snackBar;dialogRef;data;pathUrl=Q.EXPENSE;categories=["energia","agua","salario","manutencao","produtos","limpeza","impostos","outros"];formGroup;create=!0;constructor(i,l,t,r,d,m){this.formBuilder=i,this.httpMethods=l,this.authService=t,this.snackBar=r,this.dialogRef=d,this.data=m,this.formGroup=this.formBuilder.group({id:[""],tipo:[m.expense?.categoria||null,O.required],descricao:[m.expense?.descricao||null,O.required],valor:[m.expense?.valor||null,O.required],academia:[this.authService.get_gym()],data:[m.expense?.data||null]})}ngOnInit(){this.retriverCallBack()}retriverCallBack(){this.data.action=="update"&&(this.create=!1,this.httpMethods.get(this.pathUrl+this.data.expense.id+"/").subscribe(i=>{this.formGroup.setValue({id:i.id,tipo:i.tipo,descricao:i.descricao,data:i.data,valor:i.valor,academia:this.authService.get_gym()})}))}register(){this.formGroup.valid&&this.data.action=="create"?this.httpMethods.post(this.pathUrl,this.formGroup.value).subscribe(i=>{this.snackBar.open("Gasto registrado com sucesso.","Fechar",{duration:5e3,verticalPosition:"top"}),this.dialogRef.close(!0)},i=>{this.snackBar.open("Erro ao registrar gasto.","Fechar",{duration:5e3,verticalPosition:"top"})}):this.httpMethods.patch(this.pathUrl,this.formGroup.value).subscribe(i=>{this.snackBar.open("Atualizado registrado com sucesso.","Fechar",{duration:5e3,verticalPosition:"top"}),this.dialogRef.close(!0)},i=>{this.snackBar.open("Erro ao atualizar registro gasto.","Fechar",{duration:5e3,verticalPosition:"top"})})}closeDialog(){this.formGroup.reset(),this.dialogRef.close()}static \u0275fac=function(l){return new(l||e)(g(Le),g(X),g(q),g(N),g(Be),g(Oe))};static \u0275cmp=D({type:e,selectors:[["app-form"]],standalone:!0,features:[F([Ue(),L(),{provide:Me,useValue:Qe},{provide:Se,useValue:"pt-BR"}]),V],decls:36,vars:9,consts:[["picker",""],[1,"p-3","flex","flex-column","gap-3"],[1,"flex","justify-content-start"],[1,"font-bold","text-2xl"],["id","container-prod",1,"flex","flex-column"],[1,"flex","flex-column","gap-3",3,"ngSubmit","formGroup"],["appearance","fill",1,"w-full"],["formControlName","tipo","placeholder","tipo","required",""],[3,"value"],["matInput","","formControlName","descricao","placeholder","Descri\xE7\xE3o","required",""],["matInput","","type","number","formControlName","valor","placeholder","Digite o valor do gasto","required",""],["matInput","","formControlName","data",3,"matDatepicker"],["matSuffix","",3,"for"],[1,"flex","justify-content-end","gap-2"],["mat-button","","type","button",1,"add_button","bg-black-alpha-80","text-white",3,"click"],["mat-raised-button","","color","primary","type","submit",1,"add_button","bg-black-alpha-80","text-white",3,"disabled"]],template:function(l,t){if(l&1){let r=x();a(0,"main",1)(1,"div",2)(2,"h2",3),o(3),n()(),a(4,"div",4)(5,"form",5),_("ngSubmit",function(){return p(r),u(t.register())}),a(6,"mat-form-field",6)(7,"mat-label"),o(8,"Tipo"),n(),a(9,"mat-select",7),oe(10,ht,3,4,"mat-option",8,re),n(),h(12,gt,2,0,"mat-error"),n(),a(13,"mat-form-field",6)(14,"mat-label"),o(15,"Descri\xE7\xE3o"),n(),C(16,"input",9),h(17,_t,2,0,"mat-error"),n(),a(18,"mat-form-field",6)(19,"mat-label"),o(20,"Valor"),n(),C(21,"input",10),h(22,Ct,2,0,"mat-error"),n(),a(23,"mat-form-field",6)(24,"mat-label"),o(25,"Data"),n(),C(26,"input",11)(27,"mat-datepicker-toggle",12)(28,"mat-datepicker",null,0),h(30,vt,2,0,"mat-error"),n(),a(31,"div",13)(32,"button",14),_("click",function(){return p(r),u(t.closeDialog())}),o(33," Cancelar "),n(),a(34,"button",15),o(35,"Salvar "),n()()()()()}if(l&2){let r,d,m,w,Z=T(29);s(3),Y(t.data.title||"Registrar Gasto"),s(2),f("formGroup",t.formGroup),s(5),le(t.categories),s(2),E((r=t.formGroup.get("categoria"))!=null&&r.hasError("required")&&((r=t.formGroup.get("categoria"))!=null&&r.touched)?12:-1),s(5),E((d=t.formGroup.get("descricao"))!=null&&d.hasError("required")&&((d=t.formGroup.get("descricao"))!=null&&d.touched)?17:-1),s(5),E((m=t.formGroup.get("valor"))!=null&&m.hasError("required")&&((m=t.formGroup.get("valor"))!=null&&m.touched)?22:-1),s(4),f("matDatepicker",Z),s(),f("for",Z),s(3),E((w=t.formGroup.get("data"))!=null&&w.hasError("required")&&((w=t.formGroup.get("data"))!=null&&w.touched)?30:-1),s(4),f("disabled",t.formGroup.invalid)}},dependencies:[W,U,z,j,ke,B,Pe,G,ye,Ve,Re,Fe,A,We,Ee,Ie,Ae,je,$,H,ge,I],styles:["[_nghost-%COMP%]{display:block;max-width:100vw;overflow-x:hidden}main[_ngcontent-%COMP%]{display:block;width:100%;max-width:100%;overflow-x:hidden;box-sizing:border-box}mat-card[_ngcontent-%COMP%]{width:100%;max-width:100%;box-sizing:border-box;overflow-x:hidden}#container-prod[_ngcontent-%COMP%]{width:100%;max-width:100%;overflow-x:hidden}"]})}return e})();var bt=e=>[e,"BRL","symbol","1.2-2","pt-BR"];function xt(e,c){if(e&1){let i=x();a(0,"button",31),_("click",function(){p(i);let t=y();return u(t.clearDateRange())}),a(1,"mat-icon"),o(2,"close"),n()()}}function St(e,c){e&1&&(a(0,"th",32),o(1," Tipo "),n())}function Mt(e,c){if(e&1&&(a(0,"td",33),o(1),n()),e&2){let i=c.$implicit;s(),S(" ",i.tipo," ")}}function Et(e,c){e&1&&(a(0,"th",32),o(1," Descri\xE7\xE3o "),n())}function wt(e,c){if(e&1&&(a(0,"td",33),o(1),n()),e&2){let i=c.$implicit;s(),S(" ",i.descricao," ")}}function Dt(e,c){e&1&&(a(0,"th",32),o(1," Valor "),n())}function yt(e,c){if(e&1&&(a(0,"td",33),o(1),M(2,"currency"),n()),e&2){let i=c.$implicit;s(),S(" ",fe(2,1,pe(7,bt,i.valor))," ")}}function Tt(e,c){e&1&&(a(0,"th",32),o(1," Data "),n())}function kt(e,c){if(e&1&&(a(0,"td",33),o(1),M(2,"date"),n()),e&2){let i=c.$implicit;s(),S(" ",J(2,1,i.data,"dd/MM/yyyy","pt-BR")," ")}}function Pt(e,c){e&1&&(a(0,"th",32),o(1," Registrado em "),n())}function Rt(e,c){if(e&1&&(a(0,"td",33),o(1),M(2,"date"),n()),e&2){let i=c.$implicit;s(),S(" ",J(2,1,i.created_at,"dd/MM/yyyy","pt-BR")," ")}}function Ft(e,c){e&1&&C(0,"tr",34)}function Vt(e,c){e&1&&C(0,"tr",35)}function Lt(e,c){e&1&&(a(0,"th",32),o(1," Actions "),n())}function It(e,c){if(e&1){let i=x();a(0,"td",33)(1,"button",36),_("click",function(){let t=p(i).$implicit,r=y();return u(r.edit(t))}),a(2,"mat-icon"),o(3,"edit"),n()(),a(4,"button",36),_("click",function(){let t=p(i).$implicit,r=y();return u(r.delete(t))}),a(5,"mat-icon"),o(6,"delete"),n()()()}}var st=(()=>{class e{httpMethods;authService;router;dialog;snackBar;Expenses=[];searchTerm="";currentPage=0;limit=10;totalResults=0;searchChanged=new ee;startDate=null;endDate=null;paginator;dataSource=new nt;displayedColumns=["categoria","descricao","valor","data","actions"];elementAt=ie;pathUrl=Q.EXPENSE;constructor(i,l,t,r,d){this.httpMethods=i,this.authService=l,this.router=t,this.dialog=r,this.snackBar=d}get totalPages(){return Math.ceil(this.totalResults/this.limit)}ngOnInit(){this.search(),this.searchChanged.pipe(te(300)).subscribe(i=>{this.searchTerm=i,this.searchExpenses(i,0)})}ngAfterViewInit(){this.dataSource.paginator=this.paginator}search(){this.searchExpenses(this.searchTerm,0)}searchExpenses(i="",l=0,t=this.limit){let r={limit:t,offset:l,active:!0,academia:this.authService.get_gym()};i&&(r.search=i),this.startDate&&(r.data_after=this.startDate.toISOString().split("T")[0]),this.endDate&&(r.data_before=this.endDate.toISOString().split("T")[0]),this.httpMethods.getPaginated(this.pathUrl,r).subscribe(d=>{this.Expenses=d.results,this.totalResults=d.count,this.dataSource.data=this.Expenses,this.currentPage=l/t})}nextPage(){let i=Math.ceil(this.totalResults/this.limit)-1;if(this.currentPage<i){let l=(this.currentPage+1)*this.limit;this.searchExpenses(this.searchTerm,l)}}prevPage(){if(this.currentPage>0){let i=(this.currentPage-1)*this.limit;this.searchExpenses(this.searchTerm,i)}}onSearchChange(i){this.searchChanged.next(i)}onDateRangeChange(i){i.start&&(this.startDate=i.start),i.end&&(this.endDate=i.end),this.search()}clearDateRange(){this.startDate=null,this.endDate=null,this.search()}delete(i){this.dialog.open(ot,{panelClass:"custom-modal",autoFocus:!0,data:{title:"Excluir registro de gasto",message:"Deseja realmente excluir este registro?"}}).afterClosed().subscribe({next:t=>{if(t===!0){let r={id:i.id};this.httpMethods.disable(this.pathUrl,r,"disable").subscribe({next:()=>{this.snackBar.open("Registro exclu\xEDdo com sucesso!","Fechar",{duration:3e3,horizontalPosition:"right",verticalPosition:"top"}),this.searchExpenses(this.searchTerm,0)},error:d=>{this.snackBar.open("Erro ao excluir registro!","Fechar",{duration:3e3,horizontalPosition:"right",verticalPosition:"top"})}})}}})}edit(i){this.dialog.open(K,{width:"600px",maxWidth:"90vw",minHeight:"400px",panelClass:"custom-modal",autoFocus:!0,data:{title:"atualizar registro",action:"update",expense:{id:i.id,academia:this.authService.get_gym(),categoria:"",descricao:"",valor:0,data:null}}}).afterClosed().subscribe(t=>{t&&this.searchExpenses(this.searchTerm,0)})}create(){this.dialog.open(K,{width:"600px",maxWidth:"90vw",minHeight:"400px",panelClass:"custom-modal",autoFocus:!0,data:{title:"Novo Gasto",action:"create",expense:{academia:this.authService.get_gym(),categoria:"",descricao:"",valor:0,data:null}}}).afterClosed().subscribe(l=>{l&&this.searchExpenses(this.searchTerm,0)})}static \u0275fac=function(l){return new(l||e)(g(X),g(q),g(be),g(Ge),g(N))};static \u0275cmp=D({type:e,selectors:[["app-list"]],viewQuery:function(l,t){if(l&1&&se(rt,5),l&2){let r;me(r=ce())&&(t.paginator=r.first)}},standalone:!0,features:[F([L()]),V],decls:59,vars:13,consts:[["picker",""],[1,"title"],[1,"subtitle","flex","justify-content-center","flex","mb-4","font-gray"],[1,"ml-8","mr-8"],[1,"flex","align-items-center","justify-content-start"],["appearance","outline",1,"search","w-30rem"],["matInput","text","placeholder","Por descri\xE7\xE3o ou Categoria",3,"ngModelChange","input","ngModel"],["appearance","outline",1,"w-5","ml-2"],[3,"rangePicker"],["matStartDate","","placeholder","Data inicial",3,"ngModelChange","dateChange","ngModel"],["matEndDate","","placeholder","Data final",3,"ngModelChange","dateChange","ngModel"],["class","gap-1","mat-icon-button","","matSuffix","","aria-label","Limpar filtro de data",3,"click",4,"ngIf"],["matIconSuffix","",3,"for"],[1,"flex","align-items-center","justify-content-between","w-full","mb-4"],[1,"w-10rem"],[1,"align-self-start","mr-2"],["mat-raised-button","","color","primary",1,"add_button","bg-black-alpha-70","mt-2",2,"color","white",3,"click"],[1,"mat-elevation-z1","bg-black-alpha-80"],["mat-table","",1,"mat-elevation-z8","demo-table",3,"dataSource"],["matColumnDef","categoria"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","descricao"],["matColumnDef","valor"],["matColumnDef","data"],["matColumnDef","created_at"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["matColumnDef","actions"],[1,"pagination-controls"],[3,"click","disabled"],["mat-icon-button","","matSuffix","","aria-label","Limpar filtro de data",1,"gap-1",3,"click"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""],["mat-icon-button","","color","primary",3,"click"]],template:function(l,t){if(l&1){let r=x();a(0,"h2",1),o(1,"Gastos"),n(),a(2,"div",2),o(3,"Resgistre e verifique os gastos do estabelecimento"),n(),a(4,"main",3)(5,"div",4)(6,"mat-form-field",5)(7,"mat-label"),o(8,"Buscar registro"),n(),a(9,"input",6),R("ngModelChange",function(m){return p(r),P(t.searchTerm,m)||(t.searchTerm=m),u(m)}),_("input",function(){return p(r),u(t.onSearchChange(t.searchTerm))}),n()(),a(10,"mat-form-field",7)(11,"mat-label"),o(12,"Filtro por Data"),n(),a(13,"mat-date-range-input",8)(14,"input",9),R("ngModelChange",function(m){return p(r),P(t.startDate,m)||(t.startDate=m),u(m)}),_("dateChange",function(m){return p(r),u(t.onDateRangeChange({start:m.value,end:t.endDate}))}),n(),a(15,"input",10),R("ngModelChange",function(m){return p(r),P(t.endDate,m)||(t.endDate=m),u(m)}),_("dateChange",function(m){return p(r),u(t.onDateRangeChange({start:t.startDate,end:m.value}))}),n()(),h(16,xt,3,0,"button",11),C(17,"mat-datepicker-toggle",12)(18,"mat-date-range-picker",null,0),n(),a(20,"div",13),C(21,"div",14),a(22,"div",15)(23,"button",16),_("click",function(){return p(r),u(t.create())}),a(24,"mat-icon"),o(25,"add"),n(),o(26," Registrar Gasto "),n()()()(),a(27,"div")(28,"div",17)(29,"table",18),v(30,19),h(31,St,2,0,"th",20)(32,Mt,2,1,"td",21),b(),v(33,22),h(34,Et,2,0,"th",20)(35,wt,2,1,"td",21),b(),v(36,23),h(37,Dt,2,0,"th",20)(38,yt,3,9,"td",21),b(),v(39,24),h(40,Tt,2,0,"th",20)(41,kt,3,5,"td",21),b(),v(42,25),h(43,Pt,2,0,"th",20)(44,Rt,3,5,"td",21),b(),h(45,Ft,1,0,"tr",26)(46,Vt,1,0,"tr",27),v(47,28),h(48,Lt,2,0,"th",20)(49,It,7,0,"td",21),b(),n()(),a(50,"div",29)(51,"button",30),_("click",function(){return p(r),u(t.prevPage())}),a(52,"mat-icon"),o(53,"chevron_left"),n()(),a(54,"span"),o(55),n(),a(56,"button",30),_("click",function(){return p(r),u(t.nextPage())}),a(57,"mat-icon"),o(58,"chevron_right"),n()()()()()}if(l&2){let r=T(19);s(9),k("ngModel",t.searchTerm),s(4),f("rangePicker",r),s(),k("ngModel",t.startDate),s(),k("ngModel",t.endDate),s(),f("ngIf",t.startDate||t.endDate),s(),f("for",r),s(12),f("dataSource",t.dataSource),s(16),f("matHeaderRowDef",t.displayedColumns),s(),f("matRowDefColumns",t.displayedColumns),s(5),f("disabled",t.currentPage===0),s(4),de("P\xE1gina ",t.currentPage+1," de ",t.totalPages,""),s(),f("disabled",t.currentPage>=t.totalPages-1)}},dependencies:[Ce,_e,I,Ze,$e,Je,W,Ke,it,et,De,U,z,at,tt,Xe,j,B,G,Ye,A,Te,ze,He,$,qe,Ne,H,we,he],styles:[".title[_ngcontent-%COMP%]{text-align:center;margin-bottom:16px;font-size:1.5rem;color:#333}.pagination-controls[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin-top:16px}.pagination-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:36px;height:36px;margin:0 8px;border-radius:50%;background-color:#e0e0e0;color:#000;border:none;cursor:pointer;display:flex;justify-content:center;align-items:center;box-shadow:0 2px 2px #0003;transition:background-color .3s ease,box-shadow .3s ease}.pagination-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#d6d6d6}.pagination-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{background-color:#f5f5f5;color:#9e9e9e;cursor:not-allowed;box-shadow:none}.pagination-controls[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:14px;margin:0 8px;color:#757575}"]})}return e})();var mt=[{path:"list",component:st}];var gi=(()=>{class e{static \u0275fac=function(l){return new(l||e)};static \u0275mod=ne({type:e});static \u0275inj=ae({imports:[ve,xe.forChild(mt)]})}return e})();export{gi as ExpensesModule};
