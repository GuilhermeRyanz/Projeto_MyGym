import{a as ye,b as we}from"./chunk-JELTFLJC.js";import{a as Le,b as Ae}from"./chunk-2U76FYVI.js";import{a as Be}from"./chunk-TAQDNSST.js";import{a as Te,b as ke,c as Oe,e as Ne,f as Ge,g as je}from"./chunk-5ZQMS33S.js";import{a as De}from"./chunk-XKDRZ2FP.js";import{a as R}from"./chunk-CNUYDMNB.js";import{a as L}from"./chunk-QDRWFLAQ.js";import{b as G,c as Fe,g as j,j as B}from"./chunk-T3ODEV2J.js";import{A as Me,B as N,D as Pe,a as y,f as k,h as g,k as O,l as ue,o as fe,p as he,q as ge,s as _e,t as xe,u as be,v as ve,w as Ce,x as Ee,z as Se}from"./chunk-DCGZQB77.js";import{a as A,c as V,g as Ie}from"./chunk-IFDCXV3N.js";import{a as w,b as pe}from"./chunk-PR2HLA7M.js";import{ga as se,j as de,l as T,p as ce}from"./chunk-DYBUUYLF.js";import{$b as o,Bb as I,Cb as P,Db as F,E as ee,Eb as i,Fb as e,Gb as x,Kb as D,Nb as c,Pb as b,Xc as le,Ya as l,Za as p,aa as te,ac as S,bc as f,cc as ne,ec as oe,f as Z,fc as re,fd as me,gc as ae,ic as M,ja as v,ka as ie,ob as _,ra as C,sa as E,ub as h,zb as u}from"./chunk-KNMBK3NL.js";import{a as X,b as Y}from"./chunk-JKOY2XUY.js";function We(r,d){if(r&1&&(i(0,"li",10)(1,"mat-icon",17),o(2,"check_circle"),e(),o(3),e()),r&2){let n=d.$implicit;l(3),f(" ",n," ")}}function ze(r,d){r&1&&o(0,"Mes")}function He(r,d){r&1&&o(0," Meses ")}var Ve=(()=>{class r{dialogRef;plan;constructor(n,a){this.dialogRef=n,this.plan=a}close(){this.dialogRef.close()}static \u0275fac=function(a){return new(a||r)(p(Te),p(ke))};static \u0275cmp=v({type:r,selectors:[["app-plan-detail"]],standalone:!0,features:[M],decls:37,vars:7,consts:[["mat-dialog-title","",1,"dialog-title","text-center"],[1,"dialog-content","p-4"],[1,"plan-card","p-3"],[1,"flex","flex-column","gap-3"],[1,"flex","align-items-center","justify-content-between"],[1,"text-2xl","font-bold"],[1,"text-2xl","text-green-500"],[1,"text-gray-700","text-sm","mb-2","overflow-hidden","text-overflow-ellipsis","line-clamp-3"],[1,"text-lg","font-bold"],[1,"pl-3","line-clamp-5","overflow-hidden"],[1,"text-sm","flex","align-items-center"],[1,"flex","flex-column","gap-2"],[1,"flex","justify-content-between","text-sm","font-medium"],[1,"text-primary","font-bold"],[1,"text-sm"],[1,"dialog-actions","flex","justify-content-center","p-3"],["mat-stroked-button","",1,"close-button","w-full",3,"click"],[1,"text-green-500","mr-2"]],template:function(a,t){a&1&&(i(0,"main")(1,"h2",0),o(2,"Detalhes do Plano"),e(),i(3,"mat-dialog-content",1)(4,"mat-card",2)(5,"mat-card-content",3)(6,"div",4)(7,"div",5),o(8),e(),i(9,"div",6),o(10),e()(),i(11,"div",7),o(12),e(),i(13,"div")(14,"div",8),o(15,"Benef\xEDcios:"),e(),i(16,"ul",9),P(17,We,4,1,"li",10,I),e()(),i(19,"div",11)(20,"div",12)(21,"div"),o(22,"Dura\xE7\xE3o:"),e(),i(23,"div",13),o(24),_(25,ze,1,0)(26,He,1,0),e()(),i(27,"div",12)(28,"div"),o(29,"Dias dispon\xEDveis:"),e(),i(30,"div",14),o(31),e()()()()()(),i(32,"mat-dialog-actions",15)(33,"button",16),c("click",function(){return t.close()}),i(34,"mat-icon"),o(35,"close"),e(),o(36," Fechar "),e()()()),a&2&&(l(8),S(t.plan.nome),l(2),ne("R$ ",t.plan.preco," / ",t.plan.duracao,"Meses"),l(2),f(" ",t.plan.descricao," "),l(5),F(t.plan.beneficios),l(7),f("",t.plan.duracao," "),l(),u(t.plan.duracao>1?25:26),l(6),f(" ",t.plan.dias_permitidos_str,""))},dependencies:[Ge,je,Ne,y,w,V,A],styles:[".dialog-title[_ngcontent-%COMP%]{font-size:1.8rem;font-weight:700;color:#333}.dialog-content[_ngcontent-%COMP%]{max-width:850px;min-width:650px}.text-green-500[_ngcontent-%COMP%]{color:#0f9d58}.text-primary[_ngcontent-%COMP%]{color:#007bff}.dialog-actions[_ngcontent-%COMP%]{border-top:1px solid #ddd}.close-button[_ngcontent-%COMP%]{color:#d32f2f;font-weight:700}[_nghost-%COMP%]{overflow-x:hidden}main[_ngcontent-%COMP%]{overflow-x:hidden}"]})}return r})();var Xe=(r,d)=>d.id;function Ye(r,d){if(r&1&&(i(0,"li",19),o(1),e()),r&2){let n=d.$implicit;l(),f(" ",n,"")}}function Ze(r,d){if(r&1){let n=D();i(0,"mat-card",9)(1,"mat-card-content",11)(2,"div",12)(3,"div",13)(4,"div",14),o(5),e(),i(6,"div",15),o(7),e()(),i(8,"div",16),o(9),e(),i(10,"div",17),o(11,"Benef\xEDcios:"),e(),i(12,"ul",18),P(13,Ye,2,1,"li",19,I),e()()(),i(15,"mat-card",20)(16,"div",21)(17,"div"),o(18,"Dura\xE7\xE3o:"),e(),i(19,"div",22),o(20),e()(),i(21,"div",21)(22,"div"),o(23,"Dias dispon\xEDveis:"),e(),i(24,"div",19),o(25),e()()(),i(26,"div",23)(27,"button",24),c("click",function(){let t=C(n).$implicit,m=b();return E(m.edit(t))}),i(28,"mat-icon"),o(29,"edit_square"),e(),o(30," Editar "),e(),i(31,"button",25),c("click",function(){let t=C(n).$implicit,m=b();return E(m.disable(t))}),i(32,"mat-icon"),o(33,"delete"),e(),o(34," Excluir "),e()(),i(35,"button",26),c("click",function(){let t=C(n).$implicit,m=b();return E(m.viewDetail(t))}),i(36,"mat-icon"),o(37,"info"),e(),o(38," Ver Detalhes "),e()()}if(r&2){let n=d.$implicit,a=b();l(5),S(n.nome),l(2),f("R$ ",n.preco,""),l(2),f(" ",n.descricao," "),l(4),F(n.beneficios),l(7),f("",n.duracao," m\xEAses"),l(5),f(" ",a.fomateDayWeek(n.dias_permitidos),"")}}var Re=(()=>{class r{httpMethods;router;snackBar;dialog;pathUrlPlan=L.PLAN;plans;gym_id="";typeUser="";limit=3;totalResults=1;currentPage=0;searchTerm="";searchChange=new Z;constructor(n,a,t,m){this.httpMethods=n,this.router=a,this.snackBar=t,this.dialog=m}ngOnInit(){this.getTypeUser(),this.search(),this.searchChange.pipe(ee(300)).subscribe(n=>{this.search(n,0)})}getTypeUser(){this.typeUser=localStorage.getItem("tipo_usuario")}search(n=" ",a=0,t=this.limit){let m={academia:this.gym_id,active:!0,limit:t,offset:a};n&&(m.search=n),this.httpMethods.getPaginated(this.pathUrlPlan,m).subscribe(s=>{this.plans=s.results,this.totalResults=s.count,this.currentPage=a/t})}onSearchChange(n){this.searchTerm=n,this.searchChange.next(n)}onPageChange(n){this.search()}create(){this.router.navigate(["/plan/form/create"]).then()}edit(n){this.router.navigate([`/plan/form/${n.id}`]).then()}viewDetail(n){this.dialog.open(Ve,{width:"40rem",maxWidth:"none",data:n})}disable(n){this.dialog.open(Le).afterClosed().subscribe(t=>{t&&this.httpMethods.disable(this.pathUrlPlan,n,"desativar").subscribe(()=>{this.search(),this.snackBar.open("Plano desativado","Fechar",{duration:5e3,verticalPosition:"top"})})})}fomateDayWeek=Ae;static \u0275fac=function(a){return new(a||r)(p(R),p(T),p(Pe),p(Oe))};static \u0275cmp=v({type:r,selectors:[["app-list"]],standalone:!0,features:[M],decls:19,vars:5,consts:[[1,"container"],["mat-subheader",""],[1,"font-gray","subtitle","flex","justify-content-center"],[1,"justify-content-between","align-content-center","align-items-center","flex","w-full","p-3"],["appearance","outline",1,"search","w-30rem","ml-4"],["matInput","text","placeholder","Buscar plano...",3,"ngModelChange","input","ngModel"],[1,"flex","justify-content-end","mr-3"],["mat-raised-button","","color","primary",1,"add_button","bg-black-alpha-70","mr-3","mb-3",2,"color","white",3,"click","disabled"],[1,"flex","flex-wrap","justify-content-center","gap-3","p-2"],[1,"bg-white-alpha-90","plan-card","w-25rem","p-3","flex","flex-column","justify-content-between"],[3,"pageChange","totalItems","itemsPerPage","currentPage"],[1,"flex-grow-1"],[1,"flex","flex-column","gap-2"],[1,"flex","align-items-center","justify-content-between"],[1,"text-2xl","font-bold"],[1,"text-2xl","font-bold","text-green-500"],[1,"line-clamp-3","text-gray-700","text-sm","mb-2","overflow-hidden","text-overflow-ellipsis","line-clamp-3"],[1,"text-lg","font-bold","overflow-hidden","text-overflow-ellipsis"],[1,"pl-3","line-clamp-5","overflow-hidden"],[1,"text-sm"],["appearance","outlined",1,"p-3"],[1,"flex","justify-content-between","text-sm","font-medium"],[1,"text-primary","font-bold"],[1,"plan-actions","flex","justify-content-between","mt-auto","p-3"],["mat-stroked-button","",1,"edit-button",3,"click"],["mat-stroked-button","",1,"delete-button",3,"click"],["mat-stroked-button","",1,"view-details-button","mt-2","w-full",3,"click"]],template:function(a,t){a&1&&(i(0,"div",0)(1,"h2",1),o(2,"Planos"),e(),i(3,"p",2),o(4,"Crie e edite os planos fornecidos pela academia"),e(),i(5,"div",3)(6,"mat-form-field",4)(7,"mat-label"),o(8,"Procurar plano"),e(),i(9,"input",5),ae("ngModelChange",function(s){return re(t.searchTerm,s)||(t.searchTerm=s),s}),c("input",function(){return t.onSearchChange(t.searchTerm)}),e()(),i(10,"div",6)(11,"button",7),c("click",function(){return t.create()}),i(12,"mat-icon"),o(13,"add"),e(),o(14," Novo Plano "),e()()(),i(15,"div",8),P(16,Ze,39,5,"mat-card",9,Xe),e(),i(18,"app-paginator",10),c("pageChange",function(s){return t.onPageChange(s)}),e()()),a&2&&(l(9),oe("ngModel",t.searchTerm),l(2),h("disabled",t.typeUser=="A"),l(5),F(t.plans),l(2),h("totalItems",t.totalResults)("itemsPerPage",t.limit)("currentPage",t.currentPage))},dependencies:[pe,w,y,we,ye,Ie,A,V,De,j,B,G,N,k,O,Me,fe],styles:[".plan-card[_ngcontent-%COMP%]{border-radius:8px;box-shadow:0 4px 8px #0000001a;padding:1.5rem;width:30rem;min-height:30rem}.edit-button[_ngcontent-%COMP%]{color:#4768ff;border-radius:5px}.delete-button[_ngcontent-%COMP%]{color:#ff4747;border-radius:5px}.line-clamp-5[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:5;-webkit-box-orient:vertical;overflow:hidden}.line-clamp-3[_ngcontent-%COMP%]{display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden}"]})}return r})();function et(r,d){r&1&&(i(0,"mat-error"),o(1," Campo Obrigatorio "),e())}function tt(r,d){r&1&&(i(0,"mat-error"),o(1," Nome tem limite de 20 caracteres "),e())}function it(r,d){r&1&&(i(0,"mat-error"),o(1," Campo Obrigat\xF3rio "),e())}function nt(r,d){r&1&&(i(0,"mat-error"),o(1," Pre\xE7o inv\xE1lido (deve ser um n\xFAmero com at\xE9 2 casas decimais) "),e())}function ot(r,d){r&1&&(i(0,"mat-error"),o(1," Campo Obrigat\xF3rio "),e())}function rt(r,d){r&1&&(i(0,"mat-error"),o(1," Campo Obrigat\xF3rio "),e())}function at(r,d){r&1&&(i(0,"mat-error"),o(1," Campo Obrigat\xF3rio "),e())}function lt(r,d){r&1&&(i(0,"mat-error"),o(1," limite de 120 caracteres "),e())}function mt(r,d){if(r&1&&(i(0,"mat-option",18),o(1),e()),r&2){let n=d.$implicit;h("value",n.valor),l(),f(" ",n.label," ")}}function dt(r,d){r&1&&(i(0,"mat-error"),o(1," O desconto n\xE3o pode ser negativo. "),e())}function ct(r,d){r&1&&(i(0,"mat-error"),o(1," O desconto n\xE3o pode ser maior que 100%. "),e())}function st(r,d){if(r&1){let n=D();i(0,"div",19)(1,"div",20)(2,"mat-form-field",21),x(3,"input",22),e(),i(4,"mat-icon",23),c("click",function(){let t=C(n).index,m=b();return E(m.removeBeneficio(t))}),o(5," backspace "),e()()()}if(r&2){let n=d.index;h("formGroupName",n)}}var Ue=(()=>{class r{httpMethods;formBuilder;router;route;action="";pathUrlPlan=L.PLAN;formGroup;created=!0;gymId="";title="Cria\xE7\xE3o de Plano";diasSemana=[{label:"Todos os dias",valor:-1},{label:"Domingo",valor:6},{label:"Segunda",valor:0},{label:"Ter\xE7a",valor:1},{label:"Quarta",valor:2},{label:"Quinta",valor:3},{label:"Sexta",valor:4},{label:"S\xE1bado",valor:5}];constructor(n,a,t,m){this.httpMethods=n,this.formBuilder=a,this.router=t,this.route=m,this.formGroup=this.formBuilder.group({id:[],nome:["",[g.required,g.maxLength(20)]],preco:["",[g.required,g.pattern("^[0-9]+(.[0-9]{1,2})?$")]],duracao:["",g.required],descricao:["",[g.required,g.maxLength(250)]],beneficios:this.formBuilder.array([]),desconto:[0,[g.min(0),g.max(100)]],dias_permitidos:[[-1]],academia:[""]})}toggleDiasPermitidos(n){if(n.includes(-1))this.formGroup.get("dias_permitidos")?.setValue([-1]);else{let a=n.filter(t=>t!==-1);this.formGroup.get("dias_permitidos")?.setValue(a)}}get benefits(){return this.formGroup.get("beneficios")}addBeneficio(){let n=this.formBuilder.group({beneficio:["",[g.maxLength(50)]]});this.benefits.push(n)}removeBeneficio(n){this.benefits.removeAt(n)}ngOnInit(){this.getPlan(),this.retriveCallBack()}getPlan(){this.gymId=localStorage.getItem("academia"),this.gymId&&this.formGroup.patchValue({academia:this.gymId})}retriveCallBack(){this.route.paramMap.subscribe(n=>{this.action=n.get("action"),this.created=!(this.action&&this.action!=="create"),this.created||(this.title="Edi\xE7\xE3o de Plano",this.httpMethods.get(`${this.pathUrlPlan}${this.action}/`).subscribe(a=>{this.benefits.clear(),Array.isArray(a.beneficios)&&a.beneficios.forEach(t=>{this.benefits.push(this.formBuilder.group({beneficio:[t,[g.maxLength(50)]]}))}),this.formGroup.patchValue({id:a.id,nome:a.nome,preco:a.preco,duracao:a.duracao,descricao:a.descricao,desconto:a.desconto,academia:this.gymId,dias_permitidos:Array.isArray(a.dias_permitidos)?a.dias_permitidos.map(Number):[]})}))})}saveOrUpdate(n){n.beneficios=this.benefits.value.map(m=>m.beneficio).filter(m=>m.trim()!=="");let a=this.formGroup.get("dias_permitidos")?.value,t=Y(X({},n),{academia:Number(this.gymId),preco:parseFloat(n.preco.toString()),desconto:parseFloat(n.desconto.toString()),dias_permitidos:a.includes(-1)?[0,1,2,3,4,5,6]:a.map(Number)});this.created?this.httpMethods.post(this.pathUrlPlan,t).subscribe(()=>{this.router.navigate(["/plan/list"]).then()}):this.httpMethods.patch(`${this.pathUrlPlan}`,t).subscribe(()=>{this.router.navigate(["/plan/list"]).then()})}static \u0275fac=function(a){return new(a||r)(p(R),p(Se),p(T),p(de))};static \u0275cmp=v({type:r,selectors:[["app-form"]],standalone:!0,features:[M],decls:49,vars:18,consts:[[1,"container","p-3"],[1,"mat-elevation-z2","form",3,"ngSubmit","formGroup"],["appearance","fill",1,"nome"],["matInput","","formControlName","nome","placeholder","Digite o nome do plano"],[1,"flex","align-items-center","justify-content-between","gap-2"],["appearance","fill",2,"width","50%"],["matInput","","type","number","formControlName","preco","placeholder","Digite o pre\xE7o"],["matInput","","type","number","formControlName","duracao","placeholder","Dura\xE7\xE3o em meses",3,"min"],["appearance","fill"],["matInput","","formControlName","descricao","placeholder","Digite uma descri\xE7\xE3o","rows","4"],["multiple","","formControlName","dias_permitidos",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["matInput","","type","number","formControlName","desconto","placeholder","Digite o desconto",3,"min","max"],[1,"flex","justify-content-between","align-items-center","align-content-center"],["mat-raised-button","","type","button","mat-button","",1,"add_button","w-3","text-white","bg-black-alpha-80",3,"click"],["formArrayName","beneficios"],[3,"formGroupName",4,"ngFor","ngForOf"],["mat-raised-button","","color","primary","type","submit",1,"save",3,"disabled"],[3,"value"],[3,"formGroupName"],[1,"flex","align-items-center","justify-content-between","flex-wrap"],["appearance","outline",2,"width","50%","margin-bottom","1px"],["matInput","","formControlName","beneficio","placeholder",""],["aria-label","Remover benef\xEDcio",2,"color","red","cursor","pointer",3,"click"]],template:function(a,t){if(a&1&&(i(0,"div",0)(1,"form",1),c("ngSubmit",function(){return t.saveOrUpdate(t.formGroup.value)}),i(2,"h2"),o(3),e(),i(4,"mat-form-field",2)(5,"mat-label"),o(6,"Nome"),e(),x(7,"input",3),_(8,et,2,0,"mat-error")(9,tt,2,0,"mat-error"),e(),i(10,"div",4)(11,"mat-form-field",5)(12,"mat-label"),o(13,"Pre\xE7o"),e(),x(14,"input",6),_(15,it,2,0,"mat-error")(16,nt,2,0,"mat-error"),e(),i(17,"mat-form-field",5)(18,"mat-label"),o(19," Dura\xE7\xE3o "),e(),x(20,"input",7),_(21,ot,2,0,"mat-error")(22,rt,2,0,"mat-error"),e()(),i(23,"mat-form-field",8)(24,"mat-label"),o(25,"Descri\xE7\xE3o"),e(),x(26,"textarea",9),_(27,at,2,0,"mat-error")(28,lt,2,0,"mat-error"),e(),i(29,"mat-form-field",8)(30,"mat-label"),o(31,"Dias Permitidos"),e(),i(32,"mat-select",10),c("selectionChange",function(s){return t.toggleDiasPermitidos(s.value)}),_(33,mt,2,2,"mat-option",11),e()(),i(34,"mat-form-field",8)(35,"mat-label"),o(36,"Desconto em produtos (%)"),e(),x(37,"input",12),_(38,dt,2,0,"mat-error")(39,ct,2,0,"mat-error"),e(),i(40,"div",13)(41,"h3"),o(42,"Beneficios"),e(),i(43,"button",14),c("click",function(){return t.addBeneficio()}),o(44,"Adicionar Benef\xEDcio"),e()(),i(45,"div",15),_(46,st,6,1,"div",16),e(),i(47,"button",17),o(48,"Salvar"),e()()()),a&2){let m,s,$,q,W,z,H,Q,J,K;l(),h("formGroup",t.formGroup),l(2),S(t.title),l(5),u((m=t.formGroup.get("nome"))!=null&&m.hasError("required")?8:-1),l(),u((s=t.formGroup.get("nome"))!=null&&s.hasError("maxlength")?9:-1),l(6),u(($=t.formGroup.get("preco"))!=null&&$.hasError("required")?15:-1),l(),u((q=t.formGroup.get("preco"))!=null&&q.hasError("pattern")?16:-1),l(4),h("min",1),l(),u((W=t.formGroup.get("duracao"))!=null&&W.hasError("required")?21:-1),l(),u((z=t.formGroup.get("duracao"))!=null&&z.hasError("required")?22:-1),l(5),u((H=t.formGroup.get("descricao"))!=null&&H.hasError("required")?27:-1),l(),u((Q=t.formGroup.get("descricao"))!=null&&Q.hasError("maxlength")?28:-1),l(5),h("ngForOf",t.diasSemana),l(4),h("min",0)("max",100),l(),u((J=t.formGroup.get("desconto"))!=null&&J.hasError("min")?38:-1),l(),u((K=t.formGroup.get("desconto"))!=null&&K.hasError("max")?39:-1),l(7),h("ngForOf",t.benefits.controls),l(),h("disabled",!t.formGroup.valid)}},dependencies:[N,he,k,ge,O,ue,Ee,Ce,_e,ve,xe,be,le,G,Fe,y,j,B,w,Be,se],styles:[".container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.form[_ngcontent-%COMP%]{width:100%;max-width:800px;padding:20px;background-color:#fff;border-radius:8px;box-shadow:0 4px 8px #0000001a}mat-form-field[_ngcontent-%COMP%]{width:100%;margin-bottom:16px}mat-label[_ngcontent-%COMP%]{font-weight:700;color:#333}input[_ngcontent-%COMP%]{font-size:16px}button[_ngcontent-%COMP%]{width:100%;padding:12px;font-size:16px;border:none;border-radius:4px;cursor:pointer}"]})}return r})();var $e=[{path:"list",component:Re},{path:"form/:action",component:Ue}];var Xt=(()=>{class r{static \u0275fac=function(a){return new(a||r)};static \u0275mod=ie({type:r});static \u0275inj=te({imports:[me,ce.forChild($e)]})}return r})();export{Xt as EmployeeModule};
